<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>Arvato_Project_Workbook</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.fa-pull-left {
  float: left;
}
.fa-pull-right {
  float: right;
}
.fa.fa-pull-left {
  margin-right: .3em;
}
.fa.fa-pull-right {
  margin-left: .3em;
}
/* Deprecated as of 4.4.0 */
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
  animation: fa-spin 1s infinite steps(8);
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook-f:before,
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-feed:before,
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before,
.fa-gratipay:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper-pp:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-resistance:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-y-combinator-square:before,
.fa-yc-square:before,
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
.fa-buysellads:before {
  content: "\f20d";
}
.fa-connectdevelop:before {
  content: "\f20e";
}
.fa-dashcube:before {
  content: "\f210";
}
.fa-forumbee:before {
  content: "\f211";
}
.fa-leanpub:before {
  content: "\f212";
}
.fa-sellsy:before {
  content: "\f213";
}
.fa-shirtsinbulk:before {
  content: "\f214";
}
.fa-simplybuilt:before {
  content: "\f215";
}
.fa-skyatlas:before {
  content: "\f216";
}
.fa-cart-plus:before {
  content: "\f217";
}
.fa-cart-arrow-down:before {
  content: "\f218";
}
.fa-diamond:before {
  content: "\f219";
}
.fa-ship:before {
  content: "\f21a";
}
.fa-user-secret:before {
  content: "\f21b";
}
.fa-motorcycle:before {
  content: "\f21c";
}
.fa-street-view:before {
  content: "\f21d";
}
.fa-heartbeat:before {
  content: "\f21e";
}
.fa-venus:before {
  content: "\f221";
}
.fa-mars:before {
  content: "\f222";
}
.fa-mercury:before {
  content: "\f223";
}
.fa-intersex:before,
.fa-transgender:before {
  content: "\f224";
}
.fa-transgender-alt:before {
  content: "\f225";
}
.fa-venus-double:before {
  content: "\f226";
}
.fa-mars-double:before {
  content: "\f227";
}
.fa-venus-mars:before {
  content: "\f228";
}
.fa-mars-stroke:before {
  content: "\f229";
}
.fa-mars-stroke-v:before {
  content: "\f22a";
}
.fa-mars-stroke-h:before {
  content: "\f22b";
}
.fa-neuter:before {
  content: "\f22c";
}
.fa-genderless:before {
  content: "\f22d";
}
.fa-facebook-official:before {
  content: "\f230";
}
.fa-pinterest-p:before {
  content: "\f231";
}
.fa-whatsapp:before {
  content: "\f232";
}
.fa-server:before {
  content: "\f233";
}
.fa-user-plus:before {
  content: "\f234";
}
.fa-user-times:before {
  content: "\f235";
}
.fa-hotel:before,
.fa-bed:before {
  content: "\f236";
}
.fa-viacoin:before {
  content: "\f237";
}
.fa-train:before {
  content: "\f238";
}
.fa-subway:before {
  content: "\f239";
}
.fa-medium:before {
  content: "\f23a";
}
.fa-yc:before,
.fa-y-combinator:before {
  content: "\f23b";
}
.fa-optin-monster:before {
  content: "\f23c";
}
.fa-opencart:before {
  content: "\f23d";
}
.fa-expeditedssl:before {
  content: "\f23e";
}
.fa-battery-4:before,
.fa-battery:before,
.fa-battery-full:before {
  content: "\f240";
}
.fa-battery-3:before,
.fa-battery-three-quarters:before {
  content: "\f241";
}
.fa-battery-2:before,
.fa-battery-half:before {
  content: "\f242";
}
.fa-battery-1:before,
.fa-battery-quarter:before {
  content: "\f243";
}
.fa-battery-0:before,
.fa-battery-empty:before {
  content: "\f244";
}
.fa-mouse-pointer:before {
  content: "\f245";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-object-group:before {
  content: "\f247";
}
.fa-object-ungroup:before {
  content: "\f248";
}
.fa-sticky-note:before {
  content: "\f249";
}
.fa-sticky-note-o:before {
  content: "\f24a";
}
.fa-cc-jcb:before {
  content: "\f24b";
}
.fa-cc-diners-club:before {
  content: "\f24c";
}
.fa-clone:before {
  content: "\f24d";
}
.fa-balance-scale:before {
  content: "\f24e";
}
.fa-hourglass-o:before {
  content: "\f250";
}
.fa-hourglass-1:before,
.fa-hourglass-start:before {
  content: "\f251";
}
.fa-hourglass-2:before,
.fa-hourglass-half:before {
  content: "\f252";
}
.fa-hourglass-3:before,
.fa-hourglass-end:before {
  content: "\f253";
}
.fa-hourglass:before {
  content: "\f254";
}
.fa-hand-grab-o:before,
.fa-hand-rock-o:before {
  content: "\f255";
}
.fa-hand-stop-o:before,
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-scissors-o:before {
  content: "\f257";
}
.fa-hand-lizard-o:before {
  content: "\f258";
}
.fa-hand-spock-o:before {
  content: "\f259";
}
.fa-hand-pointer-o:before {
  content: "\f25a";
}
.fa-hand-peace-o:before {
  content: "\f25b";
}
.fa-trademark:before {
  content: "\f25c";
}
.fa-registered:before {
  content: "\f25d";
}
.fa-creative-commons:before {
  content: "\f25e";
}
.fa-gg:before {
  content: "\f260";
}
.fa-gg-circle:before {
  content: "\f261";
}
.fa-tripadvisor:before {
  content: "\f262";
}
.fa-odnoklassniki:before {
  content: "\f263";
}
.fa-odnoklassniki-square:before {
  content: "\f264";
}
.fa-get-pocket:before {
  content: "\f265";
}
.fa-wikipedia-w:before {
  content: "\f266";
}
.fa-safari:before {
  content: "\f267";
}
.fa-chrome:before {
  content: "\f268";
}
.fa-firefox:before {
  content: "\f269";
}
.fa-opera:before {
  content: "\f26a";
}
.fa-internet-explorer:before {
  content: "\f26b";
}
.fa-tv:before,
.fa-television:before {
  content: "\f26c";
}
.fa-contao:before {
  content: "\f26d";
}
.fa-500px:before {
  content: "\f26e";
}
.fa-amazon:before {
  content: "\f270";
}
.fa-calendar-plus-o:before {
  content: "\f271";
}
.fa-calendar-minus-o:before {
  content: "\f272";
}
.fa-calendar-times-o:before {
  content: "\f273";
}
.fa-calendar-check-o:before {
  content: "\f274";
}
.fa-industry:before {
  content: "\f275";
}
.fa-map-pin:before {
  content: "\f276";
}
.fa-map-signs:before {
  content: "\f277";
}
.fa-map-o:before {
  content: "\f278";
}
.fa-map:before {
  content: "\f279";
}
.fa-commenting:before {
  content: "\f27a";
}
.fa-commenting-o:before {
  content: "\f27b";
}
.fa-houzz:before {
  content: "\f27c";
}
.fa-vimeo:before {
  content: "\f27d";
}
.fa-black-tie:before {
  content: "\f27e";
}
.fa-fonticons:before {
  content: "\f280";
}
.fa-reddit-alien:before {
  content: "\f281";
}
.fa-edge:before {
  content: "\f282";
}
.fa-credit-card-alt:before {
  content: "\f283";
}
.fa-codiepie:before {
  content: "\f284";
}
.fa-modx:before {
  content: "\f285";
}
.fa-fort-awesome:before {
  content: "\f286";
}
.fa-usb:before {
  content: "\f287";
}
.fa-product-hunt:before {
  content: "\f288";
}
.fa-mixcloud:before {
  content: "\f289";
}
.fa-scribd:before {
  content: "\f28a";
}
.fa-pause-circle:before {
  content: "\f28b";
}
.fa-pause-circle-o:before {
  content: "\f28c";
}
.fa-stop-circle:before {
  content: "\f28d";
}
.fa-stop-circle-o:before {
  content: "\f28e";
}
.fa-shopping-bag:before {
  content: "\f290";
}
.fa-shopping-basket:before {
  content: "\f291";
}
.fa-hashtag:before {
  content: "\f292";
}
.fa-bluetooth:before {
  content: "\f293";
}
.fa-bluetooth-b:before {
  content: "\f294";
}
.fa-percent:before {
  content: "\f295";
}
.fa-gitlab:before {
  content: "\f296";
}
.fa-wpbeginner:before {
  content: "\f297";
}
.fa-wpforms:before {
  content: "\f298";
}
.fa-envira:before {
  content: "\f299";
}
.fa-universal-access:before {
  content: "\f29a";
}
.fa-wheelchair-alt:before {
  content: "\f29b";
}
.fa-question-circle-o:before {
  content: "\f29c";
}
.fa-blind:before {
  content: "\f29d";
}
.fa-audio-description:before {
  content: "\f29e";
}
.fa-volume-control-phone:before {
  content: "\f2a0";
}
.fa-braille:before {
  content: "\f2a1";
}
.fa-assistive-listening-systems:before {
  content: "\f2a2";
}
.fa-asl-interpreting:before,
.fa-american-sign-language-interpreting:before {
  content: "\f2a3";
}
.fa-deafness:before,
.fa-hard-of-hearing:before,
.fa-deaf:before {
  content: "\f2a4";
}
.fa-glide:before {
  content: "\f2a5";
}
.fa-glide-g:before {
  content: "\f2a6";
}
.fa-signing:before,
.fa-sign-language:before {
  content: "\f2a7";
}
.fa-low-vision:before {
  content: "\f2a8";
}
.fa-viadeo:before {
  content: "\f2a9";
}
.fa-viadeo-square:before {
  content: "\f2aa";
}
.fa-snapchat:before {
  content: "\f2ab";
}
.fa-snapchat-ghost:before {
  content: "\f2ac";
}
.fa-snapchat-square:before {
  content: "\f2ad";
}
.fa-pied-piper:before {
  content: "\f2ae";
}
.fa-first-order:before {
  content: "\f2b0";
}
.fa-yoast:before {
  content: "\f2b1";
}
.fa-themeisle:before {
  content: "\f2b2";
}
.fa-google-plus-circle:before,
.fa-google-plus-official:before {
  content: "\f2b3";
}
.fa-fa:before,
.fa-font-awesome:before {
  content: "\f2b4";
}
.fa-handshake-o:before {
  content: "\f2b5";
}
.fa-envelope-open:before {
  content: "\f2b6";
}
.fa-envelope-open-o:before {
  content: "\f2b7";
}
.fa-linode:before {
  content: "\f2b8";
}
.fa-address-book:before {
  content: "\f2b9";
}
.fa-address-book-o:before {
  content: "\f2ba";
}
.fa-vcard:before,
.fa-address-card:before {
  content: "\f2bb";
}
.fa-vcard-o:before,
.fa-address-card-o:before {
  content: "\f2bc";
}
.fa-user-circle:before {
  content: "\f2bd";
}
.fa-user-circle-o:before {
  content: "\f2be";
}
.fa-user-o:before {
  content: "\f2c0";
}
.fa-id-badge:before {
  content: "\f2c1";
}
.fa-drivers-license:before,
.fa-id-card:before {
  content: "\f2c2";
}
.fa-drivers-license-o:before,
.fa-id-card-o:before {
  content: "\f2c3";
}
.fa-quora:before {
  content: "\f2c4";
}
.fa-free-code-camp:before {
  content: "\f2c5";
}
.fa-telegram:before {
  content: "\f2c6";
}
.fa-thermometer-4:before,
.fa-thermometer:before,
.fa-thermometer-full:before {
  content: "\f2c7";
}
.fa-thermometer-3:before,
.fa-thermometer-three-quarters:before {
  content: "\f2c8";
}
.fa-thermometer-2:before,
.fa-thermometer-half:before {
  content: "\f2c9";
}
.fa-thermometer-1:before,
.fa-thermometer-quarter:before {
  content: "\f2ca";
}
.fa-thermometer-0:before,
.fa-thermometer-empty:before {
  content: "\f2cb";
}
.fa-shower:before {
  content: "\f2cc";
}
.fa-bathtub:before,
.fa-s15:before,
.fa-bath:before {
  content: "\f2cd";
}
.fa-podcast:before {
  content: "\f2ce";
}
.fa-window-maximize:before {
  content: "\f2d0";
}
.fa-window-minimize:before {
  content: "\f2d1";
}
.fa-window-restore:before {
  content: "\f2d2";
}
.fa-times-rectangle:before,
.fa-window-close:before {
  content: "\f2d3";
}
.fa-times-rectangle-o:before,
.fa-window-close-o:before {
  content: "\f2d4";
}
.fa-bandcamp:before {
  content: "\f2d5";
}
.fa-grav:before {
  content: "\f2d6";
}
.fa-etsy:before {
  content: "\f2d7";
}
.fa-imdb:before {
  content: "\f2d8";
}
.fa-ravelry:before {
  content: "\f2d9";
}
.fa-eercast:before {
  content: "\f2da";
}
.fa-microchip:before {
  content: "\f2db";
}
.fa-snowflake-o:before {
  content: "\f2dc";
}
.fa-superpowers:before {
  content: "\f2dd";
}
.fa-wpexplorer:before {
  content: "\f2de";
}
.fa-meetup:before {
  content: "\f2e0";
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
div.traceback-wrapper pre.traceback {
  max-height: 600px;
  overflow: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 5px;
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
[dir="rtl"] #ipython_notebook {
  margin-right: 10px;
  margin-left: 0;
}
[dir="rtl"] #ipython_notebook.pull-left {
  float: right !important;
  float: right;
}
.flex-spacer {
  flex: 1;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#kernel_logo_widget {
  margin: 0 10px;
}
span#login_widget {
  float: right;
}
[dir="rtl"] span#login_widget {
  float: left;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
.modal-header {
  cursor: move;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
[dir="rtl"] .center-nav form.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] .center-nav .navbar-text {
  float: right;
}
[dir="rtl"] .navbar-inner {
  text-align: right;
}
[dir="rtl"] div.text-left {
  text-align: right;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
  cursor: pointer;
  opacity: 0;
  z-index: 2;
}
.alternate_upload .btn-xs > input.fileinput {
  margin: -1px -5px;
}
.alternate_upload .btn-upload {
  position: relative;
  height: 22px;
}
::-webkit-file-upload-button {
  cursor: pointer;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
[dir="rtl"] ul#tabs.nav-tabs > li {
  float: right;
}
[dir="rtl"] ul#tabs.nav.nav-tabs {
  padding-right: 0;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons .pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .list_toolbar .col-sm-4,
[dir="rtl"] .list_toolbar .col-sm-8 {
  float: right;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: text-bottom;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
[dir="rtl"] .list_item > div input {
  margin-right: 0;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_modified {
  margin-right: 7px;
  margin-left: 7px;
}
[dir="rtl"] .item_modified.pull-right {
  float: left !important;
  float: left;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
[dir="rtl"] .item_buttons.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .item_buttons .kernel-name {
  margin-left: 7px;
  float: right;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
.sort_button {
  display: inline-block;
  padding-left: 7px;
}
[dir="rtl"] .sort_button.pull-right {
  float: left !important;
  float: left;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
[dir="rtl"] #button-select-all.btn {
  float: right ;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
  margin-top: 2px;
  height: 16px;
}
[dir="rtl"] #select-all.pull-left {
  float: right !important;
  float: right;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.fa-pull-left {
  margin-right: .3em;
}
.folder_icon:before.fa-pull-right {
  margin-left: .3em;
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.fa-pull-left {
  margin-right: .3em;
}
.file_icon:before.fa-pull-right {
  margin-left: .3em;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
#new-menu .dropdown-header {
  font-size: 10px;
  border-bottom: 1px solid #e5e5e5;
  padding: 0 0 3px;
  margin: -3px 20px 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.move-button {
  display: none;
}
.download-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
.CodeMirror-dialog {
  background-color: #fff;
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}
.rendered_html ul {
  list-style: disc;
}
.rendered_html ul ul {
  list-style: square;
  margin-top: 0;
}
.rendered_html ul ul ul {
  list-style: circle;
}
.rendered_html ol {
  list-style: decimal;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin-top: 0;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
  padding: 0px;
  background-color: #fff;
}
.rendered_html code {
  background-color: #eff0f1;
}
.rendered_html p code {
  padding: 1px 5px;
}
.rendered_html pre code {
  background-color: #fff;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  color: #000;
  font-size: 100%;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
.rendered_html .alert {
  margin-bottom: initial;
}
.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] .rendered_html p {
  text-align: right;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered .rendered_html td {
  max-width: none;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
.jupyter-keybindings {
  padding: 1px;
  line-height: 24px;
  border-bottom: 1px solid gray;
}
.jupyter-keybindings input {
  margin: 0;
  padding: 0;
  border: none;
}
.jupyter-keybindings i {
  padding: 6px;
}
.well code {
  background-color: #ffffff;
  border-color: #ababab;
  border-width: 1px;
  border-style: solid;
  padding: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.tags_button_container {
  width: 100%;
  display: flex;
}
.tag-container {
  display: flex;
  flex-direction: row;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
}
.tag-container > * {
  margin: 0 4px;
}
.remove-tag-btn {
  margin-left: 4px;
}
.tags-input {
  display: flex;
}
.cell-tag:last-child:after {
  content: "";
  position: absolute;
  right: 0;
  width: 40px;
  height: 100%;
  /* Fade to background color of cell toolbar */
  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);
}
.tags-input > * {
  margin-left: 4px;
}
.cell-tag,
.tags-input input,
.tags-input button {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  box-shadow: none;
  width: inherit;
  font-size: inherit;
  height: 22px;
  line-height: 22px;
  padding: 0px 4px;
  display: inline-block;
}
.cell-tag:focus,
.tags-input input:focus,
.tags-input button:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.cell-tag::-moz-placeholder,
.tags-input input::-moz-placeholder,
.tags-input button::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.cell-tag:-ms-input-placeholder,
.tags-input input:-ms-input-placeholder,
.tags-input button:-ms-input-placeholder {
  color: #999;
}
.cell-tag::-webkit-input-placeholder,
.tags-input input::-webkit-input-placeholder,
.tags-input button::-webkit-input-placeholder {
  color: #999;
}
.cell-tag::-ms-expand,
.tags-input input::-ms-expand,
.tags-input button::-ms-expand {
  border: 0;
  background-color: transparent;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
.cell-tag[readonly],
.tags-input input[readonly],
.tags-input button[readonly],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  background-color: #eeeeee;
  opacity: 1;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  cursor: not-allowed;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button {
  height: auto;
}
select.cell-tag,
select.tags-input input,
select.tags-input button {
  height: 30px;
  line-height: 30px;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button,
select[multiple].cell-tag,
select[multiple].tags-input input,
select[multiple].tags-input button {
  height: auto;
}
.cell-tag,
.tags-input button {
  padding: 0px 4px;
}
.cell-tag {
  background-color: #fff;
  white-space: nowrap;
}
.tags-input input[type=text]:focus {
  outline: none;
  box-shadow: none;
  border-color: #ccc;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
[dir="rtl"] #kernel_logo_widget {
  float: left !important;
  float: left;
}
.modal .modal-body .move-path {
  display: flex;
  flex-direction: row;
  justify-content: space;
  align-items: center;
}
.modal .modal-body .move-path .server-root {
  padding-right: 20px;
}
.modal .modal-body .move-path .path-input {
  flex: 1;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
[dir="rtl"] #menubar .navbar-toggle {
  float: right;
}
[dir="rtl"] #menubar .navbar-collapse {
  clear: right;
}
[dir="rtl"] #menubar .navbar-nav {
  float: right;
}
[dir="rtl"] #menubar .nav {
  padding-right: 0px;
}
[dir="rtl"] #menubar .navbar-nav > li {
  float: right;
}
[dir="rtl"] #menubar .navbar-right {
  float: left !important;
}
[dir="rtl"] ul.dropdown-menu {
  text-align: right;
  left: auto;
}
[dir="rtl"] ul#new-menu.dropdown-menu {
  right: auto;
  left: 0;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
[dir="rtl"] i.menu-icon.pull-right {
  float: left !important;
  float: left;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
[dir="rtl"] ul#help_menu li a {
  padding-left: 2.2em;
}
[dir="rtl"] ul#help_menu li a i {
  margin-right: 0;
  margin-left: -1.2em;
}
[dir="rtl"] ul#help_menu li a i.pull-right {
  float: left !important;
  float: left;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
[dir="rtl"] .dropdown-submenu > .dropdown-menu {
  right: 100%;
  margin-right: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.fa-pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.fa-pull-right {
  margin-left: .3em;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
[dir="rtl"] .dropdown-submenu > a:after {
  float: left;
  content: "\f0d9";
  margin-right: 0;
  margin-left: -10px;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
[dir="rtl"] #notification_area {
  float: left !important;
  float: left;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] .indicator_area {
  float: left !important;
  float: left;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
[dir="rtl"] #kernel_indicator {
  float: left !important;
  float: left;
  border-left: 0;
  border-right: 1px solid;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] #modal_indicator {
  float: left !important;
  float: left;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  height: 30px;
  margin-top: 4px;
  display: flex;
  justify-content: flex-start;
  align-items: baseline;
  width: 50%;
  flex: 1;
}
span.save_widget span.filename {
  height: 100%;
  line-height: 1em;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
[dir="rtl"] span.save_widget.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] span.save_widget span.filename {
  margin-left: 0;
  margin-right: 16px;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
  white-space: nowrap;
  padding: 0 5px;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
    padding: 0 0 0 5px;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
.toolbar-btn-label {
  margin-left: 6px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
[dir="rtl"] .btn-group > .btn,
.btn-group-vertical > .btn {
  float: right;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
[dir="rtl"] ul.typeahead-list i {
  margin-left: 0;
  margin-right: -10px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
ul.typeahead-list  > li > a.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .typeahead-list {
  text-align: right;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  min-width: 20px;
  color: transparent;
}
[dir="rtl"] .no-shortcut.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .command-shortcut.pull-right {
  float: left !important;
  float: left;
}
.command-shortcut:before {
  content: "(command mode)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
[dir="rtl"] .edit-shortcut.pull-right {
  float: left !important;
  float: left;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
[dir="ltr"] #find-and-replace .input-group-btn + .form-control {
  border-left: none;
}
[dir="rtl"] #find-and-replace .input-group-btn + .form-control {
  border-right: none;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
<style type="text/css">
    
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }

    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Capstone-Project:-Create-a-Customer-Segmentation-Report-for-Arvato-Financial-Services">Capstone Project: Create a Customer Segmentation Report for Arvato Financial Services<a class="anchor-link" href="#Capstone-Project:-Create-a-Customer-Segmentation-Report-for-Arvato-Financial-Services">&#182;</a></h1><p>In this project, you will analyze demographics data for customers of a mail-order sales company in Germany, comparing it against demographics information for the general population. You'll use unsupervised learning techniques to perform customer segmentation, identifying the parts of the population that best describe the core customer base of the company. Then, you'll apply what you've learned on a third dataset with demographics information for targets of a marketing campaign for the company, and use a model to predict which individuals are most likely to convert into becoming customers for the company. The data that you will use has been provided by our partners at Bertelsmann Arvato Analytics, and represents a real-life data science task.</p>
<p>If you completed the first term of this program, you will be familiar with the first part of this project, from the unsupervised learning project. The versions of those two datasets used in this project will include many more features and has not been pre-cleaned. You are also free to choose whatever approach you'd like to analyzing the data rather than follow pre-determined steps. In your work on this project, make sure that you carefully document your steps and decisions, since your main deliverable for this project will be a blog post reporting your findings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># When using Google Colab we want to mount the data drive</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">google.colab</span> <span class="k">import</span> <span class="n">drive</span>
    <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Mounted at /content/drive
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip3 install -U scikit-learn
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (1.0.1)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn) (3.0.0)
Requirement already satisfied: numpy&gt;=1.14.6 in /usr/local/lib/python3.7/dist-packages (from scikit-learn) (1.19.5)
Requirement already satisfied: scipy&gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn) (1.4.1)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn) (1.1.0)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Install kneed package if not there</span>
<span class="n">kneed_installed</span> <span class="o">=</span> <span class="o">!</span>pip list <span class="p">|</span> grep kneed
<span class="k">if</span> <span class="ow">not</span> <span class="n">kneed_installed</span><span class="p">:</span>
    <span class="o">!</span>pip install kneed
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting kneed
  Downloading kneed-0.7.0-py2.py3-none-any.whl (9.4 kB)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from kneed) (3.2.2)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from kneed) (1.4.1)
Requirement already satisfied: numpy&gt;=1.14.2 in /usr/local/lib/python3.7/dist-packages (from kneed) (1.19.5)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;kneed) (1.3.2)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;kneed) (2.8.2)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;kneed) (2.4.7)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;kneed) (0.11.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib-&gt;kneed) (1.15.0)
Installing collected packages: kneed
Successfully installed kneed-0.7.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import libraries here; add more as necessary</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">entropy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="c1"># from functools import reduce</span>
<span class="kn">from</span> <span class="nn">timeit</span> <span class="k">import</span> <span class="n">default_timer</span> <span class="k">as</span> <span class="n">timer</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">gc</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># default=&#39;warn&#39;</span>

<span class="c1"># magic word for producing visualizations in notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Google Colab environment:</span>
<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="c1"># Get pandas version</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas version: &quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Pandas version:  1.1.5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-0:-Get-to-Know-the-Data">Part 0: Get to Know the Data<a class="anchor-link" href="#Part-0:-Get-to-Know-the-Data">&#182;</a></h2><p>There are four data files associated with this project:</p>
<ul>
<li><code>Udacity_AZDIAS_052018.csv</code>: Demographics data for the general population of Germany; 891 211 persons (rows) x 366 features (columns).</li>
<li><code>Udacity_CUSTOMERS_052018.csv</code>: Demographics data for customers of a mail-order company; 191 652 persons (rows) x 369 features (columns).</li>
<li><code>Udacity_MAILOUT_052018_TRAIN.csv</code>: Demographics data for individuals who were targets of a marketing campaign; 42 982 persons (rows) x 367 (columns).</li>
<li><code>Udacity_MAILOUT_052018_TEST.csv</code>: Demographics data for individuals who were targets of a marketing campaign; 42 833 persons (rows) x 366 (columns).</li>
</ul>
<p>Each row of the demographics files represents a single person, but also includes information outside of individuals, including information about their household, building, and neighborhood. Use the information from the first two files to figure out how customers ("CUSTOMERS") are similar to or differ from the general population at large ("AZDIAS"), then use your analysis to make predictions on the other two files ("MAILOUT"), predicting which recipients are most likely to become a customer for the mail-order company.</p>
<p>The "CUSTOMERS" file contains three extra columns ('CUSTOMER_GROUP', 'ONLINE_PURCHASE', and 'PRODUCT_GROUP'), which provide broad information about the customers depicted in the file. The original "MAILOUT" file included one additional column, "RESPONSE", which indicated whether or not each recipient became a customer of the company. For the "TRAIN" subset, this column has been retained, but in the "TEST" subset it has been removed; it is against that withheld column that your final predictions will be assessed in the Kaggle competition.</p>
<p>Otherwise, all of the remaining columns are the same between the three data files. For more information about the columns depicted in the files, you can refer to two Excel spreadsheets provided in the workspace. <a href="./DIAS Information Levels - Attributes 2017.xlsx">One of them</a> is a top-level list of attributes and descriptions, organized by informational category. <a href="./DIAS Attributes - Values 2017.xlsx">The other</a> is a detailed mapping of data values for each feature in alphabetical order.</p>
<p>In the below cell, we've provided some initial code to load in the first two datasets. Note for all of the <code>.csv</code> data files in this project that they're semicolon (<code>;</code>) delimited, so an additional argument in the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html"><code>read_csv()</code></a> call has been included to read in the data properly. Also, considering the size of the datasets, it may take some time for them to load completely.</p>
<p>You'll notice when the data is loaded in that a warning message will immediately pop up. Before you really start digging into the modeling and analysis, you're going to need to perform some cleaning. Take some time to browse the structure of the data and look over the informational spreadsheets to understand the data values. Make some decisions on which features to keep, which features to drop, and if any revisions need to be made on data formats. It'll be a good idea to create a function with pre-processing steps, since you'll need to clean all of the datasets before you work with them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Strategy-for-exploring-the-data:">Strategy for exploring the data:<a class="anchor-link" href="#Strategy-for-exploring-the-data:">&#182;</a></h2><ul>
<li>Load datasets. Initially load random samples, finally load the full datasets.</li>
<li>Load excel information files.</li>
<li>Get the attributes from excel files and compare them to the attributes appearing in the datasets.</li>
<li>Get the value pools for each known attribute in the excel files and check against the values for each attribute in the datasets.</li>
<li>Replace the values outside the pools with NaNs.</li>
<li>Replace values in the pools representing unknowns, missing, not given, etc. with NaNs.</li>
<li>Explore NaNs, analysing and understanding missing values in the two datasets.</li>
<li>Identify significance of categorical, ordinal attributes.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-data-and-excel-files">Load data and excel files<a class="anchor-link" href="#Load-data-and-excel-files">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Start timer notebook run</span>
<span class="n">start_run</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>

<span class="c1"># Current date/time suffix for filenames</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>

<span class="c1"># figure bbox caption</span>
<span class="n">cprt</span> <span class="o">=</span> <span class="s1">&#39;© 2021 · Chris Liatas&#39;</span>
<span class="c1"># copyright bbox properties</span>
<span class="n">bb_cprt_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;square,pad=47.8&#39;</span><span class="p">,</span> <span class="n">mutation_aspect</span><span class="o">=.</span><span class="mi">015</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Assign path names to variables for easier manipulation later on.</span>
<span class="n">colab_dir</span> <span class="o">=</span> <span class="s2">&quot;/content/drive/MyDrive/workspace/arvato_data/&quot;</span>
<span class="n">remote_dir</span> <span class="o">=</span> <span class="s2">&quot;../../data/Term2/capstone/arvato_data/&quot;</span>

<span class="n">azdias_file</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}Udacity_AZDIAS_052018.csv&quot;</span>
<span class="n">customers_file</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}Udacity_CUSTOMERS_052018.csv&quot;</span>
<span class="n">mailout_train_file</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}Udacity_MAILOUT_052018_TRAIN.csv&quot;</span>
<span class="n">mailout_test_file</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}Udacity_MAILOUT_052018_TEST.csv&quot;</span>

<span class="c1"># Files with information about the columns depicted in the csv files</span>
<span class="n">dias_attrib</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}DIAS Attributes - Values 2017.xlsx&quot;</span>
<span class="n">dias_info</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;{colab_dir if IN_COLAB else remote_dir}DIAS Information Levels - Attributes 2017.xlsx&quot;</span>

<span class="c1"># Kaggle submission file</span>
<span class="n">kg_submission</span> <span class="o">=</span> <span class="n">colab_dir</span> <span class="k">if</span> <span class="n">IN_COLAB</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># Kaggle competition</span>
<span class="n">kg_competition</span> <span class="o">=</span> <span class="s1">&#39;udacity-arvato-identify-customers&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will create a function to load a sample of the datasets to speed things up during the data exploration phase, particularly for the larger azdias dataset. This will reduce the memory used for holding the whole dataset initially, but also greatly improve the speed of calculations when exploring and cleaning the data. We will later use the whole dataset for best results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_df_sample</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a random sample out of an input csv file or the whole file.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_samples (int): Size of sample (number of rows) to randomly load from the input file.</span>
<span class="sd">        args, kwargs: Pass arguments and keyword arguments as in pandas `read_csv` method.</span>
<span class="sd">        Ref: https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dataframe loaded from the input file of n_samples rows</span>
<span class="sd">    </span>
<span class="sd">    Reference:</span>
<span class="sd">        Stack Overflow - `Read a small random sample from a big CSV file into a Python data frame`:</span>
<span class="sd">        https://stackoverflow.com/a/61631765/10074873</span>
<span class="sd">        Pandas - `Iterating through files chunk by chunk`:</span>
<span class="sd">        https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#iterating-through-files-chunk-by-chunk</span>
<span class="sd">        Numpy - `Random Generator`:</span>
<span class="sd">        https://numpy.org/doc/stable/reference/random/generator.html#random-generator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">samples_reader</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">samples_reader</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">samples_reader</span><span class="p">:</span>
        <span class="n">chunk</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">chunk</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">chunk</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Read first the attributes as strings, to get the categories and then use that to read them directly as categorical.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set to `True` to go through all the cells.</span>
<span class="n">RUN_ALL</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="c1"># Try loading a sample</span>
    <span class="n">azdias_try1</span> <span class="o">=</span> <span class="n">get_df_sample</span><span class="p">(</span><span class="mi">200000</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="n">azdias_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">256000</span><span class="p">)</span>

    <span class="n">azdias_try1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="c1"># Check the types of columns</span>
    <span class="n">azdias_try1</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="c1"># Check `object` columns</span>
    <span class="n">azdias_try1</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Check-columns-18,-19-that-produced-warnings-when-reading-csv-data">Check columns 18, 19 that produced warnings when reading csv data<a class="anchor-link" href="#Check-columns-18,-19-that-produced-warnings-when-reading-csv-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="c1"># Check the two columns to identify why pandas &quot;complained&quot; about mixed types</span>
    <span class="n">azdias_try1_1819</span> <span class="o">=</span> <span class="n">azdias_try1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]]</span>

    <span class="n">azdias_try1_1819</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The two attributes are <code>'CAMEO_DEUG_2015', 'CAMEO_INTL_2015'</code>. We should check their values range to further explore them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="n">azdias_try1_1819</span><span class="o">.</span><span class="n">CAMEO_DEUG_2015</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">azdias_try1_1819</span><span class="o">.</span><span class="n">CAMEO_INTL_2015</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">RUN_ALL</span><span class="p">:</span>
    <span class="c1"># Clean up</span>
    <span class="k">del</span> <span class="n">azdias_try1</span><span class="p">,</span> <span class="n">azdias_try1_1819</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In these columns there are two values <code>X</code> and <code>XX</code> respectively that fall outside the range of values for this attributes as seen in <code>DIAS Attributes - Values 2017.xlsx</code>.</p>
<h4 id="Importing-values-as-NaNs-at-loading-with-read_csv">Importing values as NaNs at loading with <code>read_csv</code><a class="anchor-link" href="#Importing-values-as-NaNs-at-loading-with-read_csv">&#182;</a></h4><p>By observing the helper files <code>DIAS Attributes - Values 2017.xlsx</code> and <code>DIAS Information Levels - Attributes 2017.xlsx</code> we can see that zeros (<code>0</code> or <code>0.0</code>) and <code>-1</code> (<code>-1</code> or <code>-1.0</code>) values may be converted to NaNs as they offer no information even in the fields that are considered as valid input. <code>na_values</code> argument of <code>read_csv</code> method will be used for this to do this conversion during data import. This will leave the value <code>9</code> that is considered as <code>unknown</code> in some variables to be processed later.</p>
<p>We will take advantage of the <code>na_values</code> argument in <code>read_csv</code>method to pass a tuple of values that will:</p>
<ul>
<li>convert specific values to NaNs</li>
<li>allow auto importing of attributes that were mixed types as specific types (numerical).</li>
</ul>
<p>We will also use <code>parse_dates</code> argument to import attribute <code>EINGEFUEGT_AM</code> as datetime.</p>
<p>There are there more categorical attributes (<code>'CAMEO_DEU_2015', 'D19_LETZTER_KAUF_BRANCHE', 'OST_WEST_KZ'</code>) that we can identify which will be converted later on.</p>
<p>We will initially use samples of the supplied datasets to be able to explore the data and perform all necessary computations faster, preventing notebook crashes due to insufficient memory.</p>
<p>A sample of 200,000 rows will be used for <code>AZDIAS</code> and 150,000 rows for <code>CUSTOMERS</code> datasets to keep a relative balance between the two datasets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azd_sample_size</span> <span class="o">=</span> <span class="mi">300000</span>
<span class="n">cus_sample_size</span> <span class="o">=</span> <span class="mi">150000</span>

<span class="c1"># Specific values to replace as np.NaN while loading the dataframe.</span>
<span class="n">na_tupl</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;XX&#39;</span><span class="p">)</span>

<span class="c1"># `read_csv` parameters dictionary</span>
<span class="n">read_csv_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;sep&#39;</span><span class="p">:</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;na_values&#39;</span><span class="p">:</span> <span class="n">na_tupl</span><span class="p">,</span>
    <span class="s1">&#39;chunksize&#39;</span><span class="p">:</span> <span class="mi">256000</span><span class="p">,</span>
    <span class="s1">&#39;parse_dates&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Read samples from azdias, customers datasets of size n rows, (use parse_dates to convert `EINGEFUEGT_AM` to datetime).</span>
<span class="n">azdias</span> <span class="o">=</span> <span class="n">get_df_sample</span><span class="p">(</span><span class="n">azd_sample_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">azdias_file</span><span class="p">,</span> <span class="o">**</span><span class="n">read_csv_kwargs</span><span class="p">)</span>
<span class="c1"># custrs = pd.read_csv(customers_file, sep=&#39;;&#39;, na_values=na_tupl, parse_dates=[&#39;EINGEFUEGT_AM&#39;])</span>
<span class="n">custrs</span> <span class="o">=</span> <span class="n">get_df_sample</span><span class="p">(</span><span class="n">cus_sample_size</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">customers_file</span><span class="p">,</span> <span class="o">**</span><span class="n">read_csv_kwargs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us check the dataframes now:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">custrs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((300000, 366), (150000, 369))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LNR</th>
      <th>AGER_TYP</th>
      <th>AKT_DAT_KL</th>
      <th>ALTER_HH</th>
      <th>ALTER_KIND1</th>
      <th>ALTER_KIND2</th>
      <th>ALTER_KIND3</th>
      <th>ALTER_KIND4</th>
      <th>ALTERSKATEGORIE_FEIN</th>
      <th>ANZ_HAUSHALTE_AKTIV</th>
      <th>ANZ_HH_TITEL</th>
      <th>ANZ_KINDER</th>
      <th>ANZ_PERSONEN</th>
      <th>ANZ_STATISTISCHE_HAUSHALTE</th>
      <th>ANZ_TITEL</th>
      <th>ARBEIT</th>
      <th>BALLRAUM</th>
      <th>CAMEO_DEU_2015</th>
      <th>CAMEO_DEUG_2015</th>
      <th>CAMEO_INTL_2015</th>
      <th>CJT_GESAMTTYP</th>
      <th>CJT_KATALOGNUTZER</th>
      <th>CJT_TYP_1</th>
      <th>CJT_TYP_2</th>
      <th>CJT_TYP_3</th>
      <th>CJT_TYP_4</th>
      <th>CJT_TYP_5</th>
      <th>CJT_TYP_6</th>
      <th>D19_BANKEN_ANZ_12</th>
      <th>D19_BANKEN_ANZ_24</th>
      <th>D19_BANKEN_DATUM</th>
      <th>D19_BANKEN_DIREKT</th>
      <th>D19_BANKEN_GROSS</th>
      <th>D19_BANKEN_LOKAL</th>
      <th>D19_BANKEN_OFFLINE_DATUM</th>
      <th>D19_BANKEN_ONLINE_DATUM</th>
      <th>D19_BANKEN_ONLINE_QUOTE_12</th>
      <th>D19_BANKEN_REST</th>
      <th>D19_BEKLEIDUNG_GEH</th>
      <th>D19_BEKLEIDUNG_REST</th>
      <th>...</th>
      <th>REGIOTYP</th>
      <th>RELAT_AB</th>
      <th>RETOURTYP_BK_S</th>
      <th>RT_KEIN_ANREIZ</th>
      <th>RT_SCHNAEPPCHEN</th>
      <th>RT_UEBERGROESSE</th>
      <th>SEMIO_DOM</th>
      <th>SEMIO_ERL</th>
      <th>SEMIO_FAM</th>
      <th>SEMIO_KAEM</th>
      <th>SEMIO_KRIT</th>
      <th>SEMIO_KULT</th>
      <th>SEMIO_LUST</th>
      <th>SEMIO_MAT</th>
      <th>SEMIO_PFLICHT</th>
      <th>SEMIO_RAT</th>
      <th>SEMIO_REL</th>
      <th>SEMIO_SOZ</th>
      <th>SEMIO_TRADV</th>
      <th>SEMIO_VERT</th>
      <th>SHOPPER_TYP</th>
      <th>SOHO_KZ</th>
      <th>STRUKTURTYP</th>
      <th>TITEL_KZ</th>
      <th>UMFELD_ALT</th>
      <th>UMFELD_JUNG</th>
      <th>UNGLEICHENN_FLAG</th>
      <th>VERDICHTUNGSRAUM</th>
      <th>VERS_TYP</th>
      <th>VHA</th>
      <th>VHN</th>
      <th>VK_DHT4A</th>
      <th>VK_DISTANZ</th>
      <th>VK_ZG11</th>
      <th>W_KEIT_KIND_HH</th>
      <th>WOHNDAUER_2008</th>
      <th>WOHNLAGE</th>
      <th>ZABEOTYP</th>
      <th>ANREDE_KZ</th>
      <th>ALTERSKATEGORIE_GROB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9372</th>
      <td>771330</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>6B</td>
      <td>6.0</td>
      <td>43.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2</td>
      <td>1</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>7</td>
      <td>5</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>150835</th>
      <td>482166</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3D</td>
      <td>3.0</td>
      <td>25.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>4</td>
      <td>7</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>92034</th>
      <td>364325</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>8B</td>
      <td>8.0</td>
      <td>41.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6</td>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>254110</th>
      <td>525434</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6B</td>
      <td>6.0</td>
      <td>43.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>179919</th>
      <td>701438</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>20.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>2B</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>8</td>
      <td>5</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>7</td>
      <td>6</td>
      <td>1</td>
      <td>5</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>228622</th>
      <td>600002</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1D</td>
      <td>1.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>7</td>
      <td>5</td>
      <td>2</td>
      <td>7</td>
      <td>7</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>4</td>
      <td>5</td>
      <td>7</td>
      <td>4</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>277041</th>
      <td>1054086</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>14.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>5A</td>
      <td>5.0</td>
      <td>31.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6</td>
      <td>6</td>
      <td>1</td>
      <td>7</td>
      <td>7</td>
      <td>1</td>
      <td>6</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>11.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>7 rows × 366 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 300000 entries, 0 to 299999
Columns: 366 entries, LNR to ALTERSKATEGORIE_GROB
dtypes: datetime64[ns](1), float64(320), int64(42), object(3)
memory usage: 837.7+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custrs</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LNR</th>
      <th>AGER_TYP</th>
      <th>AKT_DAT_KL</th>
      <th>ALTER_HH</th>
      <th>ALTER_KIND1</th>
      <th>ALTER_KIND2</th>
      <th>ALTER_KIND3</th>
      <th>ALTER_KIND4</th>
      <th>ALTERSKATEGORIE_FEIN</th>
      <th>ANZ_HAUSHALTE_AKTIV</th>
      <th>ANZ_HH_TITEL</th>
      <th>ANZ_KINDER</th>
      <th>ANZ_PERSONEN</th>
      <th>ANZ_STATISTISCHE_HAUSHALTE</th>
      <th>ANZ_TITEL</th>
      <th>ARBEIT</th>
      <th>BALLRAUM</th>
      <th>CAMEO_DEU_2015</th>
      <th>CAMEO_DEUG_2015</th>
      <th>CAMEO_INTL_2015</th>
      <th>CJT_GESAMTTYP</th>
      <th>CJT_KATALOGNUTZER</th>
      <th>CJT_TYP_1</th>
      <th>CJT_TYP_2</th>
      <th>CJT_TYP_3</th>
      <th>CJT_TYP_4</th>
      <th>CJT_TYP_5</th>
      <th>CJT_TYP_6</th>
      <th>D19_BANKEN_ANZ_12</th>
      <th>D19_BANKEN_ANZ_24</th>
      <th>D19_BANKEN_DATUM</th>
      <th>D19_BANKEN_DIREKT</th>
      <th>D19_BANKEN_GROSS</th>
      <th>D19_BANKEN_LOKAL</th>
      <th>D19_BANKEN_OFFLINE_DATUM</th>
      <th>D19_BANKEN_ONLINE_DATUM</th>
      <th>D19_BANKEN_ONLINE_QUOTE_12</th>
      <th>D19_BANKEN_REST</th>
      <th>D19_BEKLEIDUNG_GEH</th>
      <th>D19_BEKLEIDUNG_REST</th>
      <th>...</th>
      <th>RT_KEIN_ANREIZ</th>
      <th>RT_SCHNAEPPCHEN</th>
      <th>RT_UEBERGROESSE</th>
      <th>SEMIO_DOM</th>
      <th>SEMIO_ERL</th>
      <th>SEMIO_FAM</th>
      <th>SEMIO_KAEM</th>
      <th>SEMIO_KRIT</th>
      <th>SEMIO_KULT</th>
      <th>SEMIO_LUST</th>
      <th>SEMIO_MAT</th>
      <th>SEMIO_PFLICHT</th>
      <th>SEMIO_RAT</th>
      <th>SEMIO_REL</th>
      <th>SEMIO_SOZ</th>
      <th>SEMIO_TRADV</th>
      <th>SEMIO_VERT</th>
      <th>SHOPPER_TYP</th>
      <th>SOHO_KZ</th>
      <th>STRUKTURTYP</th>
      <th>TITEL_KZ</th>
      <th>UMFELD_ALT</th>
      <th>UMFELD_JUNG</th>
      <th>UNGLEICHENN_FLAG</th>
      <th>VERDICHTUNGSRAUM</th>
      <th>VERS_TYP</th>
      <th>VHA</th>
      <th>VHN</th>
      <th>VK_DHT4A</th>
      <th>VK_DISTANZ</th>
      <th>VK_ZG11</th>
      <th>W_KEIT_KIND_HH</th>
      <th>WOHNDAUER_2008</th>
      <th>WOHNLAGE</th>
      <th>ZABEOTYP</th>
      <th>PRODUCT_GROUP</th>
      <th>CUSTOMER_GROUP</th>
      <th>ONLINE_PURCHASE</th>
      <th>ANREDE_KZ</th>
      <th>ALTERSKATEGORIE_GROB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>136940</th>
      <td>728</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6</td>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>COSMETIC_AND_FOOD</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>75636</th>
      <td>157987</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>4A</td>
      <td>4.0</td>
      <td>22.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>3</td>
      <td>5</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>7</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>COSMETIC</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>75953</th>
      <td>3467</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>6</td>
      <td>3</td>
      <td>6</td>
      <td>6</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>7</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>COSMETIC_AND_FOOD</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>54865</th>
      <td>2272</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>2B</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3</td>
      <td>3</td>
      <td>6</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>6</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>COSMETIC</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>105606</th>
      <td>36931</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>1A</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>4</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>COSMETIC</td>
      <td>SINGLE_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>98948</th>
      <td>109437</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>2C</td>
      <td>2.0</td>
      <td>14.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>7</td>
      <td>5</td>
      <td>7</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>2</td>
      <td>FOOD</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>142772</th>
      <td>11872</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>4A</td>
      <td>4.0</td>
      <td>22.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>1</td>
      <td>COSMETIC_AND_FOOD</td>
      <td>MULTI_BUYER</td>
      <td>NaN</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>7 rows × 369 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custrs</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 150000 entries, 0 to 149999
Columns: 369 entries, LNR to ALTERSKATEGORIE_GROB
dtypes: datetime64[ns](1), float64(321), int64(42), object(5)
memory usage: 422.3+ MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, in <code>custrs</code> dataset the three extra columns (<code>'CUSTOMER_GROUP', 'ONLINE_PURCHASE', and 'PRODUCT_GROUP'</code>) are imported as one <code>float64</code> and two <code>object</code> dtypes, comparing to <code>azdias</code> columns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azd_obj_cols</span> <span class="o">=</span> <span class="n">azdias</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="n">azd_obj_cols</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CAMEO_DEU_2015</th>
      <th>D19_LETZTER_KAUF_BRANCHE</th>
      <th>OST_WEST_KZ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6B</td>
      <td>D19_VERSAND_REST</td>
      <td>O</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7B</td>
      <td>D19_UNBEKANNT</td>
      <td>W</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5B</td>
      <td>D19_UNBEKANNT</td>
      <td>W</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3C</td>
      <td>D19_BUCH_CD</td>
      <td>W</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1B</td>
      <td>D19_VERSAND_REST</td>
      <td>O</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cus_obj_cols</span> <span class="o">=</span> <span class="n">custrs</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>

<span class="n">cus_obj_cols</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CAMEO_DEU_2015</th>
      <th>D19_LETZTER_KAUF_BRANCHE</th>
      <th>OST_WEST_KZ</th>
      <th>PRODUCT_GROUP</th>
      <th>CUSTOMER_GROUP</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1A</td>
      <td>D19_UNBEKANNT</td>
      <td>W</td>
      <td>COSMETIC_AND_FOOD</td>
      <td>MULTI_BUYER</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>D19_BANKEN_GROSS</td>
      <td>NaN</td>
      <td>FOOD</td>
      <td>SINGLE_BUYER</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8A</td>
      <td>D19_TELKO_REST</td>
      <td>W</td>
      <td>COSMETIC</td>
      <td>MULTI_BUYER</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>COSMETIC_AND_FOOD</td>
      <td>MULTI_BUYER</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7B</td>
      <td>D19_SCHUHE</td>
      <td>W</td>
      <td>FOOD</td>
      <td>MULTI_BUYER</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convert the remaining <strong>object</strong> columns (<code>'CAMEO_DEU_2015', 'D19_LETZTER_KAUF_BRANCHE', 'OST_WEST_KZ', etc.</code>) to <strong>categorical</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the names of the columns to convert</span>
<span class="n">azd_cat_cols</span> <span class="o">=</span> <span class="n">azd_obj_cols</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">cus_cat_cols</span> <span class="o">=</span> <span class="n">cus_obj_cols</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c1"># Convert all three columns using astype method</span>
<span class="n">azdias</span><span class="p">[</span><span class="n">azd_cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">azdias</span><span class="p">[</span><span class="n">azd_cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">custrs</span><span class="p">[</span><span class="n">cus_cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">custrs</span><span class="p">[</span><span class="n">cus_cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

<span class="n">azdias</span><span class="p">[</span><span class="n">azd_cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>CAMEO_DEU_2015              category
D19_LETZTER_KAUF_BRANCHE    category
OST_WEST_KZ                 category
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explore-attributes-in-the-dataset(s)-and-excel-files">Explore attributes in the dataset(s) and excel files<a class="anchor-link" href="#Explore-attributes-in-the-dataset(s)-and-excel-files">&#182;</a></h2><h3 id="1.-Compare-attributes-between-the-two-excel-files">1. Compare attributes between the two excel files<a class="anchor-link" href="#1.-Compare-attributes-between-the-two-excel-files">&#182;</a></h3><p>Read in the excel files with attributes related information</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read in the mapping of data values for each feature in the DIAS dataset.</span>
<span class="n">attr_cols</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># skip the first column as it is empty</span>
<span class="n">dfdias_attrib</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">dias_attrib</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">attr_cols</span><span class="p">)</span>
<span class="n">dfdias_attrib</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attribute</th>
      <th>Description</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>-1</td>
      <td>unknown</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>no classification possible</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>passive elderly</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>cultural elderly</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>experience-driven elderly</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ALTERSKATEGORIE_GROB</td>
      <td>age classification through prename analysis</td>
      <td>-1, 0</td>
      <td>unknown</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>&lt; 30 years</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># DIAS Information Levels - Attributes 2017.xlsx</span>
<span class="n">dfdias_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">dias_info</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">attr_cols</span><span class="p">)</span>
<span class="n">dfdias_info</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Information level</th>
      <th>Attribute</th>
      <th>Description</th>
      <th>Additional notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>in cooperation with Kantar TNS; the informatio...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Person</td>
      <td>ALTERSKATEGORIE_GROB</td>
      <td>age through prename analysis</td>
      <td>modelled on millions of first name-age-referen...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>ANREDE_KZ</td>
      <td>gender</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>CJT_GESAMTTYP</td>
      <td>Customer-Journey-Typology relating to the pref...</td>
      <td>relating to the preferred information, marketi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>FINANZ_MINIMALIST</td>
      <td>financial typology: low financial interest</td>
      <td>Gfk-Typology based on a representative househo...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>FINANZ_SPARER</td>
      <td>financial typology: money saver</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>FINANZ_VORSORGER</td>
      <td>financial typology: be prepared</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get attributes&#39; names from the Attribute column in the two excel files</span>

<span class="c1"># `DIAS Information Levels - Attributes 2017.xlsx`</span>
<span class="n">dfdias_info_attrs</span> <span class="o">=</span> <span class="n">dfdias_info</span><span class="o">.</span><span class="n">Attribute</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># `DIAS Attributes - Values 2017.xlsx`</span>
<span class="n">attrbf_names</span> <span class="o">=</span> <span class="n">dfdias_attrib</span><span class="o">.</span><span class="n">Attribute</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Get the attribute names from `azdias` df columns:</span>
<span class="n">azd_attr_names</span> <span class="o">=</span> <span class="n">azdias</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Get the attribute names from `custrs` df columns:</span>
<span class="n">cus_attr_names</span> <span class="o">=</span> <span class="n">custrs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>

<span class="n">dfdias_info_attrs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">attrbf_names</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">azd_attr_names</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">cus_attr_names</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(313, 314, 366, 369)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the set intersection of the two arrays:</span>
<span class="c1"># We are comparing names as they were originally written in the files.</span>
<span class="n">xcl_attr_intersc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">attrbf_names</span><span class="p">,</span> <span class="n">dfdias_info_attrs</span><span class="p">)</span>

<span class="n">xcl_attr_intersc</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>300</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Attributes values excel file contains some different attributes compared to information excel file:</span>
<span class="n">xcl_attr_diff_vals_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">attrbf_names</span><span class="p">,</span> <span class="n">dfdias_info_attrs</span><span class="p">)</span>

<span class="n">xcl_attr_diff_vals_info</span><span class="p">,</span> <span class="n">xcl_attr_diff_vals_info</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;BIP_FLAG&#39;, &#39;D19_BANKEN_ANZ_12&#39;, &#39;D19_BANKEN_ANZ_24&#39;,
        &#39;D19_GESAMT_ANZ_12&#39;, &#39;D19_GESAMT_ANZ_24&#39;, &#39;D19_LOTTO_RZ&#39;,
        &#39;D19_TELKO_ANZ_12&#39;, &#39;D19_TELKO_ANZ_24&#39;, &#39;D19_VERSAND_ANZ_12&#39;,
        &#39;D19_VERSAND_ANZ_24&#39;, &#39;D19_VERSI_ANZ_12&#39;, &#39;D19_VERSI_ANZ_24&#39;,
        &#39;KBA13_CCM_3000&#39;, &#39;KBA13_CCM_3001&#39;], dtype=object), 14)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Information excel file contains some different attributes compared to attributes excel file:</span>
<span class="n">xcl_attr_diff_info_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">dfdias_info_attrs</span><span class="p">,</span> <span class="n">attrbf_names</span><span class="p">)</span>

<span class="n">xcl_attr_diff_info_vals</span><span class="p">,</span> <span class="n">xcl_attr_diff_info_vals</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ARBEIT&#39;, &#39;D19_BANKEN_ ANZ_12             D19_BANKEN_ ANZ_24&#39;,
        &#39;D19_GESAMT_ANZ_12                                    D19_GESAMT_ANZ_24&#39;,
        &#39;D19_TELKO_ ANZ_12                  D19_TELKO_ ANZ_24&#39;,
        &#39;D19_VERSAND_ ANZ_12          D19_VERSAND_ ANZ_24&#39;,
        &#39;D19_VERSI_ ANZ_12                                       D19_VERSI_ ANZ_24&#39;,
        &#39;D19_VERSI_DATUM&#39;, &#39;D19_VERSI_OFFLINE_DATUM&#39;,
        &#39;D19_VERSI_ONLINE_DATUM&#39;, &#39;EINWOHNER&#39;, &#39;GKZ&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;],
       dtype=object), 13)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking the symmetric difference of the attributes in excel files, we can observe that there are more common attributes, but we must perform some string operations to bring them in similar forms for comparison.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Symmetric difference of the two attributes&#39; sets.</span>
<span class="n">xcl_attrs_symtrc_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">xcl_attr_diff_vals_info</span><span class="p">,</span> <span class="n">xcl_attr_diff_info_vals</span><span class="p">)</span>

<span class="n">xcl_attrs_symtrc_diff</span><span class="p">,</span> <span class="n">xcl_attrs_symtrc_diff</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ARBEIT&#39;, &#39;BIP_FLAG&#39;,
        &#39;D19_BANKEN_ ANZ_12             D19_BANKEN_ ANZ_24&#39;,
        &#39;D19_BANKEN_ANZ_12&#39;, &#39;D19_BANKEN_ANZ_24&#39;, &#39;D19_GESAMT_ANZ_12&#39;,
        &#39;D19_GESAMT_ANZ_12                                    D19_GESAMT_ANZ_24&#39;,
        &#39;D19_GESAMT_ANZ_24&#39;, &#39;D19_LOTTO_RZ&#39;,
        &#39;D19_TELKO_ ANZ_12                  D19_TELKO_ ANZ_24&#39;,
        &#39;D19_TELKO_ANZ_12&#39;, &#39;D19_TELKO_ANZ_24&#39;,
        &#39;D19_VERSAND_ ANZ_12          D19_VERSAND_ ANZ_24&#39;,
        &#39;D19_VERSAND_ANZ_12&#39;, &#39;D19_VERSAND_ANZ_24&#39;,
        &#39;D19_VERSI_ ANZ_12                                       D19_VERSI_ ANZ_24&#39;,
        &#39;D19_VERSI_ANZ_12&#39;, &#39;D19_VERSI_ANZ_24&#39;, &#39;D19_VERSI_DATUM&#39;,
        &#39;D19_VERSI_OFFLINE_DATUM&#39;, &#39;D19_VERSI_ONLINE_DATUM&#39;, &#39;EINWOHNER&#39;,
        &#39;GKZ&#39;, &#39;KBA13_CCM_3000&#39;, &#39;KBA13_CCM_3001&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;],
       dtype=object), 27)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will fix the names of the attributes that seem different in the <code>DIAS Information Levels - Attributes 2017.xlsx</code> (or info) file.</p>
<ul>
<li>Parse lines containing more than one attribute</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will create a new list splitting the lines containing more than one attribute and stripping white space:</span>
<span class="n">xcl_attr_diff_info_vals_fxd</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xcl_attr_diff_info_vals</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

<span class="n">xcl_attr_diff_info_vals_fxd</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xcl_attr_diff_info_vals_fxd</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>([&#39;ARBEIT&#39;,
  &#39;D19_BANKEN_ ANZ_12&#39;,
  &#39;D19_BANKEN_ ANZ_24&#39;,
  &#39;D19_GESAMT_ANZ_12&#39;,
  &#39;D19_GESAMT_ANZ_24&#39;,
  &#39;D19_TELKO_ ANZ_12&#39;,
  &#39;D19_TELKO_ ANZ_24&#39;,
  &#39;D19_VERSAND_ ANZ_12&#39;,
  &#39;D19_VERSAND_ ANZ_24&#39;,
  &#39;D19_VERSI_ ANZ_12&#39;,
  &#39;D19_VERSI_ ANZ_24&#39;,
  &#39;D19_VERSI_DATUM&#39;,
  &#39;D19_VERSI_OFFLINE_DATUM&#39;,
  &#39;D19_VERSI_ONLINE_DATUM&#39;,
  &#39;EINWOHNER&#39;,
  &#39;GKZ&#39;,
  &#39;PLZ&#39;,
  &#39;PLZ8&#39;],
 18)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Expand the initial attributes list to include the newly identified attributes from above.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Our initial info attributes&#39; list needs to be expanded to compensate for elements that were packed together.</span>
<span class="n">dfdias_info_attrs_new</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Create a deep copy of the clean names list so it may be reused.</span>
<span class="n">attrs_to_append</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xcl_attr_diff_info_vals_fxd</span><span class="p">]</span>
<span class="c1"># For every element in the imported attributes from information file check against the </span>
<span class="c1"># fixed attribute names list and create a new list including fixed names.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dfdias_info_attrs</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xcl_attr_diff_info_vals</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">attrs_to_append</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attrs_to_append</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="n">dfdias_info_attrs_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="n">dfdias_info_attrs_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attrs_to_append</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">del</span> <span class="n">attrs_to_append</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">attrs_to_append</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dfdias_info_attrs_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="k">del</span> <span class="n">attrs_to_append</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># just copy the rest of the elements.</span>
        <span class="n">dfdias_info_attrs_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1"># Convert to numpy array</span>
<span class="n">dfdias_info_attrs_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dfdias_info_attrs_new</span><span class="p">)</span>

<span class="n">dfdias_info_attrs_new</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">80</span><span class="p">],</span> <span class="n">dfdias_info_attrs_new</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;D19_BEKLEIDUNG_GEH_RZ&#39;, &#39;PLZ8_ANTG3&#39;, &#39;KBA05_SEG3&#39;, &#39;KBA05_MOD1&#39;,
        &#39;D19_REISEN_RZ&#39;, &#39;KBA13_HERST_FORD_OPEL&#39;, &#39;KBA05_CCM3&#39;,
        &#39;KBA05_KRSKLEIN&#39;, &#39;FINANZTYP&#39;, &#39;CAMEO_DEU_2015&#39;,
        &#39;D19_VERSICHERUNGEN_RZ&#39;, &#39;PLZ8_ANTG1&#39;, &#39;RETOURTYP_BK_S&#39;,
        &#39;KBA13_CCM_0_1400&#39;, &#39;KBA05_ANTG2&#39;, &#39;KBA13_HALTER_66&#39;,
        &#39;FINANZ_ANLEGER&#39;, &#39;KBA13_SEG_OBERKLASSE&#39;, &#39;EWDICHTE&#39;,
        &#39;FINANZ_MINIMALIST&#39;], dtype=&#39;&lt;U27&#39;), 318)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have fixed the names we can compare the attributes between the two attributes' information files.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the set intersection of the two arrays:</span>
<span class="n">xcl_attr_intersc_fxd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">attrbf_names</span><span class="p">,</span> <span class="n">dfdias_info_attrs_new</span><span class="p">)</span>

<span class="n">xcl_attr_intersc_fxd</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>310</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Common attributes between the two files increased to 310. After this different attributes in each file become as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># DIAS Attributes - Values 2017.xlsx unique values:</span>
<span class="n">xcl_attr_diff_vals_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">attrbf_names</span><span class="p">,</span> <span class="n">dfdias_info_attrs_new</span><span class="p">)</span>

<span class="n">xcl_attr_diff_vals_info</span><span class="p">,</span> <span class="n">xcl_attr_diff_vals_info</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;BIP_FLAG&#39;, &#39;D19_LOTTO_RZ&#39;, &#39;KBA13_CCM_3000&#39;, &#39;KBA13_CCM_3001&#39;],
       dtype=object), 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># DIAS Information Levels - Attributes 2017.xlsx contains some different attributes compared to attributes excel file:</span>
<span class="n">xcl_attr_diff_info_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">dfdias_info_attrs_new</span><span class="p">,</span> <span class="n">attrbf_names</span><span class="p">)</span>

<span class="n">xcl_attr_diff_info_vals</span><span class="p">,</span> <span class="n">xcl_attr_diff_info_vals</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ARBEIT&#39;, &#39;D19_VERSI_DATUM&#39;, &#39;D19_VERSI_OFFLINE_DATUM&#39;,
        &#39;D19_VERSI_ONLINE_DATUM&#39;, &#39;EINWOHNER&#39;, &#39;GKZ&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;],
       dtype=&#39;&lt;U27&#39;), 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Symmetric difference of the two attributes&#39; sets.</span>
<span class="n">xcl_attrs_symtrc_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">xcl_attr_diff_vals_info</span><span class="p">,</span> <span class="n">xcl_attr_diff_info_vals</span><span class="p">)</span>

<span class="n">xcl_attrs_symtrc_diff</span><span class="p">,</span> <span class="n">xcl_attrs_symtrc_diff</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ARBEIT&#39;, &#39;BIP_FLAG&#39;, &#39;D19_LOTTO_RZ&#39;, &#39;D19_VERSI_DATUM&#39;,
        &#39;D19_VERSI_OFFLINE_DATUM&#39;, &#39;D19_VERSI_ONLINE_DATUM&#39;, &#39;EINWOHNER&#39;,
        &#39;GKZ&#39;, &#39;KBA13_CCM_3000&#39;, &#39;KBA13_CCM_3001&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;],
       dtype=object), 12)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Take the union for the total of unique values in both files together.</span>
<span class="n">xcl_attrs_unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">attrbf_names</span><span class="p">,</span> <span class="n">dfdias_info_attrs_new</span><span class="p">)</span>

<span class="n">xcl_attrs_unique</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>322</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The two Excel spreadsheets provided in the workspace (<code>DIAS Information Levels - Attributes 2017.xlsx</code> and <code>DIAS Attributes - Values 2017.xlsx</code>) contain 310 common attributes. In addition the first file contains 8 unique attributes while the second 4 unique attributes. In total there are 322 unique attributes present in both files together.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-azdias,-custrs-datasets-to-the-unique-attributes-from-the-two-excel-files.">Comparing <code>azdias</code>, <code>custrs</code> datasets to the unique attributes from the two excel files.<a class="anchor-link" href="#Comparing-azdias,-custrs-datasets-to-the-unique-attributes-from-the-two-excel-files.">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">attrs_intesc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">azd_attr_names</span><span class="p">,</span> <span class="n">xcl_attrs_unique</span><span class="p">)</span>

<span class="n">azd_attr_names</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xcl_attrs_unique</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">attrs_intesc</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(366, 322, 276)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the customers dataset, they only different attributes should be the 3 extra ones in the customers dataset, so the intersection should be the same as for <code>azdias</code> dataset:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">attrs_intesc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">cus_attr_names</span><span class="p">,</span> <span class="n">xcl_attrs_unique</span><span class="p">)</span>

<span class="n">cus_attr_names</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xcl_attrs_unique</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">attrs_intesc</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(369, 322, 276)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At first look, we see that only 276 attributes are common. To explore what happens with the rest, we will look at the different attributes from the excel files.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set difference of excel unique attributes - azdias set attributes will give us the different excel attributes:</span>
<span class="n">difrnt_xcl_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">xcl_attrs_unique</span><span class="p">,</span> <span class="n">azd_attr_names</span><span class="p">)</span>

<span class="n">difrnt_xcl_attrs</span><span class="p">,</span> <span class="n">difrnt_xcl_attrs</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;BIP_FLAG&#39;, &#39;CAMEO_DEUINTL_2015&#39;, &#39;D19_BANKEN_DIREKT_RZ&#39;,
        &#39;D19_BANKEN_GROSS_RZ&#39;, &#39;D19_BANKEN_LOKAL_RZ&#39;, &#39;D19_BANKEN_REST_RZ&#39;,
        &#39;D19_BEKLEIDUNG_GEH_RZ&#39;, &#39;D19_BEKLEIDUNG_REST_RZ&#39;,
        &#39;D19_BILDUNG_RZ&#39;, &#39;D19_BIO_OEKO_RZ&#39;, &#39;D19_BUCH_RZ&#39;,
        &#39;D19_DIGIT_SERV_RZ&#39;, &#39;D19_DROGERIEARTIKEL_RZ&#39;, &#39;D19_ENERGIE_RZ&#39;,
        &#39;D19_FREIZEIT_RZ&#39;, &#39;D19_GARTEN_RZ&#39;, &#39;D19_HANDWERK_RZ&#39;,
        &#39;D19_HAUS_DEKO_RZ&#39;, &#39;D19_KINDERARTIKEL_RZ&#39;, &#39;D19_KK_KUNDENTYP&#39;,
        &#39;D19_KOSMETIK_RZ&#39;, &#39;D19_LEBENSMITTEL_RZ&#39;, &#39;D19_LOTTO_RZ&#39;,
        &#39;D19_NAHRUNGSERGAENZUNG_RZ&#39;, &#39;D19_RATGEBER_RZ&#39;, &#39;D19_REISEN_RZ&#39;,
        &#39;D19_SAMMELARTIKEL_RZ&#39;, &#39;D19_SCHUHE_RZ&#39;, &#39;D19_SONSTIGE_RZ&#39;,
        &#39;D19_TECHNIK_RZ&#39;, &#39;D19_TELKO_MOBILE_RZ&#39;, &#39;D19_TELKO_REST_RZ&#39;,
        &#39;D19_TIERARTIKEL_RZ&#39;, &#39;D19_VERSAND_REST_RZ&#39;,
        &#39;D19_VERSICHERUNGEN_RZ&#39;, &#39;D19_VOLLSORTIMENT_RZ&#39;,
        &#39;D19_WEIN_FEINKOST_RZ&#39;, &#39;EINWOHNER&#39;, &#39;GEOSCORE_KLS7&#39;, &#39;GKZ&#39;,
        &#39;HAUSHALTSSTRUKTUR&#39;, &#39;KBA13_CCM_1400_2500&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;,
        &#39;SOHO_FLAG&#39;, &#39;WACHSTUMSGEBIET_NB&#39;], dtype=object), 46)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examining the <code>azdias</code> (and <code>customers</code>) columns' names we can observe that most of the above names are not actually missing but have been named slightly different. So, for example <code>CAMEO_INTL_2015</code> in azdias dataset is <code>CAMEO_DEUINTL_2015</code> in the attributes’ explanations file. This means we have to perform some operations to match the columns that appear different. We can create a dictionary to match old names with the new names, to rename the attributes' from excel files as in the azdias dataset. For most of the columns names with the prefix <code>D19_</code> if we remove the suffix <code>_RZ</code> we have the desired names.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also try to identify the rest of attributes, for example with <code>FLAG</code> in name and do the same for the rest, but not for <code>D19_</code> as we already know that only the suffix <code>_RZ</code> is missing from the name, hence it is seen as different string in the code comparisons.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">attr_flag</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;FLAG&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_bip</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;BIP&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_soho</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;SOHO&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_kba131400</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;KBA13_CCM_14&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_geosc</span> <span class="o">=</span><span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;GEO&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_haus</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;HAUS&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_wach</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;WACH&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_gkz</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;GKZ&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">attr_plz</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">azd_attr_names</span> <span class="k">if</span> <span class="s1">&#39;PLZ&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>

<span class="n">attr_flag</span><span class="p">,</span> <span class="n">attr_bip</span><span class="p">,</span> <span class="n">attr_soho</span><span class="p">,</span> <span class="n">attr_kba131400</span><span class="p">,</span> <span class="n">attr_geosc</span><span class="p">,</span> \
<span class="n">attr_haus</span><span class="p">,</span> <span class="n">attr_wach</span><span class="p">,</span> <span class="n">attr_gkz</span><span class="p">,</span> <span class="n">attr_plz</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>([&#39;DSL_FLAG&#39;, &#39;HH_DELTA_FLAG&#39;, &#39;UNGLEICHENN_FLAG&#39;],
 [],
 [&#39;SOHO_KZ&#39;],
 [&#39;KBA13_CCM_1400&#39;, &#39;KBA13_CCM_1401_2500&#39;],
 [&#39;KBA13_PEUGEOT&#39;],
 [&#39;ANZ_HAUSHALTE_AKTIV&#39;,
  &#39;ANZ_STATISTISCHE_HAUSHALTE&#39;,
  &#39;D19_HAUS_DEKO&#39;,
  &#39;FINANZ_HAUSBAUER&#39;],
 [],
 [],
 [&#39;PLZ8_ANTG1&#39;,
  &#39;PLZ8_ANTG2&#39;,
  &#39;PLZ8_ANTG3&#39;,
  &#39;PLZ8_ANTG4&#39;,
  &#39;PLZ8_BAUMAX&#39;,
  &#39;PLZ8_GBZ&#39;,
  &#39;PLZ8_HHZ&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the above we see that we also have attributes <code>'SOHO_KZ', 'KBA13_CCM_1401_2500'</code> we can match. These matches will greatly reduce the number of different attributes in the azdias dataset when compared to the attributes' excel files. However, azdias dataset has some more attributes in addition to the ones present in the attributes files.</p>
<p>There are no additional attributes for <code>GKZ</code> and <code>PLZ</code> or <code>PLZ8</code> in azdias dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a dictionary with key: value the old names replacing all `D19_*` names containing `_RZ`</span>
<span class="n">xcl_attr_names_new</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;_RZ&#39;</span> <span class="ow">in</span> <span class="n">i</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">difrnt_xcl_attrs</span><span class="p">}</span>
<span class="c1"># Replace SOHO_FLAG:</span>
<span class="n">xcl_attr_names_new</span><span class="p">[</span><span class="s2">&quot;SOHO_FLAG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SOHO_KZ&#39;</span>
<span class="c1"># Replace CAMEO_DEUINTL_2015:</span>
<span class="n">xcl_attr_names_new</span><span class="p">[</span><span class="s2">&quot;CAMEO_DEUINTL_2015&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CAMEO_INTL_2015&#39;</span>
<span class="c1"># Replace KBA13_CCM_1400_2500:</span>
<span class="n">xcl_attr_names_new</span><span class="p">[</span><span class="s2">&quot;KBA13_CCM_1400_2500&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;KBA13_CCM_1401_2500&#39;</span>

<span class="n">xcl_attr_names_new</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>dict_items([(&#39;BIP_FLAG&#39;, &#39;BIP_FLAG&#39;), (&#39;CAMEO_DEUINTL_2015&#39;, &#39;CAMEO_INTL_2015&#39;), (&#39;D19_BANKEN_DIREKT_RZ&#39;, &#39;D19_BANKEN_DIREKT&#39;), (&#39;D19_BANKEN_GROSS_RZ&#39;, &#39;D19_BANKEN_GROSS&#39;), (&#39;D19_BANKEN_LOKAL_RZ&#39;, &#39;D19_BANKEN_LOKAL&#39;), (&#39;D19_BANKEN_REST_RZ&#39;, &#39;D19_BANKEN_REST&#39;), (&#39;D19_BEKLEIDUNG_GEH_RZ&#39;, &#39;D19_BEKLEIDUNG_GEH&#39;), (&#39;D19_BEKLEIDUNG_REST_RZ&#39;, &#39;D19_BEKLEIDUNG_REST&#39;), (&#39;D19_BILDUNG_RZ&#39;, &#39;D19_BILDUNG&#39;), (&#39;D19_BIO_OEKO_RZ&#39;, &#39;D19_BIO_OEKO&#39;), (&#39;D19_BUCH_RZ&#39;, &#39;D19_BUCH&#39;), (&#39;D19_DIGIT_SERV_RZ&#39;, &#39;D19_DIGIT_SERV&#39;), (&#39;D19_DROGERIEARTIKEL_RZ&#39;, &#39;D19_DROGERIEARTIKEL&#39;), (&#39;D19_ENERGIE_RZ&#39;, &#39;D19_ENERGIE&#39;), (&#39;D19_FREIZEIT_RZ&#39;, &#39;D19_FREIZEIT&#39;), (&#39;D19_GARTEN_RZ&#39;, &#39;D19_GARTEN&#39;), (&#39;D19_HANDWERK_RZ&#39;, &#39;D19_HANDWERK&#39;), (&#39;D19_HAUS_DEKO_RZ&#39;, &#39;D19_HAUS_DEKO&#39;), (&#39;D19_KINDERARTIKEL_RZ&#39;, &#39;D19_KINDERARTIKEL&#39;), (&#39;D19_KK_KUNDENTYP&#39;, &#39;D19_KK_KUNDENTYP&#39;), (&#39;D19_KOSMETIK_RZ&#39;, &#39;D19_KOSMETIK&#39;), (&#39;D19_LEBENSMITTEL_RZ&#39;, &#39;D19_LEBENSMITTEL&#39;), (&#39;D19_LOTTO_RZ&#39;, &#39;D19_LOTTO&#39;), (&#39;D19_NAHRUNGSERGAENZUNG_RZ&#39;, &#39;D19_NAHRUNGSERGAENZUNG&#39;), (&#39;D19_RATGEBER_RZ&#39;, &#39;D19_RATGEBER&#39;), (&#39;D19_REISEN_RZ&#39;, &#39;D19_REISEN&#39;), (&#39;D19_SAMMELARTIKEL_RZ&#39;, &#39;D19_SAMMELARTIKEL&#39;), (&#39;D19_SCHUHE_RZ&#39;, &#39;D19_SCHUHE&#39;), (&#39;D19_SONSTIGE_RZ&#39;, &#39;D19_SONSTIGE&#39;), (&#39;D19_TECHNIK_RZ&#39;, &#39;D19_TECHNIK&#39;), (&#39;D19_TELKO_MOBILE_RZ&#39;, &#39;D19_TELKO_MOBILE&#39;), (&#39;D19_TELKO_REST_RZ&#39;, &#39;D19_TELKO_REST&#39;), (&#39;D19_TIERARTIKEL_RZ&#39;, &#39;D19_TIERARTIKEL&#39;), (&#39;D19_VERSAND_REST_RZ&#39;, &#39;D19_VERSAND_REST&#39;), (&#39;D19_VERSICHERUNGEN_RZ&#39;, &#39;D19_VERSICHERUNGEN&#39;), (&#39;D19_VOLLSORTIMENT_RZ&#39;, &#39;D19_VOLLSORTIMENT&#39;), (&#39;D19_WEIN_FEINKOST_RZ&#39;, &#39;D19_WEIN_FEINKOST&#39;), (&#39;EINWOHNER&#39;, &#39;EINWOHNER&#39;), (&#39;GEOSCORE_KLS7&#39;, &#39;GEOSCORE_KLS7&#39;), (&#39;GKZ&#39;, &#39;GKZ&#39;), (&#39;HAUSHALTSSTRUKTUR&#39;, &#39;HAUSHALTSSTRUKTUR&#39;), (&#39;KBA13_CCM_1400_2500&#39;, &#39;KBA13_CCM_1401_2500&#39;), (&#39;PLZ&#39;, &#39;PLZ&#39;), (&#39;PLZ8&#39;, &#39;PLZ8&#39;), (&#39;SOHO_FLAG&#39;, &#39;SOHO_KZ&#39;), (&#39;WACHSTUMSGEBIET_NB&#39;, &#39;WACHSTUMSGEBIET_NB&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us rename the corresponding attribute names rows as per above dictionary and compare to <code>azdias</code> attributes again:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a copy of the `xcl_attrs_unique`</span>
<span class="n">xcl_attrs_unique_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">xcl_attrs_unique</span><span class="p">)</span>

<span class="c1"># Rename specific attributes based on the created dictionary</span>
<span class="n">xcl_attrs_unique_new</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">xcl_attr_names_new</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Compare to `azdias` attributes again taking the sets intersection</span>
<span class="n">attrs_common</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">azd_attr_names</span><span class="p">,</span> <span class="n">xcl_attrs_unique_new</span><span class="p">)</span>

<span class="n">azd_attr_names</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xcl_attrs_unique_new</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">attrs_common</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(366, 322, 312)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are 312 attributes in <code>azdias</code> dataset which are also present in the attributes explanatory excel files. Azdias dataset contains 54 additional attributes:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Let&#39;s see for the attributes&#39; file what are the different attributes according to the previous intersection</span>
<span class="n">azdias_only_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">azd_attr_names</span><span class="p">,</span> <span class="n">xcl_attrs_unique_new</span><span class="p">)</span>

<span class="n">azdias_only_attrs</span><span class="p">,</span> <span class="n">azdias_only_attrs</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;AKT_DAT_KL&#39;, &#39;ALTERSKATEGORIE_FEIN&#39;, &#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;,
        &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;, &#39;ANZ_KINDER&#39;,
        &#39;ANZ_STATISTISCHE_HAUSHALTE&#39;, &#39;CJT_KATALOGNUTZER&#39;, &#39;CJT_TYP_1&#39;,
        &#39;CJT_TYP_2&#39;, &#39;CJT_TYP_3&#39;, &#39;CJT_TYP_4&#39;, &#39;CJT_TYP_5&#39;, &#39;CJT_TYP_6&#39;,
        &#39;D19_BUCH_CD&#39;, &#39;D19_KONSUMTYP_MAX&#39;, &#39;D19_LETZTER_KAUF_BRANCHE&#39;,
        &#39;D19_SOZIALES&#39;, &#39;D19_TELKO_ONLINE_QUOTE_12&#39;,
        &#39;D19_VERSI_ONLINE_QUOTE_12&#39;, &#39;DSL_FLAG&#39;, &#39;EINGEFUEGT_AM&#39;,
        &#39;EINGEZOGENAM_HH_JAHR&#39;, &#39;EXTSEL992&#39;, &#39;FIRMENDICHTE&#39;, &#39;GEMEINDETYP&#39;,
        &#39;HH_DELTA_FLAG&#39;, &#39;KBA13_ANTG1&#39;, &#39;KBA13_ANTG2&#39;, &#39;KBA13_ANTG3&#39;,
        &#39;KBA13_ANTG4&#39;, &#39;KBA13_BAUMAX&#39;, &#39;KBA13_GBZ&#39;, &#39;KBA13_HHZ&#39;,
        &#39;KBA13_KMH_210&#39;, &#39;KK_KUNDENTYP&#39;, &#39;KOMBIALTER&#39;, &#39;KONSUMZELLE&#39;,
        &#39;LNR&#39;, &#39;MOBI_RASTER&#39;, &#39;RT_KEIN_ANREIZ&#39;, &#39;RT_SCHNAEPPCHEN&#39;,
        &#39;RT_UEBERGROESSE&#39;, &#39;STRUKTURTYP&#39;, &#39;UMFELD_ALT&#39;, &#39;UMFELD_JUNG&#39;,
        &#39;UNGLEICHENN_FLAG&#39;, &#39;VERDICHTUNGSRAUM&#39;, &#39;VHA&#39;, &#39;VHN&#39;, &#39;VK_DHT4A&#39;,
        &#39;VK_DISTANZ&#39;, &#39;VK_ZG11&#39;], dtype=object), 54)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And <code>customers</code> dataframe has the above plus the three additional columns, as described in the project description.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custrs_only_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">cus_attr_names</span><span class="p">,</span> <span class="n">xcl_attrs_unique_new</span><span class="p">)</span>

<span class="n">custrs_only_attrs</span><span class="p">,</span> <span class="n">custrs_only_attrs</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;AKT_DAT_KL&#39;, &#39;ALTERSKATEGORIE_FEIN&#39;, &#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;,
        &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;, &#39;ANZ_KINDER&#39;,
        &#39;ANZ_STATISTISCHE_HAUSHALTE&#39;, &#39;CJT_KATALOGNUTZER&#39;, &#39;CJT_TYP_1&#39;,
        &#39;CJT_TYP_2&#39;, &#39;CJT_TYP_3&#39;, &#39;CJT_TYP_4&#39;, &#39;CJT_TYP_5&#39;, &#39;CJT_TYP_6&#39;,
        &#39;CUSTOMER_GROUP&#39;, &#39;D19_BUCH_CD&#39;, &#39;D19_KONSUMTYP_MAX&#39;,
        &#39;D19_LETZTER_KAUF_BRANCHE&#39;, &#39;D19_SOZIALES&#39;,
        &#39;D19_TELKO_ONLINE_QUOTE_12&#39;, &#39;D19_VERSI_ONLINE_QUOTE_12&#39;,
        &#39;DSL_FLAG&#39;, &#39;EINGEFUEGT_AM&#39;, &#39;EINGEZOGENAM_HH_JAHR&#39;, &#39;EXTSEL992&#39;,
        &#39;FIRMENDICHTE&#39;, &#39;GEMEINDETYP&#39;, &#39;HH_DELTA_FLAG&#39;, &#39;KBA13_ANTG1&#39;,
        &#39;KBA13_ANTG2&#39;, &#39;KBA13_ANTG3&#39;, &#39;KBA13_ANTG4&#39;, &#39;KBA13_BAUMAX&#39;,
        &#39;KBA13_GBZ&#39;, &#39;KBA13_HHZ&#39;, &#39;KBA13_KMH_210&#39;, &#39;KK_KUNDENTYP&#39;,
        &#39;KOMBIALTER&#39;, &#39;KONSUMZELLE&#39;, &#39;LNR&#39;, &#39;MOBI_RASTER&#39;,
        &#39;ONLINE_PURCHASE&#39;, &#39;PRODUCT_GROUP&#39;, &#39;RT_KEIN_ANREIZ&#39;,
        &#39;RT_SCHNAEPPCHEN&#39;, &#39;RT_UEBERGROESSE&#39;, &#39;STRUKTURTYP&#39;, &#39;UMFELD_ALT&#39;,
        &#39;UMFELD_JUNG&#39;, &#39;UNGLEICHENN_FLAG&#39;, &#39;VERDICHTUNGSRAUM&#39;, &#39;VHA&#39;,
        &#39;VHN&#39;, &#39;VK_DHT4A&#39;, &#39;VK_DISTANZ&#39;, &#39;VK_ZG11&#39;], dtype=object), 57)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Attributes unique to excel files.</span>
<span class="n">xcl_only_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">xcl_attrs_unique_new</span><span class="p">,</span> <span class="n">azd_attr_names</span><span class="p">)</span>

<span class="n">xcl_only_attrs</span><span class="p">,</span> <span class="n">xcl_only_attrs</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;BIP_FLAG&#39;, &#39;D19_BUCH&#39;, &#39;D19_KK_KUNDENTYP&#39;, &#39;EINWOHNER&#39;,
        &#39;GEOSCORE_KLS7&#39;, &#39;GKZ&#39;, &#39;HAUSHALTSSTRUKTUR&#39;, &#39;PLZ&#39;, &#39;PLZ8&#39;,
        &#39;WACHSTUMSGEBIET_NB&#39;], dtype=object), 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>attrs_common</code> - 312 common attributes between <code>azdias</code> dataset and both excel files combined.</li>
<li><code>azdias_only_attrs</code> - 54 attributes appearing only in <code>azdias</code> dataset.</li>
<li><code>xcl_attrs_unique_new</code> - 322 unique attributes in both excel files combined.</li>
<li><code>xcl_only_attrs</code> - 10 attributes appearing only in excel files.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For 322 unique attributes present in both excel files combined there are 312 in common with the <code>azdias</code> dataset, leaving out 54 attributes known only in <code>azdias</code> dataset. Most of these seem to be related to attributes found in the excel files. For example <code>CJT</code> attribute in excel files seems to be related to the series of <code>CJT_TYP_*</code> attributes in azdias dataset. These are probably derived attributes to allow more granularity of collected information in certain fields.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias</span><span class="p">[</span><span class="s2">&quot;CJT_TYP_1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>5.0    89881
2.0    66243
3.0    57721
4.0    55071
1.0    29508
Name: CJT_TYP_1, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Identify-and-replace-out-of-range-and-unknown-values-with-NaNs">Identify and replace out of range and unknown values with NaNs<a class="anchor-link" href="#Identify-and-replace-out-of-range-and-unknown-values-with-NaNs">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have already made some value replacements when loading the <code>.csv</code> files. We observe that some attributes include values outside the pool of values described in the information excel files. These values that are outside the allowed values described in the relevant excel files will be identified and replaced with NaNs. The process we will follow is:</p>
<ul>
<li>We will get the allowed values pool for each attribute from the excel file <code>DIAS Attributes - Values 2017.xlsx</code>.</li>
<li>We will create a dictionary, mapping attribute names to value pools.</li>
<li>We will in turn search the relevant columns in <code>azdias</code> and <code>customers</code> datasets and replace all the values outside these pools with NaNs.</li>
</ul>
<p>In addition, there are some special cases where the allowed values are not specified, or the attributes do not have corresponding information in any of the excel files. These will have to be treated case by case.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># In attributes values excel replace NaNs in attribute names with forward fill method ffill</span>
<span class="c1"># to make it easier to extract specific attribute names and values</span>
<span class="n">dfdias_attrib_ffil</span> <span class="o">=</span> <span class="n">dfdias_attrib</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>

<span class="n">dfdias_attrib_ffil</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attribute</th>
      <th>Description</th>
      <th>Value</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>-1</td>
      <td>unknown</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>0</td>
      <td>no classification possible</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>1</td>
      <td>passive elderly</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>2</td>
      <td>cultural elderly</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AGER_TYP</td>
      <td>best-ager typology</td>
      <td>3</td>
      <td>experience-driven elderly</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ALTERSKATEGORIE_GROB</td>
      <td>age classification through prename analysis</td>
      <td>-1, 0</td>
      <td>unknown</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ALTERSKATEGORIE_GROB</td>
      <td>age classification through prename analysis</td>
      <td>1</td>
      <td>&lt; 30 years</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Create a dictionary with attributes' names as keys and allowed input (<code>Value</code> column) as values.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># First get the allowed value ranges per attribute from the attributes values file (DIAS Attributes - Values 2017.xlsx)</span>
<span class="c1"># Group by Attribute and get values in a multinex object, then transform to np.ndarray by chaining `values` method:</span>
<span class="n">attrs_values_arr</span> <span class="o">=</span> <span class="n">dfdias_attrib_ffil</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Attribute&quot;</span><span class="p">)[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Create a helper function to parse values in the form &#39;-1, 0&#39;</span>
<span class="k">def</span> <span class="nf">get_nums</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of integers from a string</span>
<span class="sd">    or the same input if not a string&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">li</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">li</span><span class="p">))</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>

<span class="c1"># Create a dictionary mapping attributes as keys and allowed values in a list to key:[values]</span>
<span class="c1"># we are simultaneously injecting np.NaN in values&#39; range as this might already be present</span>
<span class="c1"># among the attributes&#39; values in `azdias`.</span>
<span class="n">attrs_val_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">attrs_values_arr</span><span class="p">:</span>
    <span class="n">attrs_val_dict</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">get_nums</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="nb">list</span><span class="p">(</span><span class="n">attrs_val_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;AGER_TYP&#39;, [nan, -1, 0, 1, 2, 3]),
 (&#39;ALTERSKATEGORIE_GROB&#39;, [nan, 1, 2, 3, 4, 9, -1, 0])]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This dictionary must have its keys (attributes) names match the corresponding attributes names in <code>azdias</code> dataset for the cases where the attributes have differences in names, according to the previously created dictionary mapping <code>xcl_attr_names_new</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will use the `xcl_attr_names_new` to get the corresponding names and create a new dictionary.</span>
<span class="n">attrs_val_pools</span> <span class="o">=</span> <span class="p">{</span><span class="n">xcl_attr_names_new</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">attrs_val_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will create a different dictionary with the special cases with key values equal to <code>'…'</code>. These are some special cases where the input is described as "numeric value" which is attribute context related. So, this can be a year, a number typically coded from 1-10, or 1-3, but with the range not exactly specified. This will allow us to process these cases separately.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create new dict while removing the related items from the previous</span>
<span class="c1"># Iterate through a list of keys </span>
<span class="n">attrs_val_dict_any</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">attrs_val_pools</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">attrs_val_pools</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;…&#39;</span> <span class="ow">in</span> <span class="n">attrs_val_pools</span><span class="p">[</span><span class="n">k</span><span class="p">]}</span>

<span class="n">attrs_val_dict_any</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ANZ_HAUSHALTE_AKTIV&#39;: [nan, &#39;…&#39;],
 &#39;ANZ_HH_TITEL&#39;: [nan, &#39;…&#39;],
 &#39;ANZ_PERSONEN&#39;: [nan, &#39;…&#39;],
 &#39;ANZ_TITEL&#39;: [nan, &#39;…&#39;],
 &#39;GEBURTSJAHR&#39;: [nan, &#39;…&#39;],
 &#39;KBA13_ANZAHL_PKW&#39;: [nan, &#39;…&#39;],
 &#39;MIN_GEBAEUDEJAHR&#39;: [nan, &#39;…&#39;]}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now have two dictionaries mapping attributes to possible values for each attribute. There are some unique attributes (<code>azdias_only_attrs</code>) in <code>azdias</code> dataset that have not been accounted for. For these we will adopt the mapping of similar attributes based on context and add them in the first mapping dictionary. We can identify at least two value categories <code>CJT_*</code> and <code>KBA13_</code> that can be assigned to values' range list <code>[-1, 0, 1, 2, 3, 4, 5]</code> as can be observed from similar attributes in excel attributes values file. We cannot do the same for <code>D19_*</code> attributes or any of the rest attributes in the <code>azdias_only_attrs</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we are then left with an undefined values range list of attributes for unique to `azdias` as:</span>
<span class="n">azdias_only_attrs_undef</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">azdias_only_attrs</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s1">&#39;CJT_&#39;</span><span class="p">,</span> <span class="s1">&#39;KBA13_&#39;</span><span class="p">))]</span>

<span class="n">azdias_only_attrs_undef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">azdias_only_attrs_undef</span><span class="p">)</span>

<span class="n">azdias_only_attrs_undef</span><span class="p">,</span> <span class="n">azdias_only_attrs_undef</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;AKT_DAT_KL&#39;, &#39;ALTERSKATEGORIE_FEIN&#39;, &#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;,
        &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;, &#39;ANZ_KINDER&#39;,
        &#39;ANZ_STATISTISCHE_HAUSHALTE&#39;, &#39;D19_BUCH_CD&#39;, &#39;D19_KONSUMTYP_MAX&#39;,
        &#39;D19_LETZTER_KAUF_BRANCHE&#39;, &#39;D19_SOZIALES&#39;,
        &#39;D19_TELKO_ONLINE_QUOTE_12&#39;, &#39;D19_VERSI_ONLINE_QUOTE_12&#39;,
        &#39;DSL_FLAG&#39;, &#39;EINGEFUEGT_AM&#39;, &#39;EINGEZOGENAM_HH_JAHR&#39;, &#39;EXTSEL992&#39;,
        &#39;FIRMENDICHTE&#39;, &#39;GEMEINDETYP&#39;, &#39;HH_DELTA_FLAG&#39;, &#39;KK_KUNDENTYP&#39;,
        &#39;KOMBIALTER&#39;, &#39;KONSUMZELLE&#39;, &#39;LNR&#39;, &#39;MOBI_RASTER&#39;,
        &#39;RT_KEIN_ANREIZ&#39;, &#39;RT_SCHNAEPPCHEN&#39;, &#39;RT_UEBERGROESSE&#39;,
        &#39;STRUKTURTYP&#39;, &#39;UMFELD_ALT&#39;, &#39;UMFELD_JUNG&#39;, &#39;UNGLEICHENN_FLAG&#39;,
        &#39;VERDICHTUNGSRAUM&#39;, &#39;VHA&#39;, &#39;VHN&#39;, &#39;VK_DHT4A&#39;, &#39;VK_DISTANZ&#39;,
        &#39;VK_ZG11&#39;], dtype=&#39;&lt;U26&#39;), 39)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, for the <code>customers</code> the respective array will be:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cus_only_attrs_undef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">azdias_only_attrs_undef</span><span class="p">,</span>
                                 <span class="p">[</span><span class="s1">&#39;CUSTOMER_GROUP&#39;</span><span class="p">,</span> <span class="s1">&#39;ONLINE_PURCHASE&#39;</span><span class="p">,</span> <span class="s1">&#39;PRODUCT_GROUP&#39;</span><span class="p">])</span>

<span class="n">cus_only_attrs_undef</span><span class="p">,</span> <span class="n">cus_only_attrs_undef</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;AKT_DAT_KL&#39;, &#39;ALTERSKATEGORIE_FEIN&#39;, &#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;,
        &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;, &#39;ANZ_KINDER&#39;,
        &#39;ANZ_STATISTISCHE_HAUSHALTE&#39;, &#39;D19_BUCH_CD&#39;, &#39;D19_KONSUMTYP_MAX&#39;,
        &#39;D19_LETZTER_KAUF_BRANCHE&#39;, &#39;D19_SOZIALES&#39;,
        &#39;D19_TELKO_ONLINE_QUOTE_12&#39;, &#39;D19_VERSI_ONLINE_QUOTE_12&#39;,
        &#39;DSL_FLAG&#39;, &#39;EINGEFUEGT_AM&#39;, &#39;EINGEZOGENAM_HH_JAHR&#39;, &#39;EXTSEL992&#39;,
        &#39;FIRMENDICHTE&#39;, &#39;GEMEINDETYP&#39;, &#39;HH_DELTA_FLAG&#39;, &#39;KK_KUNDENTYP&#39;,
        &#39;KOMBIALTER&#39;, &#39;KONSUMZELLE&#39;, &#39;LNR&#39;, &#39;MOBI_RASTER&#39;,
        &#39;RT_KEIN_ANREIZ&#39;, &#39;RT_SCHNAEPPCHEN&#39;, &#39;RT_UEBERGROESSE&#39;,
        &#39;STRUKTURTYP&#39;, &#39;UMFELD_ALT&#39;, &#39;UMFELD_JUNG&#39;, &#39;UNGLEICHENN_FLAG&#39;,
        &#39;VERDICHTUNGSRAUM&#39;, &#39;VHA&#39;, &#39;VHN&#39;, &#39;VK_DHT4A&#39;, &#39;VK_DISTANZ&#39;,
        &#39;VK_ZG11&#39;, &#39;CUSTOMER_GROUP&#39;, &#39;ONLINE_PURCHASE&#39;, &#39;PRODUCT_GROUP&#39;],
       dtype=&#39;&lt;U26&#39;), 42)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>We now have <code>attrs_val_pools</code> which is a dictionary mapping of known attribute names and 
lists with accepted values per variable.</li>
<li><code>attrs_val_dict_any</code> which is a dictionary with attributes' names that do not have specific values defined but instead accept a wider range of numerical values.</li>
<li><code>azdias_only_attrs_undef</code>, <code>cus_only_attrs_undef</code> which are two arrays with all attributes known in <code>azdias</code> and <code>customers</code> only that do not have associated information about their accepted values.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Replace-unknown-and-specific-values-with-NaNs">Replace unknown and specific values with NaNs<a class="anchor-link" href="#Replace-unknown-and-specific-values-with-NaNs">&#182;</a></h4><p>Using the <code>attrs_val_pools</code> we can check against the values in respective attributes in <code>azdias</code> and <code>customers</code> datasets. If values are found outside the accepted ones, these will be replaced by NaNs. We will use the keys in this dictionary to iterate through the attributes and make changes only in the common attributes (<code>attrs_common</code>) between <code>azdias</code> dataset and excel files.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># for every key (attribute) in the dictionary created earlier</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">attrs_val_pools</span><span class="p">:</span>
    <span class="c1"># if the attribute is among the common ones</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">attrs_common</span><span class="p">:</span>
        <span class="c1"># select all those rows in the column that fall outside the attribute&#39;s</span>
        <span class="c1"># specified values pool and replace them with NaN.</span>
        <span class="n">azdias</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">azdias</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">attrs_val_pools</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
        <span class="n">custrs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">custrs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">attrs_val_pools</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>

<span class="n">azdias</span><span class="p">[</span><span class="s1">&#39;CAMEO_DEUG_2015&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>8.0    45507
9.0    36443
6.0    35479
4.0    35077
3.0    29259
2.0    28097
7.0    25994
5.0    18443
1.0    11960
Name: CAMEO_DEUG_2015, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want to find the attributes where 9 is used for unknown/NaN values, to replace it in <code>azdias</code>, <code>custrs</code> datasets with NaNs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will use the forward filled attribute dataframe to make it easier to extract the attributes&#39; names</span>
<span class="n">attrs_nine_name</span> <span class="o">=</span> <span class="n">dfdias_attrib_ffil</span><span class="p">[</span><span class="n">dfdias_attrib_ffil</span><span class="p">[</span><span class="s2">&quot;Value&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-1, 9&#39;</span><span class="p">][</span><span class="s2">&quot;Attribute&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Create a dict to use as input for the pandas replace method</span>
<span class="n">replace9_nan_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="mi">9</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">attrs_nine_name</span><span class="p">}</span>
<span class="c1"># Add &#39;KOMBIALTER&#39; attribute in the dict that is not in excel files</span>
<span class="n">replace9_nan_dict</span><span class="p">[</span><span class="s1">&#39;KOMBIALTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>

<span class="c1"># We can now use this dictionary of attributes to replace value 9 (unknown) with</span>
<span class="c1"># NaN for specific attributes in the azdias, custrs dataframe</span>
<span class="n">azdias</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replace9_nan_dict</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">custrs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replace9_nan_dict</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Special cases where values' pool was <code>'…'</code>:</p>
<ul>
<li><code>ANZ_HAUSHALTE_AKTIV</code> - number of households in the building numeric value, typically coded from 1-10 but higher values can be accepted (large building blocks)</li>
<li><code>ANZ_HH_TITEL</code> - number of academic title holder in building, numeric value typically coded from 1-10 but higher values can be accepted (large building blocks)</li>
<li><code>ANZ_PERSONEN</code> - number of adult persons in the household, numeric value typically coded from 1-3 but higher values can be accepted depending on the area and family size. This has some extreme values values in the range [23, 45] that may be proven outliers.</li>
<li><code>ANZ_TITEL</code> - number of professional title holders in a household, numeric value typically coded from 1-10 but higher values can be accepted depending on the family size.</li>
<li><code>GEBURTSJAHR</code> - year of birth, with values ranging from 1900 to 2017.</li>
<li><code>KBA13_ANZAHL_PKW</code> - number of cars in the PLZ8, numeric value. This may also have a large range based on the area (postcode) rural, urban areas.</li>
<li><code>MIN_GEBAEUDEJAHR</code> - year the building was first mentioned in the database, numeric values of years ranging from 1985 to 2016.</li>
</ul>
<p>By observation these attributes seem to have acceptable values related to their context.</p>
<p>For the attributes known only to <code>azdias</code> dataset that cannot be related to existing information from the excel files there is a number of attributes that appear to be related to one another - <code>'ALTERSKATEGORIE_FEIN', 'ALTER_KIND1', 'ALTER_KIND2', 'ALTER_KIND3', 'ALTER_KIND4'</code> - and by context might provide categorization for number of children for age group bins. From <code>ALTERSKATEGORIE_FEIN</code> we can understand that there are 25 bins that correspond to an age range. <code>ANZ_KINDER</code> provides the number of children, while <code>''ALTER_KIND1', 'ALTER_KIND2', 'ALTER_KIND3', 'ALTER_KIND4'</code>, must provide the ages for the 1st, 2nd, 3rd and 4th child. <code>ANZ_STATISTISCHE_HAUSHALTE</code> seems to provide some budget categorization in a range 1 - 449 with a mean 7.6.</p>
<p><code>'D19_BUCH_CD'</code> is probably related to books and or CDs ownership, <code>'D19_KONSUMTYP_MAX'</code> is a categorization of consumer type,<code>'D19_LETZTER_KAUF_BRANCHE'</code> provides a categorization based on recent products purchases, <code>'D19_SOZIALES'</code> probably provides a social type related categorization, <code>'D19_TELKO_ONLINE_QUOTE_12'</code> (few records) is telecoms related probably for the last 12 months average spending, <code>'D19_VERSI_ONLINE_QUOTE_12'</code> (few records) is another 12 months spending record, <code>'DSL_FLAG'</code> is probably internet line capacity related (DSL line) indicating if person has DSL (value 1), <code>'EINGEFUEGT_AM'</code> is probably the date and time the database entry for this entry was inserted (all times are set to 00:00:00), <code>'EINGEZOGENAM HH JAHR'</code> is possibly the year someone moved to a household, <code>'EXTSEL992'</code> is some kind of age related attribute, <code>'FIRMENDICHTE'</code> is a company size categorization probably related to the company each person works for, <code>'GEMEINDETYP'</code> is a community type categorization, <code>'HH_DELTA_FLAG'</code> cannot be associated with something known, <code>'KK_KUNDENTYP'</code> is a customer type categorization, <code>'KOMBIALTER'</code> is another age related categorization, <code>'KONSUMZELLE'</code> is another flag probably indicating somekind of consumer feature, <code>'MOBI_RASTER'</code> should be an attribute related to mobiles (or mobility) range 1-6, <code>'RT_KEIN_ANREIZ'</code> refers lack of incentives on something with values range 1-5, <code>'RT_SCHNAEPPCHEN'</code> describes bargain response on something with values range 1-5, <code>'RT_UEBERGROESSE'</code> describes over-size response on something with values range 1-5, <code>'SOHO_KZ'</code> could be related to small office / home office binary attribute, <code>'STRUKTURTYP'</code> provides structure type for homes (?) with values range 1-3, <code>'UMFELD_ALT'</code> records old relatives(?) with values range 1-5, <code>'UMFELD_JUNG'</code> records young relatives with values range 1-5, <code>'UNGLEICHENN_FLAG'</code> binary attribute recording unequality, <code>'VERDICHTUNGSRAUM'</code> probably describes the density of the living area (neibourhood, block?) values 1-45, <code>'VHA', 'VHN', 'VK_DHT4A', 'VK_DISTANZ','VK_ZG11'</code> cannot be identified.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Based on the above these are additional categoricals:</span>
<span class="n">extra_cat_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;ALTERSKATEGORIE_FEIN&#39;</span><span class="p">,</span> <span class="s1">&#39;D19_BUCH_CD&#39;</span><span class="p">,</span> <span class="s1">&#39;D19_KONSUMTYP_MAX&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;D19_SOZIALES&#39;</span><span class="p">,</span> <span class="s1">&#39;D19_TELKO_ONLINE_QUOTE_12&#39;</span><span class="p">,</span> <span class="s1">&#39;D19_VERSI_ONLINE_QUOTE_12&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;FIRMENDICHTE&#39;</span><span class="p">,</span> <span class="s1">&#39;GEMEINDETYP&#39;</span><span class="p">,</span> <span class="s1">&#39;KK_KUNDENTYP&#39;</span><span class="p">,</span> <span class="s1">&#39;KOMBIALTER&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;MOBI_RASTER&#39;</span><span class="p">,</span> <span class="s1">&#39;RT_KEIN_ANREIZ&#39;</span><span class="p">,</span> <span class="s1">&#39;RT_SCHNAEPPCHEN&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;RT_UEBERGROESSE&#39;</span><span class="p">,</span> <span class="s1">&#39;STRUKTURTYP&#39;</span><span class="p">,</span> <span class="s1">&#39;UMFELD_ALT&#39;</span><span class="p">,</span> <span class="s1">&#39;UMFELD_JUNG&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;KONSUMZELLE&#39;</span><span class="p">,</span> <span class="s1">&#39;SOHO_KZ&#39;</span><span class="p">,</span> <span class="s1">&#39;UNGLEICHENN_FLAG&#39;</span><span class="p">,</span> <span class="s1">&#39;VHA&#39;</span><span class="p">,</span> <span class="s1">&#39;VHN&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;VK_DHT4A&#39;</span><span class="p">,</span> <span class="s1">&#39;VK_DISTANZ&#39;</span><span class="p">,</span> <span class="s1">&#39;VK_ZG11&#39;</span><span class="p">])</span>
<span class="c1"># (&#39;KOMBIALTER&#39; needs to remove 9 as NaN)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All known categorical (includes all ordinal) attributes <code>cat_attrs</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">attrs_common</span><span class="p">,</span> <span class="n">extra_cat_cols</span><span class="p">)</span>

<span class="n">cat_attrs</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>336</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Analysing-and-understanding-missing-values-in-azdias-and-custrs-dfs">Analysing and understanding missing values in <code>azdias</code> and <code>custrs</code> dfs<a class="anchor-link" href="#Analysing-and-understanding-missing-values-in-azdias-and-custrs-dfs">&#182;</a></h2><ul>
<li>Total NaNs:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># count NaNs in the dataframes</span>
<span class="n">azdias_nan</span> <span class="o">=</span> <span class="n">azdias</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">cus_df_nan</span> <span class="o">=</span> <span class="n">custrs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="p">(</span><span class="n">azdias</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">azdias_nan</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">azdias_nan</span><span class="o">/</span><span class="n">azdias</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> \
<span class="p">(</span><span class="n">custrs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">cus_df_nan</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">cus_df_nan</span><span class="o">/</span><span class="n">custrs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((109800000, 30782105, 0.28), (55350000, 19690956, 0.36))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are about 28% NaNs in <code>azdias</code> df and about 35-36% NaNs in the <code>customers</code> 
dataset out of the total data sizes.</p>
<ul>
<li>NaNs per column:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cols_nans_info</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a new dataframe with NaNs summary per column of the input df</span>

<span class="sd">    Creates and returns a new dataframe with three columns that correspond to</span>
<span class="sd">    the attributes (columns) of the initial dataframe, the NaN counts per column</span>
<span class="sd">    and portion of NaNs per column.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input dataframe to process.</span>
<span class="sd">        cols (tuple): 3 elements tuple with the names of the three columns in the</span>
<span class="sd">        output dataframe. If left None the three default names (&#39;Columns&#39;,</span>
<span class="sd">        &#39;NaNcounts&#39;, &#39;NaNportions&#39;) will be used.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        A new dataframe with three columns providing counts and portions of NaNs</span>
<span class="sd">        per column in the input df. Example:</span>

<span class="sd">            Columns	     NaNcounts	NaNportions</span>
<span class="sd">        0	AGER_TYP	   685843	    0.769554</span>
<span class="sd">        1	AKT_DAT_KL     73499	    0.082470</span>
<span class="sd">        2	ALTER_HH	   310267	    0.348137</span>
<span class="sd">        3	ALTER_KIND1	   810163	    0.909048</span>
<span class="sd">        4	ALTER_KIND2	   861722	    0.966900</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Columns&#39;</span><span class="p">,</span> <span class="s1">&#39;NaNcounts&#39;</span><span class="p">,</span> <span class="s1">&#39;NaNportions&#39;</span><span class="p">)</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average NaNs per column: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max NaNs per column: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Min NaNs per column: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">new_df</span>

<span class="c1"># Get NaNs info for the `azdias` dataframe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AZDIAS&quot;</span><span class="p">)</span>
<span class="n">azdias_nans</span> <span class="o">=</span> <span class="n">cols_nans_info</span><span class="p">(</span><span class="n">azdias</span><span class="p">)</span>
<span class="c1"># Get NaNs info for the `custrs` dataframe</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CUSTOMERS&quot;</span><span class="p">)</span>
<span class="n">cus_df_nans</span> <span class="o">=</span> <span class="n">cols_nans_info</span><span class="p">(</span><span class="n">custrs</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">azdias_nans</span><span class="p">,</span> <span class="n">cus_df_nans</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Columns&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_azd&quot;</span><span class="p">,</span> <span class="s2">&quot;_cus&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>AZDIAS
Average NaNs per column:  0.2803
Max NaNs per column:  0.9991
Min NaNs per column:  0.0
CUSTOMERS
Average NaNs per column:  0.3558
Max NaNs per column:  0.999
Min NaNs per column:  0.0
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Columns</th>
      <th>NaNcounts_azd</th>
      <th>NaNportions_azd</th>
      <th>NaNcounts_cus</th>
      <th>NaNportions_cus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LNR</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGER_TYP</td>
      <td>230705</td>
      <td>0.769017</td>
      <td>75850</td>
      <td>0.505667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AKT_DAT_KL</td>
      <td>24857</td>
      <td>0.082857</td>
      <td>36528</td>
      <td>0.243520</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALTER_HH</td>
      <td>104758</td>
      <td>0.349193</td>
      <td>53876</td>
      <td>0.359173</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ALTER_KIND1</td>
      <td>272842</td>
      <td>0.909473</td>
      <td>140828</td>
      <td>0.938853</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>361</th>
      <td>WOHNDAUER_2008</td>
      <td>24857</td>
      <td>0.082857</td>
      <td>36528</td>
      <td>0.243520</td>
    </tr>
    <tr>
      <th>362</th>
      <td>WOHNLAGE</td>
      <td>33900</td>
      <td>0.113000</td>
      <td>39977</td>
      <td>0.266513</td>
    </tr>
    <tr>
      <th>363</th>
      <td>ZABEOTYP</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>364</th>
      <td>ANREDE_KZ</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>365</th>
      <td>ALTERSKATEGORIE_GROB</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>366 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A first look at the output indicates that there are attributes with a lot of NaNs and even some full of NaNs. Let us visualize these results to get a better picture of the data. We will create a histogram dividing the percentage of NaNs in 10 bins counting corresponding attributes in each bin.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">nan_col_distrb_file</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/workspace/arvato_data/nan_col_distrb_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> \
<span class="k">if</span> <span class="n">IN_COLAB</span> <span class="k">else</span> <span class="s1">&#39;nan_col_distrb_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">azdias_nans</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS] Column counts per NaN portions&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">cus_df_nans</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[CUSTOMERS] Column counts per NaN portions&#39;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nan_col_distrb_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that both datasets have similar distributions of NaNs. The first plot for <code>azdias</code> shows that there are about 50+ attributes with NaNs above 80%. Around 280 attributes have less than 30% NaNs while the rest are between 30% - 80% NaNs. The second for <code>customers</code> shows that there are around 235 attributes with less than 30% NaNs and around 50 with more than 80% NaNs.</p>
<ul>
<li><code>AZDIAS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azd_col_nan_bins</span> <span class="o">=</span> <span class="n">azdias_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">azd_col_nan_bins</span> <span class="o">=</span> <span class="n">azd_col_nan_bins</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Bins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>

<span class="n">azd_col_nan_bins</span><span class="p">[</span><span class="s2">&quot;ColPortion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">azd_col_nan_bins</span><span class="o">.</span><span class="n">Count</span> <span class="o">/</span> <span class="n">azdias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">azd_col_nan_bins</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>Count</th>
      <th>ColPortion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>67</td>
      <td>0.183060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>169</td>
      <td>0.461749</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>40</td>
      <td>0.109290</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>4</td>
      <td>0.010929</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>10</td>
      <td>0.027322</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(0.5, 0.6]</td>
      <td>7</td>
      <td>0.019126</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(0.6, 0.7]</td>
      <td>6</td>
      <td>0.016393</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(0.7, 0.8]</td>
      <td>10</td>
      <td>0.027322</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(0.8, 0.9]</td>
      <td>21</td>
      <td>0.057377</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(0.9, 1.0]</td>
      <td>32</td>
      <td>0.087432</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azd_col_nan_bins</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Count         276.000000
ColPortion      0.754098
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>CUSTOMERS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cus_col_nan_bins</span> <span class="o">=</span> <span class="n">cus_df_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">cus_col_nan_bins</span> <span class="o">=</span> <span class="n">cus_col_nan_bins</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Bins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>

<span class="n">cus_col_nan_bins</span><span class="p">[</span><span class="s2">&quot;ColPortion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cus_col_nan_bins</span><span class="o">.</span><span class="n">Count</span> <span class="o">/</span> <span class="n">custrs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">cus_col_nan_bins</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>Count</th>
      <th>ColPortion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>59</td>
      <td>0.159892</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>176</td>
      <td>0.476965</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>40</td>
      <td>0.108401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>20</td>
      <td>0.054201</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(0.5, 0.6]</td>
      <td>10</td>
      <td>0.027100</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(0.6, 0.7]</td>
      <td>8</td>
      <td>0.021680</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(0.7, 0.8]</td>
      <td>9</td>
      <td>0.024390</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(0.8, 0.9]</td>
      <td>18</td>
      <td>0.048780</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(0.9, 1.0]</td>
      <td>29</td>
      <td>0.078591</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cus_col_nan_bins</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Count         235.000000
ColPortion      0.636856
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Format-data-for-plotting">Format data for plotting<a class="anchor-link" href="#Format-data-for-plotting">&#182;</a></h4><p>We need to convert the dataframe to <a href="http://seaborn.pydata.org/tutorial/data_structure.html#long-form-vs-wide-form-data">long-form</a> to use the <code>hue</code> argument in <code>sns.barplot</code> to plot the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merge_col_nan_bins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">azd_col_nan_bins</span><span class="p">,</span> <span class="n">cus_col_nan_bins</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_azd&quot;</span><span class="p">,</span> <span class="s2">&quot;_cus&quot;</span><span class="p">))</span>

<span class="n">merge_col_nan_bins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>Count_azd</th>
      <th>ColPortion_azd</th>
      <th>Count_cus</th>
      <th>ColPortion_cus</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>67</td>
      <td>0.183060</td>
      <td>59</td>
      <td>0.159892</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>169</td>
      <td>0.461749</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>40</td>
      <td>0.109290</td>
      <td>176</td>
      <td>0.476965</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>4</td>
      <td>0.010929</td>
      <td>40</td>
      <td>0.108401</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>10</td>
      <td>0.027322</td>
      <td>20</td>
      <td>0.054201</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_nan_portns_melt</span> <span class="o">=</span> <span class="n">merge_col_nan_bins</span><span class="p">[</span>
                                          <span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="s1">&#39;ColPortion_azd&#39;</span><span class="p">,</span> <span class="s1">&#39;ColPortion_cus&#39;</span><span class="p">]</span>
                                         <span class="p">]</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">))</span>
<span class="n">cols_nan_portns_melt</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>ColPortion_azd</td>
      <td>0.183060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>ColPortion_azd</td>
      <td>0.461749</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>ColPortion_azd</td>
      <td>0.109290</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>ColPortion_azd</td>
      <td>0.010929</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>ColPortion_azd</td>
      <td>0.027322</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">nan_col_perc_file</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/workspace/arvato_data/nan_col_perc_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> \
<span class="k">if</span> <span class="n">IN_COLAB</span> <span class="k">else</span> <span class="s1">&#39;nan_col_perc_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cols_nan_portns_melt</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Bins&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Blues_d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS, CUSTOMERS] Columns portions per NaN bin&#39;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nan_col_perc_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Rows-NaNs-analysis">Rows NaNs analysis<a class="anchor-link" href="#Rows-NaNs-analysis">&#182;</a></h3><ul>
<li>Identify missing values per row as percentage (portions).</li>
<li>Drop rows with all NaNs (zero rows will be dropped):</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rows_nans_info</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a new dataframe with NaNs summary per row of the input df</span>

<span class="sd">    Creates and returns a new dataframe with three columns that correspond to</span>
<span class="sd">    the rows of the input dataframe, the NaN counts per row</span>
<span class="sd">    and portion of NaNs per row.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The input dataframe to process.</span>
<span class="sd">        cols (tuple): 3 elements tuple with the names of the three columns in the</span>
<span class="sd">        output dataframe. If left None the three default names (&#39;Rows&#39;,</span>
<span class="sd">        &#39;NaNcounts&#39;, &#39;NaNportions&#39;) will be used.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        A new dataframe with three columns providing counts and portions of NaNs</span>
<span class="sd">        per row in the input df. Example:</span>

<span class="sd">            Rows    NaNcounts	NaNportions</span>
<span class="sd">        0	0	    685843	    0.769554</span>
<span class="sd">        1	1       73499	    0.082470</span>
<span class="sd">        2	2	    310267	    0.348137</span>
<span class="sd">        3	3	    810163	    0.909048</span>
<span class="sd">        4	4       861722	    0.966900</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;Rows&#39;</span><span class="p">,</span> <span class="s1">&#39;NaNcounts&#39;</span><span class="p">,</span> <span class="s1">&#39;NaNportions&#39;</span><span class="p">)</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average NaNs per row: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max NaNs per row: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min NaNs per row: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">new_df</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">new_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>AZDIAS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias_row_nans</span> <span class="o">=</span> <span class="n">rows_nans_info</span><span class="p">(</span><span class="n">azdias</span><span class="p">)</span>

<span class="n">azdias_row_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Average NaNs per row:  0.2803
Max NaNs per row:  0.8579
Min NaNs per row:  0.071
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    300000.000000
mean          0.280347
std           0.198368
min           0.071038
25%           0.183060
50%           0.213115
75%           0.243169
max           0.857923
Name: NaNportions, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>CUSTOMERS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custrs_row_nans</span> <span class="o">=</span> <span class="n">rows_nans_info</span><span class="p">(</span><span class="n">custrs</span><span class="p">)</span>

<span class="n">custrs_row_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Average NaNs per row:  0.3558
Max NaNs per row:  0.8537
Min NaNs per row:  0.0759
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    150000.000000
mean          0.355753
std           0.287805
min           0.075881
25%           0.165312
50%           0.195122
75%           0.747967
max           0.853659
Name: NaNportions, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is on average a 28% missing values per row in <code>AZDIAS</code> and around 35% NaNs per row in <code>CUSTOMERS</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">nan_rows_distrb_file</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/workspace/arvato_data/nan_rows_distrb_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> \
<span class="k">if</span> <span class="n">IN_COLAB</span> <span class="k">else</span> <span class="s1">&#39;nan_rows_distrb_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">azdias_row_nans</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS] Row counts per NaN portions&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">custrs_row_nans</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[CUSTOMERS] Row counts per NaN portions&#39;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nan_rows_distrb_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As seen, both datasets have most rows with missing values in the range 10% - 30% per row.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>AZDIAS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azd_row_nan_bins</span> <span class="o">=</span> <span class="n">azdias_row_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">azd_row_nan_bins</span> <span class="o">=</span> <span class="n">azd_row_nan_bins</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Bins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>

<span class="n">azd_row_nan_bins</span><span class="p">[</span><span class="s2">&quot;RowPortion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">azd_row_nan_bins</span><span class="o">.</span><span class="n">Count</span> <span class="o">/</span> <span class="n">azdias</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">azd_row_nan_bins</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>Count</th>
      <th>RowPortion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>243</td>
      <td>0.000810</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>116662</td>
      <td>0.388873</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>131302</td>
      <td>0.437673</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>15065</td>
      <td>0.050217</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>1140</td>
      <td>0.003800</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(0.5, 0.6]</td>
      <td>1695</td>
      <td>0.005650</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(0.6, 0.7]</td>
      <td>1949</td>
      <td>0.006497</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(0.7, 0.8]</td>
      <td>6741</td>
      <td>0.022470</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(0.8, 0.9]</td>
      <td>25203</td>
      <td>0.084010</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(0.9, 1.0]</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 20% NaN counts and dataset portion - AZDIAS</span>
<span class="n">azd_row_nan_bins</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Count         248207.000000
RowPortion         0.827357
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>CUSTOMERS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cus_row_nan_bins</span> <span class="o">=</span> <span class="n">custrs_row_nans</span><span class="o">.</span><span class="n">NaNportions</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">cus_row_nan_bins</span> <span class="o">=</span> <span class="n">cus_row_nan_bins</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Bins&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>

<span class="n">cus_row_nan_bins</span><span class="p">[</span><span class="s2">&quot;RowPortion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cus_row_nan_bins</span><span class="o">.</span><span class="n">Count</span> <span class="o">/</span> <span class="n">custrs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">cus_row_nan_bins</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>Count</th>
      <th>RowPortion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>250</td>
      <td>0.001667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>80654</td>
      <td>0.537693</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>24487</td>
      <td>0.163247</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>4342</td>
      <td>0.028947</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>234</td>
      <td>0.001560</td>
    </tr>
    <tr>
      <th>5</th>
      <td>(0.5, 0.6]</td>
      <td>260</td>
      <td>0.001733</td>
    </tr>
    <tr>
      <th>6</th>
      <td>(0.6, 0.7]</td>
      <td>833</td>
      <td>0.005553</td>
    </tr>
    <tr>
      <th>7</th>
      <td>(0.7, 0.8]</td>
      <td>2376</td>
      <td>0.015840</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(0.8, 0.9]</td>
      <td>36564</td>
      <td>0.243760</td>
    </tr>
    <tr>
      <th>9</th>
      <td>(0.9, 1.0]</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 20% NaN counts and dataset portion - CUSTOMERS</span>
<span class="n">cus_row_nan_bins</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Count         105391.000000
RowPortion         0.702607
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Format-data-in-long-form-for-plotting-with-sns.barplot.">Format data in long-form for plotting with <code>sns.barplot</code>.<a class="anchor-link" href="#Format-data-in-long-form-for-plotting-with-sns.barplot.">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merge_row_nan_bins</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">azd_row_nan_bins</span><span class="p">,</span> <span class="n">cus_row_nan_bins</span><span class="p">,</span>
                              <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_azd&quot;</span><span class="p">,</span> <span class="s2">&quot;_cus&quot;</span><span class="p">))</span>

<span class="n">rows_nan_portns_melt</span> <span class="o">=</span> <span class="n">merge_row_nan_bins</span><span class="p">[</span>
                                          <span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">,</span> <span class="s1">&#39;RowPortion_azd&#39;</span><span class="p">,</span> <span class="s1">&#39;RowPortion_cus&#39;</span><span class="p">]</span>
                                         <span class="p">]</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">))</span>

<span class="n">rows_nan_portns_melt</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bins</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(-0.001, 0.1]</td>
      <td>RowPortion_azd</td>
      <td>0.000810</td>
    </tr>
    <tr>
      <th>1</th>
      <td>(0.1, 0.2]</td>
      <td>RowPortion_azd</td>
      <td>0.388873</td>
    </tr>
    <tr>
      <th>2</th>
      <td>(0.2, 0.3]</td>
      <td>RowPortion_azd</td>
      <td>0.437673</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(0.3, 0.4]</td>
      <td>RowPortion_azd</td>
      <td>0.050217</td>
    </tr>
    <tr>
      <th>4</th>
      <td>(0.4, 0.5]</td>
      <td>RowPortion_azd</td>
      <td>0.003800</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">nan_rows_perc_file</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/workspace/arvato_data/nan_rows_perc_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> \
<span class="k">if</span> <span class="n">IN_COLAB</span> <span class="k">else</span> <span class="s1">&#39;nan_rows_perc_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">rows_nan_portns_melt</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Bins&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Blues_d&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS, CUSTOMERS] Rows portions per NaN bin&#39;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nan_rows_perc_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In both datasets most rows have NaNs in the range 10% - 30%.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Column-type-and-exploration-for-the-attributes-with-values-range-'&#8230;'">Column type and exploration for the attributes with values range <code>'&#8230;'</code><a class="anchor-link" href="#Column-type-and-exploration-for-the-attributes-with-values-range-'&#8230;'">&#182;</a></h4><p>Finally we have the special cases where the values' pool was <code>'…'</code>, described with the <code>attrs_val_dict_any</code> dictionary mapping. These include a wide range of numerical values:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>AZDIAS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Check `attrs_val_dict_any` special cases types:</span>
<span class="n">azdias</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV    float64
ANZ_HH_TITEL           float64
ANZ_PERSONEN           float64
ANZ_TITEL              float64
GEBURTSJAHR            float64
KBA13_ANZAHL_PKW       float64
MIN_GEBAEUDEJAHR       float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azdias</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ANZ_HAUSHALTE_AKTIV</th>
      <th>ANZ_HH_TITEL</th>
      <th>ANZ_PERSONEN</th>
      <th>ANZ_TITEL</th>
      <th>GEBURTSJAHR</th>
      <th>KBA13_ANZAHL_PKW</th>
      <th>MIN_GEBAEUDEJAHR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>266258.000000</td>
      <td>8166.000000</td>
      <td>263595.000000</td>
      <td>1077.000000</td>
      <td>167731.000000</td>
      <td>264109.000000</td>
      <td>268489.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>8.395676</td>
      <td>1.371296</td>
      <td>1.800823</td>
      <td>1.073352</td>
      <td>1967.093161</td>
      <td>618.351438</td>
      <td>1993.292340</td>
    </tr>
    <tr>
      <th>std</th>
      <td>15.846538</td>
      <td>1.456124</td>
      <td>1.117183</td>
      <td>0.274717</td>
      <td>17.848186</td>
      <td>339.685636</td>
      <td>3.358749</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1900.000000</td>
      <td>1.000000</td>
      <td>1985.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1955.000000</td>
      <td>382.000000</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1967.000000</td>
      <td>548.000000</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1981.000000</td>
      <td>776.000000</td>
      <td>1993.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>595.000000</td>
      <td>23.000000</td>
      <td>40.000000</td>
      <td>4.000000</td>
      <td>2017.000000</td>
      <td>2300.000000</td>
      <td>2016.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may observe that values for the above attributes look acceptable.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Count unique values per attribute (column)</span>
<span class="n">azdias</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV     269
ANZ_HH_TITEL             20
ANZ_PERSONEN             19
ANZ_TITEL                 4
GEBURTSJAHR             115
KBA13_ANZAHL_PKW       1260
MIN_GEBAEUDEJAHR         32
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Discrete unique values per column</span>
<span class="n">azdias</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV    [1.0, 4.0, 10.0, 8.0, 2.0, 9.0, 80.0, 11.0, na...
ANZ_HH_TITEL           [nan, 1.0, 3.0, 2.0, 7.0, 8.0, 10.0, 4.0, 13.0...
ANZ_PERSONEN           [3.0, 4.0, 2.0, 1.0, nan, 9.0, 5.0, 6.0, 7.0, ...
ANZ_TITEL                                      [nan, 1.0, 2.0, 3.0, 4.0]
GEBURTSJAHR            [nan, 1946.0, 1988.0, 2005.0, 1985.0, 1961.0, ...
KBA13_ANZAHL_PKW       [539.0, 578.0, 1179.0, 563.0, 507.0, 330.0, 38...
MIN_GEBAEUDEJAHR       [1994.0, 1992.0, 1993.0, 1995.0, nan, 1996.0, ...
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>CUSTOMERS</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Check `attrs_val_dict_any` special cases types:</span>
<span class="n">custrs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV    float64
ANZ_HH_TITEL           float64
ANZ_PERSONEN           float64
ANZ_TITEL              float64
GEBURTSJAHR            float64
KBA13_ANZAHL_PKW       float64
MIN_GEBAEUDEJAHR       float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">custrs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ANZ_HAUSHALTE_AKTIV</th>
      <th>ANZ_HH_TITEL</th>
      <th>ANZ_PERSONEN</th>
      <th>ANZ_TITEL</th>
      <th>GEBURTSJAHR</th>
      <th>KBA13_ANZAHL_PKW</th>
      <th>MIN_GEBAEUDEJAHR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>108992.000000</td>
      <td>4779.000000</td>
      <td>107914.000000</td>
      <td>2170.000000</td>
      <td>76998.000000</td>
      <td>109830.000000</td>
      <td>110885.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.030690</td>
      <td>1.528144</td>
      <td>2.387429</td>
      <td>1.076498</td>
      <td>1949.740500</td>
      <td>666.902841</td>
      <td>1993.052126</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.246347</td>
      <td>2.065431</td>
      <td>1.324896</td>
      <td>0.284291</td>
      <td>14.909137</td>
      <td>340.248578</td>
      <td>3.062568</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1900.000000</td>
      <td>5.000000</td>
      <td>1985.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1939.000000</td>
      <td>430.000000</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1948.000000</td>
      <td>593.000000</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>1960.000000</td>
      <td>828.000000</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>395.000000</td>
      <td>23.000000</td>
      <td>21.000000</td>
      <td>5.000000</td>
      <td>2017.000000</td>
      <td>2300.000000</td>
      <td>2016.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Count unique values per attribute (column)</span>
<span class="n">custrs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV     209
ANZ_HH_TITEL             19
ANZ_PERSONEN             16
ANZ_TITEL                 4
GEBURTSJAHR             112
KBA13_ANZAHL_PKW       1246
MIN_GEBAEUDEJAHR         32
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Discrete unique values per column</span>
<span class="n">custrs</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">attrs_val_dict_any</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>ANZ_HAUSHALTE_AKTIV    [1.0, nan, 27.0, 7.0, 74.0, 2.0, 9.0, 29.0, 14...
ANZ_HH_TITEL           [nan, 2.0, 1.0, 13.0, 5.0, 4.0, 20.0, 17.0, 9....
ANZ_PERSONEN           [2.0, 3.0, nan, 4.0, 1.0, 5.0, 7.0, 6.0, 8.0, ...
ANZ_TITEL                                      [nan, 1.0, 2.0, 3.0, 5.0]
GEBURTSJAHR            [nan, 1979.0, 1960.0, 1942.0, 1971.0, 1914.0, ...
KBA13_ANZAHL_PKW       [1201.0, nan, 428.0, 513.0, 1300.0, 422.0, 110...
MIN_GEBAEUDEJAHR       [1992.0, nan, 1994.0, 1997.0, 1995.0, 1996.0, ...
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Identifying-(if-any)-columns-to-drop">Identifying (if any) columns to drop<a class="anchor-link" href="#Identifying-(if-any)-columns-to-drop">&#182;</a></h2><p>At this point we will proceed concatenating the two samples in a single dataframe, creating a new feature <code>TARGET</code> that will be <code>1</code> for customers and <code>-1</code> for unknown.</p>
<p>This will combine attribute characteristics from both datasets and help us make decisions best on both samples.</p>
<p>First let us check if there are any common user IDs in LNR columns:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">azdias</span><span class="o">.</span><span class="n">LNR</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">custrs</span><span class="o">.</span><span class="n">LNR</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Concatenate the dataframes:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a new dataframe from `azdias` and `customers` dataframes creating a `target` attribute:</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">azdias</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">TARGET</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                      <span class="n">custrs</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CUSTOMER_GROUP&quot;</span><span class="p">,</span> <span class="s2">&quot;ONLINE_PURCHASE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRODUCT_GROUP&quot;</span><span class="p">])</span>
                      <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">TARGET</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span>

<span class="c1"># Shuffle dataframe</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Keep &quot;LNR&quot; IDs</span>
<span class="n">clientIDs</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;LNR&quot;</span><span class="p">]</span>

<span class="c1"># Remove &quot;LNR&quot; and &quot;EINGEFUEGT_AM&quot; columns which are client IDs and entry datetimes</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LNR&quot;</span><span class="p">,</span> <span class="s2">&quot;EINGEFUEGT_AM&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 365)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>float64     357
int64         5
category      1
category      1
category      1
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Convert float columns to int.</span>
<span class="n">df_train_int_cols</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df_train_int_cols</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_int_cols</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>int64       362
category      1
category      1
category      1
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="One-hot-encoding">One-hot encoding<a class="anchor-link" href="#One-hot-encoding">&#182;</a></h3><p>One-hot encode categorical attributes <code>CAMEO_DEU_2015, D19_LETZTER_KAUF_BRANCHE, OST_WEST_KZ</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CAMEO_DEU_2015</th>
      <th>D19_LETZTER_KAUF_BRANCHE</th>
      <th>OST_WEST_KZ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6F</td>
      <td>D19_VERSICHERUNGEN</td>
      <td>W</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5F</td>
      <td>NaN</td>
      <td>O</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4B</td>
      <td>D19_SONSTIGE</td>
      <td>W</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1D</td>
      <td>D19_UNBEKANNT</td>
      <td>W</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 443)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>irrelevant features, highly correlated features, and missing values can prevent the model from learning and decrease generalization performance on the testing data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-selection-to-keep-only-the-most-useful-attributes">Feature selection to keep only the most useful attributes<a class="anchor-link" href="#Feature-selection-to-keep-only-the-most-useful-attributes">&#182;</a></h2><ul>
<li>Start with <strong>collinear</strong> attributes
(Ref: <a href="https://chrisalbon.com/code/machine_learning/feature_selection/drop_highly_correlated_features/">https://chrisalbon.com/code/machine_learning/feature_selection/drop_highly_correlated_features/</a>)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calculate correlation on a stratified sample of the data, since <code>azdias</code> dataframe is large enough that notebook runs out of memory while calculating the correlation matrix.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_stratified_samples</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fracs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])):</span>
    <span class="sd">&quot;&quot;&quot;Split an input df into two stratified subsets of sizes indicated</span>
<span class="sd">    by the fracs array.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># shuffle input df</span>
    <span class="n">df_</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
    <span class="c1"># split into 2 parts, return df_smpl_a, df_smpl_b</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">df_</span><span class="p">,</span> <span class="p">(</span><span class="n">fracs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

<span class="c1"># azd_cp_smpl_a, azd_cp_smpl_b = get_stratified_samples(azd_cp)</span>

<span class="c1"># azd_cp_smpl_a.shape, azd_cp_smpl_b.shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">drop_collinear_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.95</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ιdentifies the highly correlated variables based on the absolute</span>
<span class="sd">    magnitude of the Pearson correlation coefficient being greater than threshold (0.9)</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.Dataframe): Input dataframe to work on</span>
<span class="sd">        threshold (float): threshold value above which the columns will be selected</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        np.array of selected columns based on the threshold value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate absolute value correlation matrix from the input df.</span>
    <span class="c1"># corr_mat = df.corr().abs()</span>
    <span class="n">corr_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="c1"># Convert to dataframe</span>
    <span class="n">corr_mat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">corr_mat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1"># Select upper triangle of correlation matrix</span>
    <span class="n">upr</span> <span class="o">=</span> <span class="n">corr_mat</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">corr_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">))</span>
    <span class="c1"># Find index of attribute columns with correlation greater than `threshold`</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">upr</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upr</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find attribute columns with correlation greater than 0.95</span>
<span class="n">to_drop</span> <span class="o">=</span> <span class="n">drop_collinear_cols</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>

<span class="n">to_drop</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_drop</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ANZ_STATISTISCHE_HAUSHALTE&#39;, &#39;CAMEO_INTL_2015&#39;, &#39;KBA05_KRSHERST2&#39;,
        &#39;KBA05_KRSHERST3&#39;, &#39;KBA05_SEG2&#39;, &#39;KBA13_HALTER_30&#39;,
        &#39;KBA13_HALTER_40&#39;, &#39;KBA13_HALTER_55&#39;, &#39;KBA13_HALTER_66&#39;,
        &#39;KBA13_HERST_SONST&#39;, &#39;KBA13_KMH_250&#39;, &#39;KBA13_MERCEDES&#39;,
        &#39;KBA13_SEG_VAN&#39;, &#39;KBA13_VW&#39;, &#39;LP_FAMILIE_GROB&#39;,
        &#39;LP_LEBENSPHASE_GROB&#39;, &#39;LP_STATUS_GROB&#39;, &#39;PLZ8_BAUMAX&#39;, &#39;PLZ8_GBZ&#39;,
        &#39;PLZ8_HHZ&#39;], dtype=&#39;&lt;U26&#39;), 20)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 423)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Search-for-more-columns-with-high-NaN-ratio,-check-their-significance.">Search for more columns with high NaN ratio, check their significance.<a class="anchor-link" href="#Search-for-more-columns-with-high-NaN-ratio,-check-their-significance.">&#182;</a></h3><p>References:</p>
<ul>
<li><a href="https://www.kaggle.com/questions-and-answers/131935">https://www.kaggle.com/questions-and-answers/131935</a></li>
<li><a href="https://stats.stackexchange.com/questions/221332/variance-of-a-distribution-of-multi-level-categorical-data">https://stats.stackexchange.com/questions/221332/variance-of-a-distribution-of-multi-level-categorical-data</a></li>
</ul>
<p>Check attributes with NaN ratio more than <strong>0.8</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train_nans</span> <span class="o">=</span> <span class="n">cols_nans_info</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">))</span>

<span class="n">df_train_nans</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Average NaNs per column:  0.256
Max NaNs per column:  0.9991
Min NaNs per column:  0.0
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Columns</th>
      <th>NaNcounts</th>
      <th>NaNportions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AGER_TYP</td>
      <td>306555</td>
      <td>0.681233</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AKT_DAT_KL</td>
      <td>61385</td>
      <td>0.136411</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALTER_HH</td>
      <td>158634</td>
      <td>0.352520</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALTER_KIND1</td>
      <td>413670</td>
      <td>0.919267</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ALTER_KIND2</td>
      <td>436210</td>
      <td>0.969356</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>418</th>
      <td>D19_LETZTER_KAUF_BRANCHE_D19_VERSICHERUNGEN</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>419</th>
      <td>D19_LETZTER_KAUF_BRANCHE_D19_VOLLSORTIMENT</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>420</th>
      <td>D19_LETZTER_KAUF_BRANCHE_D19_WEIN_FEINKOST</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>421</th>
      <td>OST_WEST_KZ_O</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>422</th>
      <td>OST_WEST_KZ_W</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>423 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Select the columns with NaNs more than 80% to check for variability</span>
<span class="n">df_train_nans_gt80</span> <span class="o">=</span> <span class="n">df_train_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_train_nans</span><span class="p">[</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">8</span><span class="p">),</span> <span class="s2">&quot;Columns&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">df_train_nans_gt80</span><span class="p">,</span> <span class="n">df_train_nans_gt80</span><span class="o">.</span><span class="n">size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;, &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;,
        &#39;ANZ_HH_TITEL&#39;, &#39;ANZ_KINDER&#39;, &#39;ANZ_TITEL&#39;, &#39;D19_BANKEN_ANZ_12&#39;,
        &#39;D19_BANKEN_ANZ_24&#39;, &#39;D19_BANKEN_DIREKT&#39;, &#39;D19_BANKEN_GROSS&#39;,
        &#39;D19_BANKEN_LOKAL&#39;, &#39;D19_BANKEN_ONLINE_QUOTE_12&#39;,
        &#39;D19_BANKEN_REST&#39;, &#39;D19_BEKLEIDUNG_GEH&#39;, &#39;D19_BILDUNG&#39;,
        &#39;D19_BIO_OEKO&#39;, &#39;D19_DIGIT_SERV&#39;, &#39;D19_DROGERIEARTIKEL&#39;,
        &#39;D19_ENERGIE&#39;, &#39;D19_FREIZEIT&#39;, &#39;D19_GARTEN&#39;, &#39;D19_HANDWERK&#39;,
        &#39;D19_KINDERARTIKEL&#39;, &#39;D19_KOSMETIK&#39;, &#39;D19_LEBENSMITTEL&#39;,
        &#39;D19_NAHRUNGSERGAENZUNG&#39;, &#39;D19_RATGEBER&#39;, &#39;D19_SAMMELARTIKEL&#39;,
        &#39;D19_SCHUHE&#39;, &#39;D19_TELKO_ANZ_12&#39;, &#39;D19_TELKO_ANZ_24&#39;,
        &#39;D19_TELKO_MOBILE&#39;, &#39;D19_TELKO_ONLINE_QUOTE_12&#39;, &#39;D19_TELKO_REST&#39;,
        &#39;D19_TIERARTIKEL&#39;, &#39;D19_VERSAND_REST&#39;, &#39;D19_VERSI_ANZ_12&#39;,
        &#39;D19_VERSI_ANZ_24&#39;, &#39;D19_VERSI_ONLINE_QUOTE_12&#39;,
        &#39;D19_WEIN_FEINKOST&#39;, &#39;HH_DELTA_FLAG&#39;, &#39;KBA05_ANTG4&#39;, &#39;KBA05_SEG6&#39;,
        &#39;KONSUMZELLE&#39;, &#39;SOHO_KZ&#39;, &#39;TITEL_KZ&#39;, &#39;UNGLEICHENN_FLAG&#39;],
       dtype=object), 48)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df_train_nans_gt80</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>int64    48
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will calculate the <strong>entropy</strong> on the above (ordinal variables) as a measure of the amount of information in a categorical variable. We will attempt to identify columns with little to no information at all.</p>
<p>To do this we will create a function to calculate the entropy in a given column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_entropy</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the entropy of a data series.</span>

<span class="sd">    Calculate the entropy based on Shannon&#39;s entropy (log2).</span>
<span class="sd">    Scipy entropy() will normalize values&#39; frequencies if</span>
<span class="sd">    they don’t sum to 1.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels (pd.Series): pandas Series to calculate entropy</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        ent: The calculated entropy of the input labels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get values&#39; frequencies</span>
    <span class="n">vals_freq</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ent</span> <span class="o">=</span> <span class="n">entropy</span><span class="p">(</span><span class="n">vals_freq</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ent</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A mapping of attribute names (columns) and entropy can be created. This will allow us to decide if we should drop some more columns with a high percentage of NaNs that also offer little to no information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">drop_nan_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_nans_cols</span><span class="p">,</span> <span class="n">nan_thres</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">use_entropy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ent_thres</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get df columns with higher NaN percent than  nan_thres (&gt; 80%) and return</span>
<span class="sd">    the ones with entropy &lt; ent_thres. If use_entropy=False return all columns</span>
<span class="sd">    with NaN portion higher than nan_thres.</span>

<span class="sd">    Returns:</span>
<span class="sd">        drop_cols (np.array): Higher percentage NaN columns list (with low entropy)</span>
<span class="sd">        ent (dict): Mapping of attributes names with entropy values for selected</span>
<span class="sd">        columns range (or None if entropy is not used). </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select the columns with NaNs more than nan_thres to check for variability</span>
    <span class="n">df_nans_cols_gt80</span> <span class="o">=</span> <span class="n">df_nans_cols</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df_nans_cols</span><span class="p">[</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nan_thres</span><span class="p">),</span>
                                         <span class="s2">&quot;Columns&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="c1"># Filter the dataset to select the above columns only.</span>
    <span class="n">df_var_nan80</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">df_nans_cols_gt80</span><span class="p">)</span>
    <span class="n">drop_cols</span> <span class="o">=</span> <span class="n">df_var_nan80</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ent</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">use_entropy</span><span class="p">:</span>
        <span class="c1"># Calculate entropy &amp; create mapping</span>
        <span class="n">ent</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">get_entropy</span><span class="p">(</span><span class="n">df_var_nan80</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_var_nan80</span><span class="p">}</span>
        <span class="c1"># From the dictionary we will select the columns with entropy less than ent_thres</span>
        <span class="n">df_ent_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ent</span> <span class="k">if</span> <span class="n">ent</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">ent_thres</span><span class="p">]</span>
        <span class="n">drop_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df_ent_drop</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">drop_cols</span><span class="p">,</span> <span class="n">ent</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get df_train columns with higher NaN percent (&gt; 80%) and return the ones with entropy &lt; 1.0</span>
<span class="n">df_train_ent_drop</span><span class="p">,</span> <span class="n">df_train_var_nan80_ent</span> <span class="o">=</span> <span class="n">drop_nan_cols</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_train_nans</span><span class="p">)</span>

<span class="n">df_train_ent_drop</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_train_ent_drop</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(array([&#39;ALTER_KIND1&#39;, &#39;ALTER_KIND2&#39;, &#39;ALTER_KIND3&#39;, &#39;ALTER_KIND4&#39;,
        &#39;ANZ_HH_TITEL&#39;, &#39;ANZ_KINDER&#39;, &#39;ANZ_TITEL&#39;, &#39;D19_BANKEN_ANZ_12&#39;,
        &#39;D19_BANKEN_ANZ_24&#39;, &#39;D19_BANKEN_GROSS&#39;, &#39;D19_BANKEN_LOKAL&#39;,
        &#39;D19_BANKEN_ONLINE_QUOTE_12&#39;, &#39;D19_BANKEN_REST&#39;,
        &#39;D19_BEKLEIDUNG_GEH&#39;, &#39;D19_BILDUNG&#39;, &#39;D19_BIO_OEKO&#39;,
        &#39;D19_DIGIT_SERV&#39;, &#39;D19_DROGERIEARTIKEL&#39;, &#39;D19_ENERGIE&#39;,
        &#39;D19_FREIZEIT&#39;, &#39;D19_GARTEN&#39;, &#39;D19_HANDWERK&#39;, &#39;D19_KINDERARTIKEL&#39;,
        &#39;D19_KOSMETIK&#39;, &#39;D19_LEBENSMITTEL&#39;, &#39;D19_NAHRUNGSERGAENZUNG&#39;,
        &#39;D19_RATGEBER&#39;, &#39;D19_SAMMELARTIKEL&#39;, &#39;D19_SCHUHE&#39;,
        &#39;D19_TELKO_ANZ_12&#39;, &#39;D19_TELKO_ANZ_24&#39;, &#39;D19_TELKO_MOBILE&#39;,
        &#39;D19_TELKO_ONLINE_QUOTE_12&#39;, &#39;D19_TELKO_REST&#39;, &#39;D19_TIERARTIKEL&#39;,
        &#39;D19_VERSI_ANZ_12&#39;, &#39;D19_VERSI_ANZ_24&#39;,
        &#39;D19_VERSI_ONLINE_QUOTE_12&#39;, &#39;D19_WEIN_FEINKOST&#39;, &#39;HH_DELTA_FLAG&#39;,
        &#39;KBA05_ANTG4&#39;, &#39;KBA05_SEG6&#39;, &#39;KONSUMZELLE&#39;, &#39;SOHO_KZ&#39;, &#39;TITEL_KZ&#39;,
        &#39;UNGLEICHENN_FLAG&#39;], dtype=&#39;&lt;U26&#39;), 46)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create plot data, in a new df get &#39;Attributes&#39;, &#39;Entropy&#39; and &quot;NaNportions&quot;</span>
<span class="n">plt_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_train_var_nan80_ent</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;Entropy&#39;</span><span class="p">])</span>

<span class="c1"># Get NaN portions for the attributes with NaNs more than 80%</span>
<span class="n">plt_data</span><span class="p">[</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_train_nans</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_train_nans</span><span class="p">[</span><span class="s2">&quot;Columns&quot;</span><span class="p">]</span>
                                            <span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df_train_nans_gt80</span><span class="p">),</span><span class="s2">&quot;NaNportions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Sort by `Entropy` values</span>
<span class="n">plt_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;Entropy&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attributes</th>
      <th>Entropy</th>
      <th>NaNportions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>D19_VERSAND_REST</td>
      <td>1.0198</td>
      <td>0.829644</td>
    </tr>
    <tr>
      <th>9</th>
      <td>D19_BANKEN_DIREKT</td>
      <td>1.0002</td>
      <td>0.835387</td>
    </tr>
    <tr>
      <th>23</th>
      <td>D19_KINDERARTIKEL</td>
      <td>0.9998</td>
      <td>0.828273</td>
    </tr>
    <tr>
      <th>18</th>
      <td>D19_DROGERIEARTIKEL</td>
      <td>0.9767</td>
      <td>0.849622</td>
    </tr>
    <tr>
      <th>32</th>
      <td>D19_TELKO_MOBILE</td>
      <td>0.9498</td>
      <td>0.821413</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">nan_perc_entr_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}nan_perc_entr_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="c1"># Let&#39;s visualize the results</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,}):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">plt_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Entropy&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Attributes&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS] Entropy for high percentage (&gt; 0.8) NaN attributes&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">plt_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;NaNportions&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Attributes&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;[AZDIAS] Attributes NaN portions (0.8 min)&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
    <span class="c1"># copyright text</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">nan_perc_entr_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plots show that some of the attributes found with the lowest entropy also have a high number of NaNs. Checking entropy as a measure of information per column will allow us to drop those columns with a high percentage of NaNs, with more confidence than just choosing to drop columns above a high NaN percentage threshold.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Drop-previously-identified-attributes">Drop previously identified attributes<a class="anchor-link" href="#Drop-previously-identified-attributes">&#182;</a></h3><ul>
<li>Drop collinear attributes in <code>to_drop</code> array.</li>
<li>Drop attributes in <code>azd_ent_drop</code> with NaNs more than 80%, also identified as having the lowest entropy among the rest with such a high NaN percentage.</li>
<li>Drop <code>CUSTOMERS</code> specific attributes (<code>'CUSTOMER_GROUP', 'ONLINE_PURCHASE', and 'PRODUCT_GROUP'</code>).</li>
<li>Drop the datetime <code>EINGEFUEGT_AM</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">df_train_ent_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 377)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At this point all the previous steps can be aggregated in a single function to help us manipulate datasets in the following steps. We will include <code>zero_imp_attrs</code> as an optional parameter that will be used in the following analysis (in parts 2 and 3).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">wrangle_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">val_pools</span><span class="p">,</span> <span class="n">common_attrs</span><span class="p">,</span> <span class="n">replace_nan</span><span class="p">,</span> <span class="n">zero_imp_attrs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Clean and fix an input demographics dataframe for this project.</span>

<span class="sd">    This function is for cleaning and fixing datasets for this project. It</span>
<span class="sd">    returns a clean dataframe with several columns dropped based on identified</span>
<span class="sd">    NaNs, entropy and  collinearity. Additionally, values per column are checked</span>
<span class="sd">    and replaced with NaNs if they fall outside an accepted values pool.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.Dataframe): Input demographics datafrme (The notebook crashes when</span>
<span class="sd">            the entire `azdias` is loaded).</span>
<span class="sd">        val_pools (dict): A dictionary with keys the attributes names and values</span>
<span class="sd">            lists with the allowed values for each attribute. e.g.:</span>
<span class="sd">            {&#39;AGER_TYP&#39;: [nan, -1, 0, 1, 2, 3], ...}</span>
<span class="sd">        common_attrs (np.array): Common attributes (attrs_common) between</span>
<span class="sd">            demographic dataset and excel files. e.g.:</span>
<span class="sd">            (array([&#39;AKT_DAT_KL&#39;, &#39;ALTERSKATEGORIE_FEIN&#39;, ...)]</span>
<span class="sd">        replace_nan (dict): Mapping of attributes and values to replace with NaNs</span>
<span class="sd">            within each attribute. e.g. {&#39;AGER_TYP&#39;: 9} will replace 9 in &#39;AGER_TYP&#39;</span>
<span class="sd">            with NaN.</span>
<span class="sd">        zero_imp_attrs (array like or None): `zero_val_attrs` computed zero</span>
<span class="sd">            importance attributes. If provided these will be dropped from the</span>
<span class="sd">            input df.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        df (pd.Dataframe): The cleaned and fixed df.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Keep &quot;LNR&quot; IDs</span>
    <span class="n">clientIDs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;LNR&quot;</span><span class="p">]</span>

    <span class="c1"># Drop `customer` specific attributes.</span>
    <span class="n">other_to_drop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;CUSTOMER_GROUP&quot;</span><span class="p">,</span> <span class="s2">&quot;ONLINE_PURCHASE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRODUCT_GROUP&quot;</span><span class="p">])</span>

    <span class="c1"># Remove &quot;LNR&quot; and &quot;EINGEFUEGT_AM&quot; columns which are client IDs and entry datetimes</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">([</span><span class="s2">&quot;LNR&quot;</span><span class="p">,</span> <span class="s2">&quot;EINGEFUEGT_AM&quot;</span><span class="p">],</span> <span class="n">other_to_drop</span><span class="p">),</span>
            <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># find object columns</span>
    <span class="n">cat_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="c1"># Convert to category columns</span>
    <span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cat_cols</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Replace unknown and specific values with NaNs</span>
    <span class="c1"># for every key (attribute) in the dictionary created earlier</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">val_pools</span><span class="p">:</span>
        <span class="c1"># if the attribute is among the common ones</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">common_attrs</span><span class="p">:</span>
            <span class="c1"># select all those rows in the column that fall outside the attritbute&#39;s specified values pool and replace them with NaN.</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">val_pools</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
    <span class="c1"># Use a dictionary mapping of attributes to replace value 9 (unknown) for NaN for specific attributes.</span>
    <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">replace_nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># NaNs</span>
    <span class="c1"># Total</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total df NaNs portion: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="c1"># Columns</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column NaNs:&quot;</span><span class="p">)</span>
    <span class="n">df_cols_nans</span> <span class="o">=</span> <span class="n">cols_nans_info</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="c1"># Rows</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Row NaNs:&quot;</span><span class="p">)</span>
    <span class="n">df_rows_nans</span> <span class="o">=</span> <span class="n">rows_nans_info</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Convert float columns to int.</span>
    <span class="n">df_int_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df_int_cols</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_int_cols</span>

    <span class="c1"># One-hot encoding, for [&#39;CAMEO_DEU_2015&#39;, &#39;D19_LETZTER_KAUF_BRANCHE&#39;, &#39;OST_WEST_KZ&#39;]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Find attribute columns with correlation greater than 0.95 and drop them</span>
    <span class="n">corr_cols_to_drop</span> <span class="o">=</span> <span class="n">drop_collinear_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">corr_cols_to_drop</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Select the columns with NaNs more than 80% and with entropy less than 1.0.</span>
    <span class="n">df_ent_drop</span><span class="p">,</span> <span class="n">ent</span> <span class="o">=</span> <span class="n">drop_nan_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df_cols_nans</span><span class="p">)</span>
    
    <span class="c1"># Drop above selected NaN attributes and supplied zero importance attributes.</span>
    <span class="n">zero_imp_drop</span> <span class="o">=</span> <span class="n">zero_imp_attrs</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">union1d</span><span class="p">(</span><span class="n">df_ent_drop</span><span class="p">,</span> <span class="n">zero_imp_drop</span><span class="p">),</span>
            <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">LNR</span><span class="o">=</span><span class="n">clientIDs</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-1:-Customer-Segmentation-Report">Part 1: Customer Segmentation Report<a class="anchor-link" href="#Part-1:-Customer-Segmentation-Report">&#182;</a></h2><p>The main bulk of your analysis will come in this part of the project. Here, you should use unsupervised learning techniques to describe the relationship between the demographics of the company's existing customers and the general population of Germany. By the end of this part, you should be able to describe parts of the general population that are more likely to be part of the mail-order company's main customer base, and which parts of the general population are less so.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>The goal of unsupervised learning is to find the underlying structure of a dataset, group that data according to similarities, and represent that dataset in a compressed format.</p>
</blockquote>
<p>The unsupervised learning algorithm can be further categorized into two types of problems:</p>
<ul>
<li><p><strong>Clustering</strong>: Clustering is a method of grouping the objects into clusters such that objects with most similarities remain in a group and have less or no similarities with the objects of another group. Cluster analysis finds the commonalities between the data objects and categorizes them as per the presence and absence of those commonalities.</p>
</li>
<li><p><strong>Association</strong>: An association rule is an unsupervised learning method which is used for finding the relationships between variables in the large database. It determines the set of items that occurs together in the dataset. Association rule makes marketing strategy more effective. For example, people who buy X item (suppose a bread) also tend to purchase Y (Butter/Jam) item. A typical example of Association rule is Market Basket Analysis.</p>
</li>
</ul>
<p>Ref: <a href="https://www.javatpoint.com/unsupervised-machine-learning">https://www.javatpoint.com/unsupervised-machine-learning</a></p>
<p>Popular unsupervised learning algorithms:</p>
<ul>
<li>K-means clustering</li>
<li>KNN (k-nearest neighbors)</li>
<li>Hierarchical clustering</li>
<li>Anomaly detection</li>
<li>Neural Networks</li>
<li>Principal Component Analysis</li>
<li>Independent Component Analysis</li>
<li>Apriori algorithm</li>
<li>Singular value decomposition</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Clustering-with-Mini-Batch-K-Means">Clustering with Mini Batch K-Means<a class="anchor-link" href="#Clustering-with-Mini-Batch-K-Means">&#182;</a></h3><p>We will choose the KMeans algorithm for data clustering, because it is a general-purpose clustering algorithm with even cluster sizes and has good scalability for very large samples. We will specifically use the <a href="https://scikit-learn.org/stable/modules/clustering.html#mini-batch-kmeans">MiniBatch code</a>, a variant of the KMeans algorithm which uses mini-batches to reduce the computation time.</p>
<p>The K-means algorithm aims to choose centroids that minimise the inertia, or within-cluster sum-of-squares criterion. However, inertia is not a normalized metric, becoming a drawback for the use of KMeans. To overcome this it is usual practice to run a dimensionality reduction algorithm such as Principal component analysis (PCA) prior to k-means clustering. K-means algorithm is very much susceptible to the range in which features are measured, we will therefore normalize our data in the process.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>PCA can be performed using the correlation matrix or the covariance matrix of the data. These will provide different results. In general the covariance matrix is used when the variable scales are similar and the correlation matrix when variables are on different scales (<a href="https://stats.stackexchange.com/a/78/336933">Ref.</a>).</p>
<p>For this data we would like to have a more informative PCA so we will go with  PCA on correlation, since the covariance matrix on our data will be primarily dominated by the amount of missing values.</p>
<p>A pipeline that will initially impute missing values with <code>most_frequent</code> values, then standardize the data with <code>MinMaxScaler</code> as we cannot assume that the shape of all your features follows a normal distribution, and finally fit PCA will allow us to:</p>
<ul>
<li>Initially fit the PCA with all components to acquire the full picture of  variability in the data.</li>
<li>Examine the <code>explained_variance_ratio_</code> and decide on the number of components to finally use. Typically, we want the explained variance to be at least 95%.</li>
<li>Fit PCA with the selected components (<code>n_components = .95</code>).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="k">import</span> <span class="n">PCA</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Impute-missing-values-with-random-selection">Impute missing values with <strong><em>random selection</em></strong><a class="anchor-link" href="#Impute-missing-values-with-random-selection">&#182;</a></h4><blockquote><p>The  Random  Selection  approach  is  a  method  based  on randomly assigning  a value to  the missing data.  The values randomly selected  are framed  in a specific  range of  values, which should  have the same  characteristics as the  values in the  variable  with  the  missingness (numerical  or  categorical data).  Each  number  in  between  the  range  has  the  same probability of being assigned to the missing data.</p>
</blockquote>
<p>Ref: <a href="https://www.researchgate.net/publication/326435546_Missing_Data_Imputation_for_Ordinal_Data">https://www.researchgate.net/publication/326435546_Missing_Data_Imputation_for_Ordinal_Data</a></p>
<p>We will create a function to apply to the dataframe for imputing missing values with random selection from the column's values range.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize random generator</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">imput_nan_rand</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get a pd.Series with NaNs and impute missing values with random selection</span>
<span class="sd">    from the column&#39;s values range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">col</span> <span class="k">if</span> <span class="n">in_place</span> <span class="k">else</span> <span class="n">col</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># get indices of `-1` occurrences</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># initialize boolean mask</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="c1"># change boolean mask at indices</span>
    <span class="n">m</span><span class="p">[</span><span class="n">idxs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># create column unique values range</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">m</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># assign random values from the pool at `-1` locations</span>
    <span class="n">c</span><span class="p">[</span><span class="o">~</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">pool</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">idxs</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create train and target sets.</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">])</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">]</span>

<span class="c1"># Impute missing values with Random Selection</span>
<span class="n">norm_train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">imput_nan_rand</span><span class="p">)</span>

<span class="c1"># Normalization</span>
<span class="n">norm_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">norm_train</span><span class="p">))</span>
<span class="n">norm_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span>
<span class="n">norm_train</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">index</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A view of our original cleaned data. Let's produce a scatter matrix for some pairs of attributes in the data to have a view of data before imputing, scaling.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">pairplot1_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}pairplot_orig_clean_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">pr1plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
<span class="n">pr1plt</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Sample data view BEFORE imputing, scaling&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># copyright text</span>
<span class="n">pr1plt</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span> <span class="p">,</span><span class="o">-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">cprt</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pairplot1_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A view of the scaled data <strong>after</strong> imputing missing values with random selection and normalization.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">pairplot2_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}pairplot_imputd_scld_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">pr2plt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">norm_train</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">diag_kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
<span class="n">pr2plt</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Sample data view AFTER imputing, scaling&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="c1"># copyright text</span>
<span class="n">pr2plt</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">4</span> <span class="p">,</span><span class="o">-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">cprt</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pairplot2_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize PCA model</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">()</span>

<span class="c1"># Fit the model with train data</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">norm_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

<span class="c1"># components</span>
<span class="n">pca</span><span class="o">.</span><span class="n">n_components_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>376</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Let&#39;s visualize the results</span>
<span class="k">def</span> <span class="nf">plt_pca</span><span class="p">(</span><span class="n">pca_model</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cumul_expl_var</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots first n_pcs principal components and the cumulative variance of</span>
<span class="sd">    components.Plots cumulative variance ratio curve marks the cumulative</span>
<span class="sd">    explained threshold if &lt; 1.0 indicating the number of PCs required.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        pca_model: A fitted PCA model (sklearn.decomposition.PCA).</span>
<span class="sd">        n_pcs (int): Number of PCs to plot.</span>
<span class="sd">        cumul_expl_var (float): Plot information about cumulative variance ratio</span>
<span class="sd">        below `cumul_expl_var` threshold.</span>
<span class="sd">        fig_size (tuple of int): Figure size for the combined plot.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        df (pd.DataFrame): A dataframe ordered by PCs variance ratios with a</span>
<span class="sd">            cumulative variance ratio column (sums to 1).</span>
<span class="sd">        thres_num_pcs: Number of PCs for `cumul_expl_var` threshold</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pca_comp</span> <span class="o">=</span> <span class="n">n_pcs</span> <span class="k">if</span> <span class="n">pca_model</span><span class="o">.</span><span class="n">n_components_</span> <span class="o">&gt;=</span> <span class="mi">25</span> <span class="k">else</span> <span class="n">pca_model</span><span class="o">.</span><span class="n">n_components_</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;PC&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pca_model</span><span class="o">.</span><span class="n">n_components_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                           <span class="s1">&#39;var&#39;</span><span class="p">:</span> <span class="n">pca_model</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">})</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;cumul_var&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">thres_num_pcs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;cumul_var&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> \
                           <span class="n">cumul_expl_var</span><span class="p">][</span><span class="s2">&quot;cumul_var&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cumul_expl_var</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="n">thres_num_pcs</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="c1"># Bar plot of explained variance per PC</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">pca_comp</span><span class="p">,</span> <span class="p">:],</span>
                        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;PC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Variance explained, first &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pca_comp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; PCs&#39;</span><span class="p">,</span>
                <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Principal components&#39;</span><span class="p">)</span>
        <span class="c1"># Cumulative explained variance plot</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;var&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scree plot, mark: &#39;</span> \
                    <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cumul_expl_var</span><span class="p">)</span> \
                    <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">thres_num_pcs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; PCs&#39;</span><span class="p">,</span>
                <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Number of components&#39;</span><span class="p">,</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Cumulative explained variance&#39;</span><span class="p">)</span>
        <span class="c1"># if the number of PCs at cumul_expl_var is less than the</span>
        <span class="c1"># total computed PCs mark it on the chart</span>
        <span class="k">if</span> <span class="n">thres_num_pcs</span> <span class="o">&lt;</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1"># horizontal line marker</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">cumul_expl_var</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
            <span class="c1"># vertical line marker</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">thres_num_pcs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="c1"># copyright text</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_file</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">thres_num_pcs</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca_scree_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}pca_screeplt_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">pca_df</span><span class="p">,</span> <span class="n">pcs_num</span> <span class="o">=</span> <span class="n">plt_pca</span><span class="p">(</span><span class="n">pca</span><span class="p">,</span> <span class="n">n_pcs</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">cumul_expl_var</span><span class="o">=.</span><span class="mi">7</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="n">pca_scree_file</span><span class="p">)</span>

<span class="n">pca_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC</th>
      <th>var</th>
      <th>cumul_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.068443</td>
      <td>0.068443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0.044690</td>
      <td>0.113133</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0.035743</td>
      <td>0.148876</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0.032697</td>
      <td>0.181572</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.023131</td>
      <td>0.204703</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, for approximately <strong>0.7</strong> cumulative explained variance ratio line marked components in the figure are required (amount of variance that needs to be explained is greater than the percentage specified by <code>n_components</code>).</p>
<p>We will fit PCA again using the number of components for 0.7 cumulative explained variance ratio:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialize PCA with the new parameter (could also use n_components=.75)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">pcs_num</span><span class="p">)</span>

<span class="c1"># Fit the model with the new parameter again and apply the dimensionality reduction.</span>
<span class="n">train_reduced</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">norm_train</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>

<span class="n">train_reduced</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 104)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(104, 376)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have <code>n</code> <code>components_</code> representing the <code>p</code> principal axes in feature space. Each component is an array of loadings (weights) defining the direction of the principal component along which data varies the most. It results in a line in the <code>p</code> dimensional feature space.</p>
<p>We can see how each attribute is represneted by these weights by creating a mapping:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create the column names for each PC</span>
<span class="n">pc_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">n_components_</span><span class="p">)]</span>

<span class="c1"># Create a reduced attributes dataframe for later use</span>
<span class="n">train_reduced</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_reduced</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">pc_names</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">norm_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Create loadings - attributes mapping</span>
<span class="n">pca_wghts_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">,</span>
                            <span class="n">columns</span><span class="o">=</span><span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">pc_names</span><span class="p">)</span>

<span class="n">pca_wghts_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(104, 376)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we transpose this we get:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pca_wghts_df</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
      <th>PC4</th>
      <th>PC5</th>
      <th>PC6</th>
      <th>PC7</th>
      <th>PC8</th>
      <th>PC9</th>
      <th>PC10</th>
      <th>PC11</th>
      <th>PC12</th>
      <th>PC13</th>
      <th>PC14</th>
      <th>PC15</th>
      <th>PC16</th>
      <th>PC17</th>
      <th>PC18</th>
      <th>PC19</th>
      <th>PC20</th>
      <th>PC21</th>
      <th>PC22</th>
      <th>PC23</th>
      <th>PC24</th>
      <th>PC25</th>
      <th>PC26</th>
      <th>PC27</th>
      <th>PC28</th>
      <th>PC29</th>
      <th>PC30</th>
      <th>PC31</th>
      <th>PC32</th>
      <th>PC33</th>
      <th>PC34</th>
      <th>PC35</th>
      <th>PC36</th>
      <th>PC37</th>
      <th>PC38</th>
      <th>PC39</th>
      <th>PC40</th>
      <th>...</th>
      <th>PC65</th>
      <th>PC66</th>
      <th>PC67</th>
      <th>PC68</th>
      <th>PC69</th>
      <th>PC70</th>
      <th>PC71</th>
      <th>PC72</th>
      <th>PC73</th>
      <th>PC74</th>
      <th>PC75</th>
      <th>PC76</th>
      <th>PC77</th>
      <th>PC78</th>
      <th>PC79</th>
      <th>PC80</th>
      <th>PC81</th>
      <th>PC82</th>
      <th>PC83</th>
      <th>PC84</th>
      <th>PC85</th>
      <th>PC86</th>
      <th>PC87</th>
      <th>PC88</th>
      <th>PC89</th>
      <th>PC90</th>
      <th>PC91</th>
      <th>PC92</th>
      <th>PC93</th>
      <th>PC94</th>
      <th>PC95</th>
      <th>PC96</th>
      <th>PC97</th>
      <th>PC98</th>
      <th>PC99</th>
      <th>PC100</th>
      <th>PC101</th>
      <th>PC102</th>
      <th>PC103</th>
      <th>PC104</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AGER_TYP</th>
      <td>0.040499</td>
      <td>0.019273</td>
      <td>0.017980</td>
      <td>-0.004219</td>
      <td>-0.001565</td>
      <td>-0.000258</td>
      <td>0.006022</td>
      <td>-0.014194</td>
      <td>0.005669</td>
      <td>-0.010191</td>
      <td>0.007729</td>
      <td>-0.039241</td>
      <td>0.042344</td>
      <td>-0.014783</td>
      <td>0.019302</td>
      <td>0.031102</td>
      <td>0.032487</td>
      <td>-0.002453</td>
      <td>0.020443</td>
      <td>0.007879</td>
      <td>-0.019790</td>
      <td>0.032408</td>
      <td>0.054422</td>
      <td>-0.150948</td>
      <td>-0.049295</td>
      <td>-0.079318</td>
      <td>-0.030557</td>
      <td>-0.173139</td>
      <td>0.047624</td>
      <td>-0.002524</td>
      <td>-0.082730</td>
      <td>0.019034</td>
      <td>0.106739</td>
      <td>0.145640</td>
      <td>-0.446251</td>
      <td>0.221433</td>
      <td>0.214156</td>
      <td>0.371410</td>
      <td>-0.151337</td>
      <td>0.242150</td>
      <td>...</td>
      <td>-0.008568</td>
      <td>0.020501</td>
      <td>-0.019924</td>
      <td>0.012193</td>
      <td>-0.015130</td>
      <td>-0.003970</td>
      <td>-0.003982</td>
      <td>0.005635</td>
      <td>0.041221</td>
      <td>0.012159</td>
      <td>0.000564</td>
      <td>-0.013774</td>
      <td>0.013212</td>
      <td>0.026896</td>
      <td>-0.017190</td>
      <td>0.027402</td>
      <td>0.016086</td>
      <td>-0.010980</td>
      <td>-0.006706</td>
      <td>0.017079</td>
      <td>-0.001329</td>
      <td>0.014007</td>
      <td>0.007533</td>
      <td>-0.013356</td>
      <td>0.002867</td>
      <td>0.007722</td>
      <td>-0.038068</td>
      <td>-0.017381</td>
      <td>0.004318</td>
      <td>-0.000098</td>
      <td>-0.017653</td>
      <td>-0.005291</td>
      <td>-0.004985</td>
      <td>-0.002139</td>
      <td>-0.015422</td>
      <td>-0.018455</td>
      <td>0.006800</td>
      <td>0.014299</td>
      <td>0.003058</td>
      <td>-0.021616</td>
    </tr>
    <tr>
      <th>AKT_DAT_KL</th>
      <td>0.152465</td>
      <td>0.010389</td>
      <td>-0.014757</td>
      <td>-0.072644</td>
      <td>-0.052135</td>
      <td>-0.101453</td>
      <td>0.071686</td>
      <td>-0.016238</td>
      <td>0.005246</td>
      <td>0.012983</td>
      <td>0.028318</td>
      <td>-0.015893</td>
      <td>0.020779</td>
      <td>0.006200</td>
      <td>-0.020310</td>
      <td>0.021642</td>
      <td>-0.023154</td>
      <td>-0.022461</td>
      <td>0.074776</td>
      <td>0.047494</td>
      <td>-0.002094</td>
      <td>-0.039537</td>
      <td>-0.013757</td>
      <td>0.030089</td>
      <td>0.045386</td>
      <td>-0.074345</td>
      <td>0.079225</td>
      <td>0.048936</td>
      <td>-0.035783</td>
      <td>0.023037</td>
      <td>-0.017126</td>
      <td>-0.020888</td>
      <td>-0.171201</td>
      <td>-0.017245</td>
      <td>0.153162</td>
      <td>-0.174816</td>
      <td>0.176846</td>
      <td>-0.008283</td>
      <td>-0.038711</td>
      <td>0.000405</td>
      <td>...</td>
      <td>-0.068520</td>
      <td>-0.094211</td>
      <td>0.067700</td>
      <td>0.080490</td>
      <td>0.049474</td>
      <td>-0.137913</td>
      <td>-0.074241</td>
      <td>0.139672</td>
      <td>0.056110</td>
      <td>0.089608</td>
      <td>0.036279</td>
      <td>0.067461</td>
      <td>0.046748</td>
      <td>-0.156053</td>
      <td>-0.000363</td>
      <td>-0.150017</td>
      <td>0.050865</td>
      <td>-0.042738</td>
      <td>-0.014365</td>
      <td>-0.005070</td>
      <td>0.174441</td>
      <td>0.115032</td>
      <td>0.040947</td>
      <td>-0.011871</td>
      <td>0.029424</td>
      <td>0.010613</td>
      <td>0.042750</td>
      <td>-0.019973</td>
      <td>0.020907</td>
      <td>-0.044007</td>
      <td>0.019236</td>
      <td>0.034034</td>
      <td>-0.063241</td>
      <td>-0.014246</td>
      <td>-0.010589</td>
      <td>-0.062912</td>
      <td>0.034017</td>
      <td>-0.125696</td>
      <td>-0.079933</td>
      <td>0.058497</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 104 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">pc1pc2_makeup_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}PC1PC2_attr_makeup_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="c1"># Let&#39;s visualize the results sampling some attributes</span>
<span class="n">plt_attrs_wgts</span> <span class="o">=</span> <span class="n">pca_wghts_df</span><span class="o">.</span><span class="n">T</span><span class="p">[[</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="s2">&quot;PC2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Attributes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># Combine the two PCs to create a type of category for plotting purposes.</span>
<span class="n">plt_attrs_wgts</span> <span class="o">=</span> <span class="n">plt_attrs_wgts</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Attributes&#39;</span><span class="p">)</span>
<span class="c1"># Sort by values</span>
<span class="n">plt_attrs_wgts</span> <span class="o">=</span> <span class="n">plt_attrs_wgts</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Plot</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,}):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">plt_attrs_wgts</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Attributes&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Blues_d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Attributes&#39; influences on first two PCs (sample of 30 attributes)&quot;</span><span class="p">,</span>
                    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;PCs weights&quot;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pc1pc2_makeup_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would like to examine the makeup of each PCA component based on the weightings of the original attributes that are included in each component. To do so will create a function to help us visually identify top <code>n</code> and bottom <code>n</code> attributes' influence on each principal component.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_pc_attrs</span><span class="p">(</span><span class="n">df_wghts</span><span class="p">,</span> <span class="n">pc_n</span><span class="p">,</span> <span class="n">plot_n</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">save_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot top `n` and bottom `n` attributes&#39; influence on each principal component.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_wghts (pd.DataFrame): Contains mapping of PCs&#39; weights for each attribute</span>
<span class="sd">        pc_n (int): Number of PCs to plot.</span>
<span class="sd">        plot_n (int): Number of attributes to plot (will be used for top &amp; bottom)</span>
<span class="sd">        fig_size (tuple): Size of figure, e.g. (12, 8)</span>
<span class="sd">        save_name (str or None): File name to save the figure to.</span>
<span class="sd">            If `None` figure will not be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="s1">&#39;PC&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pc_n</span><span class="p">)</span>
    <span class="n">pc_attrs_wgts</span> <span class="o">=</span> <span class="n">df_wghts</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">pc</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>\
                    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;Attributes&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># Plot top n and bottom n</span>
    <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,}):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pc_attrs_wgts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">plot_n</span><span class="p">,</span> <span class="o">-</span><span class="n">plot_n</span><span class="p">:</span><span class="mi">0</span><span class="p">]],</span> <span class="n">x</span><span class="o">=</span><span class="n">pc</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Attributes&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Attributes&#39; influences on </span><span class="si">{}</span><span class="s2"> (top &amp; bottom </span><span class="si">{}</span><span class="s2">)&quot;</span>\
                        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">plot_n</span><span class="p">),</span>
                        <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> weights&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pc</span><span class="p">))</span>
        <span class="c1"># copyright text</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_name</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_name</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">pc1_makeup_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}PC1_attr_makeup_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">plot_pc_attrs</span><span class="p">(</span><span class="n">pca_wghts_df</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="n">pc1_makeup_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location &#39;PC2&#39;</span>
<span class="n">pc2_makeup_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}PC2_attr_makeup_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">plot_pc_attrs</span><span class="p">(</span><span class="n">pca_wghts_df</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">save_name</span><span class="o">=</span><span class="n">pc2_makeup_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can create a list of the <strong>two</strong> highest influencing attribute names in each component.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># initialize list to hold attribute names</span>
<span class="n">pca_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># iterate through the PC columns, sort values and get the top two attributes with</span>
<span class="c1"># higher weights. Join names in a single string representing each component.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pca_wghts_df</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
    <span class="n">pca_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">pca_wghts_df</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">2</span><span class="p">])))</span>

<span class="n">pca_list</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pca_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>([&#39;CJT_TYP_2/FINANZ_SPARER&#39;,
  &#39;FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER&#39;,
  &#39;OST_WEST_KZ_W/STRUKTURTYP&#39;,
  &#39;HH_EINKOMMEN_SCORE/OST_WEST_KZ_O&#39;],
 104)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now create a dataframe where each individual (row) is described by the number of principal components that we chose previously. Each of these selected components is a linear combination of the original attribute space. We can interpret each of these selected principal components by analyzing the makeup of the component as shown earlier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">population_transformed</span> <span class="o">=</span> <span class="n">train_reduced</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">population_transformed</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="n">pca_list</span>
<span class="n">population_transformed</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CJT_TYP_2/FINANZ_SPARER</th>
      <th>FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER</th>
      <th>OST_WEST_KZ_W/STRUKTURTYP</th>
      <th>HH_EINKOMMEN_SCORE/OST_WEST_KZ_O</th>
      <th>ANREDE_KZ/SEMIO_KAEM</th>
      <th>KBA13_BAUMAX/LP_FAMILIE_FEIN</th>
      <th>OST_WEST_KZ_O/KBA13_KW_61_120</th>
      <th>PLZ8_ANTG4/KBA13_ANTG4</th>
      <th>KBA13_CCM_3001/KBA13_CCM_2501</th>
      <th>KBA05_MAXSEG/KBA05_MOTOR</th>
      <th>KBA13_ANTG4/PLZ8_ANTG4</th>
      <th>KBA05_MAXBJ/SHOPPER_TYP</th>
      <th>VERS_TYP/HEALTH_TYP</th>
      <th>KBA05_MOD8/KBA05_SEG9</th>
      <th>LP_FAMILIE_FEIN/LP_LEBENSPHASE_FEIN</th>
      <th>KBA05_KW3/KBA05_CCM4</th>
      <th>KBA13_ALTERHALTER_45/KBA13_HALTER_35</th>
      <th>KBA13_VORB_1_2/KBA13_ALTERHALTER_61</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>KBA13_KRSZUL_NEU/KBA05_MOD8</th>
      <th>KBA05_ANHANG/KBA05_ANTG3</th>
      <th>KBA05_ANHANG/KBA05_BAUMAX</th>
      <th>SHOPPER_TYP/KBA05_ANTG1</th>
      <th>SHOPPER_TYP/KBA13_KRSSEG_VAN</th>
      <th>KBA05_ANHANG/KBA05_MOTRAD</th>
      <th>KBA05_MOTRAD/BALLRAUM</th>
      <th>VHN/D19_SOZIALES</th>
      <th>PLZ8_ANTG4/KBA05_ANHANG</th>
      <th>PLZ8_ANTG4/KBA05_ANTG3</th>
      <th>SHOPPER_TYP/KBA13_ANTG4</th>
      <th>PLZ8_ANTG4/KBA13_KRSSEG_VAN</th>
      <th>D19_LETZTER_KAUF_BRANCHE_D19_UNBEKANNT/D19_KONSUMTYP</th>
      <th>KBA05_ANHANG/KBA05_SEG7</th>
      <th>KBA05_MOTRAD/KBA05_ANTG3</th>
      <th>KBA05_MOTRAD/AGER_TYP</th>
      <th>VHN/KBA05_MOTRAD</th>
      <th>AGER_TYP/KBA05_ZUL2</th>
      <th>KBA05_SEG8/KBA05_SEG7</th>
      <th>KBA05_SEG7/AGER_TYP</th>
      <th>...</th>
      <th>D19_BANKEN_DIREKT/D19_REISEN</th>
      <th>D19_REISEN/KBA13_CCM_1500</th>
      <th>D19_HAUS_DEKO/D19_BEKLEIDUNG_REST</th>
      <th>D19_BEKLEIDUNG_REST/D19_BANKEN_DIREKT</th>
      <th>KBA13_KW_70/KBA05_ANTG2</th>
      <th>D19_BEKLEIDUNG_REST/D19_HAUS_DEKO</th>
      <th>D19_VERSAND_REST/D19_BEKLEIDUNG_REST</th>
      <th>KBA05_MOD1/KBA05_SEG10</th>
      <th>KK_KUNDENTYP/D19_VERSAND_ANZ_24</th>
      <th>KBA05_ANTG2/D19_VOLLSORTIMENT</th>
      <th>KBA05_SEG9/D19_TECHNIK</th>
      <th>KBA05_ALTER2/D19_VERSAND_ANZ_12</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_12</th>
      <th>KBA05_SEG9/KBA05_ALTER3</th>
      <th>D19_VOLLSORTIMENT/KBA05_HERST5</th>
      <th>KBA05_MOD8/D19_REISEN</th>
      <th>D19_BUCH_CD/KBA05_KW3</th>
      <th>D19_BUCH_CD/KBA05_MOD8</th>
      <th>D19_BUCH_CD/KBA05_KRSVAN</th>
      <th>D19_VOLLSORTIMENT/D19_GESAMT_ONLINE_QUOTE_12</th>
      <th>RELAT_AB/KBA05_KW3</th>
      <th>D19_SONSTIGE/EXTSEL992</th>
      <th>KBA05_CCM4/D19_SONSTIGE</th>
      <th>KBA05_DIESEL/UMFELD_JUNG</th>
      <th>KBA05_DIESEL/RT_UEBERGROESSE</th>
      <th>KBA13_VORB_2/KBA13_VORB_1_2</th>
      <th>GFK_URLAUBERTYP/KBA05_KRSVAN</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_24</th>
      <th>KBA05_SEG5/KBA13_SEG_OBERKLASSE</th>
      <th>KBA05_BAUMAX/UMFELD_ALT</th>
      <th>KBA13_KW_90/KBA13_CCM_3001</th>
      <th>KBA05_DIESEL/KBA05_HERST4</th>
      <th>KBA13_SEG_OBERKLASSE/KBA13_KRSZUL_NEU</th>
      <th>KBA05_MOD4/KBA05_SEG5</th>
      <th>KBA13_BJ_2008/RETOURTYP_BK_S</th>
      <th>KBA05_VORB2/EXTSEL992</th>
      <th>KBA05_HERST4/KBA05_FRAU</th>
      <th>D19_VERSAND_ONLINE_QUOTE_12/KBA05_KRSVAN</th>
      <th>GFK_URLAUBERTYP/D19_VERSAND_ONLINE_QUOTE_12</th>
      <th>KK_KUNDENTYP/D19_GESAMT_ANZ_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.234629</td>
      <td>-0.867582</td>
      <td>-0.578983</td>
      <td>-0.220230</td>
      <td>-0.742176</td>
      <td>0.211376</td>
      <td>-0.222328</td>
      <td>0.117435</td>
      <td>0.625594</td>
      <td>-0.276393</td>
      <td>0.209671</td>
      <td>1.080525</td>
      <td>0.073092</td>
      <td>-0.005344</td>
      <td>-0.725521</td>
      <td>0.534920</td>
      <td>-0.816195</td>
      <td>0.000018</td>
      <td>-0.548220</td>
      <td>-0.422507</td>
      <td>0.358123</td>
      <td>0.910408</td>
      <td>-0.577757</td>
      <td>-0.334013</td>
      <td>-0.317721</td>
      <td>-0.865876</td>
      <td>-0.034087</td>
      <td>0.055927</td>
      <td>0.069684</td>
      <td>0.000181</td>
      <td>0.192486</td>
      <td>0.326819</td>
      <td>-0.207724</td>
      <td>0.509368</td>
      <td>-0.385418</td>
      <td>0.339499</td>
      <td>0.397615</td>
      <td>0.350358</td>
      <td>-0.024274</td>
      <td>0.040678</td>
      <td>...</td>
      <td>-0.127198</td>
      <td>0.040113</td>
      <td>0.447853</td>
      <td>0.491691</td>
      <td>0.887629</td>
      <td>0.179989</td>
      <td>0.231284</td>
      <td>0.223842</td>
      <td>0.026079</td>
      <td>-0.465061</td>
      <td>-0.227642</td>
      <td>-0.249795</td>
      <td>-0.011948</td>
      <td>0.248586</td>
      <td>-0.388448</td>
      <td>0.285329</td>
      <td>-0.139759</td>
      <td>-0.337783</td>
      <td>-0.083996</td>
      <td>-0.233873</td>
      <td>-0.179353</td>
      <td>-0.448052</td>
      <td>-0.513697</td>
      <td>-0.347848</td>
      <td>-0.781476</td>
      <td>0.001404</td>
      <td>-0.283709</td>
      <td>-0.331719</td>
      <td>0.221276</td>
      <td>-0.163244</td>
      <td>0.291595</td>
      <td>0.186463</td>
      <td>-0.005497</td>
      <td>-0.228021</td>
      <td>0.307563</td>
      <td>-0.713716</td>
      <td>0.401752</td>
      <td>0.477682</td>
      <td>-0.182475</td>
      <td>-0.062534</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.977389</td>
      <td>0.134613</td>
      <td>0.048990</td>
      <td>-0.160303</td>
      <td>-0.804427</td>
      <td>-0.352177</td>
      <td>0.670749</td>
      <td>-1.172047</td>
      <td>-1.055501</td>
      <td>0.573792</td>
      <td>0.661885</td>
      <td>-1.608553</td>
      <td>0.358878</td>
      <td>0.913354</td>
      <td>-1.173424</td>
      <td>0.805668</td>
      <td>-0.148719</td>
      <td>0.882287</td>
      <td>0.335386</td>
      <td>0.451623</td>
      <td>0.064425</td>
      <td>1.197852</td>
      <td>-0.666765</td>
      <td>0.302235</td>
      <td>0.656651</td>
      <td>0.195785</td>
      <td>-0.440172</td>
      <td>0.129148</td>
      <td>-0.404084</td>
      <td>0.013804</td>
      <td>-0.379258</td>
      <td>0.256196</td>
      <td>-0.816625</td>
      <td>0.160029</td>
      <td>0.401891</td>
      <td>-0.057911</td>
      <td>0.288800</td>
      <td>0.054266</td>
      <td>0.203565</td>
      <td>-0.225481</td>
      <td>...</td>
      <td>-0.006713</td>
      <td>-0.835488</td>
      <td>-0.042651</td>
      <td>0.597577</td>
      <td>0.099311</td>
      <td>0.298713</td>
      <td>0.140128</td>
      <td>0.083948</td>
      <td>-0.230444</td>
      <td>0.391376</td>
      <td>0.510545</td>
      <td>0.052131</td>
      <td>0.096806</td>
      <td>-0.743018</td>
      <td>0.162313</td>
      <td>-0.162888</td>
      <td>-0.008984</td>
      <td>0.063964</td>
      <td>-0.152078</td>
      <td>-0.096144</td>
      <td>-0.237473</td>
      <td>0.091904</td>
      <td>0.133245</td>
      <td>0.210970</td>
      <td>-0.439297</td>
      <td>0.643481</td>
      <td>0.427124</td>
      <td>0.061224</td>
      <td>0.371090</td>
      <td>-0.009132</td>
      <td>-0.335295</td>
      <td>-0.327904</td>
      <td>0.320068</td>
      <td>-0.003117</td>
      <td>-0.307557</td>
      <td>-0.310712</td>
      <td>-0.153566</td>
      <td>0.351870</td>
      <td>-0.000796</td>
      <td>0.130907</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.640617</td>
      <td>0.397748</td>
      <td>0.081203</td>
      <td>-0.250016</td>
      <td>0.403747</td>
      <td>-1.531851</td>
      <td>-0.125694</td>
      <td>0.206615</td>
      <td>1.062772</td>
      <td>-0.607811</td>
      <td>-0.043918</td>
      <td>-0.782834</td>
      <td>0.357914</td>
      <td>0.292886</td>
      <td>-0.547790</td>
      <td>-0.100105</td>
      <td>-0.214742</td>
      <td>0.114630</td>
      <td>-0.347420</td>
      <td>-0.215213</td>
      <td>0.445487</td>
      <td>-0.195424</td>
      <td>-0.093167</td>
      <td>-0.405749</td>
      <td>0.601990</td>
      <td>-0.136346</td>
      <td>-0.291381</td>
      <td>0.456311</td>
      <td>-0.518213</td>
      <td>-0.715454</td>
      <td>-0.119906</td>
      <td>-0.011904</td>
      <td>-0.492868</td>
      <td>-0.152883</td>
      <td>-0.046090</td>
      <td>0.267519</td>
      <td>-0.506884</td>
      <td>-0.513384</td>
      <td>-0.453967</td>
      <td>0.361384</td>
      <td>...</td>
      <td>-0.265729</td>
      <td>-0.401882</td>
      <td>-0.338360</td>
      <td>-0.159854</td>
      <td>-0.263444</td>
      <td>0.874286</td>
      <td>0.041411</td>
      <td>0.421441</td>
      <td>-0.227531</td>
      <td>-0.088987</td>
      <td>0.038793</td>
      <td>-0.179560</td>
      <td>-0.421240</td>
      <td>-0.329272</td>
      <td>0.088884</td>
      <td>0.130497</td>
      <td>0.239671</td>
      <td>0.161087</td>
      <td>0.131114</td>
      <td>-0.074357</td>
      <td>-0.439820</td>
      <td>-0.504712</td>
      <td>-0.170880</td>
      <td>-0.202946</td>
      <td>-0.042772</td>
      <td>0.007435</td>
      <td>0.203907</td>
      <td>-0.274071</td>
      <td>0.202893</td>
      <td>-0.240996</td>
      <td>-0.050707</td>
      <td>-0.097291</td>
      <td>-0.152809</td>
      <td>0.085488</td>
      <td>0.211906</td>
      <td>-0.143104</td>
      <td>0.328685</td>
      <td>-0.102155</td>
      <td>0.400096</td>
      <td>0.396859</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.199834</td>
      <td>-0.007616</td>
      <td>1.126011</td>
      <td>-1.318851</td>
      <td>1.140490</td>
      <td>0.057711</td>
      <td>1.092936</td>
      <td>0.061931</td>
      <td>-0.510787</td>
      <td>0.248087</td>
      <td>1.407731</td>
      <td>-0.546964</td>
      <td>-1.101588</td>
      <td>0.236766</td>
      <td>0.230220</td>
      <td>-0.052759</td>
      <td>-0.764123</td>
      <td>-0.253049</td>
      <td>-0.406299</td>
      <td>-0.314603</td>
      <td>-0.711263</td>
      <td>0.080031</td>
      <td>-0.518777</td>
      <td>-0.530842</td>
      <td>-0.018792</td>
      <td>0.094442</td>
      <td>0.103434</td>
      <td>-0.471235</td>
      <td>-0.115663</td>
      <td>0.119208</td>
      <td>-0.258963</td>
      <td>-0.118394</td>
      <td>0.020771</td>
      <td>0.095762</td>
      <td>-0.096231</td>
      <td>0.039596</td>
      <td>0.050026</td>
      <td>-0.136419</td>
      <td>-0.129697</td>
      <td>0.468808</td>
      <td>...</td>
      <td>-0.724067</td>
      <td>-0.085839</td>
      <td>0.197129</td>
      <td>0.017804</td>
      <td>0.069867</td>
      <td>-0.359567</td>
      <td>0.394705</td>
      <td>-0.420672</td>
      <td>0.274572</td>
      <td>0.142926</td>
      <td>-0.218485</td>
      <td>0.258072</td>
      <td>0.359043</td>
      <td>0.245578</td>
      <td>-0.307132</td>
      <td>0.119405</td>
      <td>0.432255</td>
      <td>0.264530</td>
      <td>-0.079858</td>
      <td>0.020682</td>
      <td>0.426232</td>
      <td>-0.092529</td>
      <td>-0.215258</td>
      <td>0.162319</td>
      <td>0.053370</td>
      <td>0.113821</td>
      <td>0.497985</td>
      <td>-0.488428</td>
      <td>-0.038022</td>
      <td>0.106081</td>
      <td>0.070431</td>
      <td>-0.067926</td>
      <td>0.348257</td>
      <td>-0.685797</td>
      <td>0.230047</td>
      <td>-0.211343</td>
      <td>-0.124144</td>
      <td>0.192463</td>
      <td>0.117103</td>
      <td>-0.323287</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.247861</td>
      <td>0.700665</td>
      <td>-0.974589</td>
      <td>-1.270208</td>
      <td>0.270992</td>
      <td>0.698793</td>
      <td>-0.026303</td>
      <td>-0.420971</td>
      <td>0.619710</td>
      <td>0.289441</td>
      <td>-0.748615</td>
      <td>0.083695</td>
      <td>-0.194543</td>
      <td>-0.113975</td>
      <td>-0.428714</td>
      <td>0.272176</td>
      <td>0.096895</td>
      <td>0.909333</td>
      <td>-0.025264</td>
      <td>-0.212352</td>
      <td>0.108476</td>
      <td>-0.112836</td>
      <td>-0.233279</td>
      <td>-0.201998</td>
      <td>-0.278923</td>
      <td>0.223151</td>
      <td>0.017902</td>
      <td>-0.011831</td>
      <td>-0.354386</td>
      <td>0.508833</td>
      <td>-0.120905</td>
      <td>-0.948406</td>
      <td>0.591599</td>
      <td>-0.442476</td>
      <td>0.251363</td>
      <td>0.397072</td>
      <td>0.023746</td>
      <td>-0.288343</td>
      <td>0.420796</td>
      <td>-0.082198</td>
      <td>...</td>
      <td>0.447921</td>
      <td>0.390193</td>
      <td>-0.235996</td>
      <td>-0.095490</td>
      <td>-0.420967</td>
      <td>0.463086</td>
      <td>0.393737</td>
      <td>0.393154</td>
      <td>-0.283677</td>
      <td>-0.621931</td>
      <td>-0.360244</td>
      <td>-0.102992</td>
      <td>0.031882</td>
      <td>-0.106679</td>
      <td>0.716718</td>
      <td>0.197329</td>
      <td>-0.261676</td>
      <td>-0.326734</td>
      <td>-0.202511</td>
      <td>0.366927</td>
      <td>-0.062942</td>
      <td>0.176530</td>
      <td>0.060247</td>
      <td>-0.298104</td>
      <td>-0.551207</td>
      <td>0.373706</td>
      <td>-0.042755</td>
      <td>0.481701</td>
      <td>0.260109</td>
      <td>0.584887</td>
      <td>0.289511</td>
      <td>-0.167374</td>
      <td>0.010033</td>
      <td>0.462439</td>
      <td>-0.076547</td>
      <td>-0.282838</td>
      <td>-0.036585</td>
      <td>-0.392120</td>
      <td>-0.279264</td>
      <td>0.283381</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 104 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Feature selection with PCA has left us with a transformed dataset <code>train</code> with less dimensions than before. We can proceed to clustering with this dataframe.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed time: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_run</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Elapsed time:  0:04:30.844065
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Segmentation-using-unsupervised-clustering">Segmentation using unsupervised clustering<a class="anchor-link" href="#Segmentation-using-unsupervised-clustering">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Evaluating-Clustering-Performance---Clusters-choice">Evaluating Clustering Performance - Clusters choice<a class="anchor-link" href="#Evaluating-Clustering-Performance---Clusters-choice">&#182;</a></h4><p>Our approach for determining the quality of the cluster assignments will be:</p>
<ul>
<li>Randomly select k centroids, (k is equal to the number of clusters chosen)</li>
<li>Record computed sum of the squared error (<strong>SSE</strong>), defined as the sum of the squared Euclidean distances of each point to its closest centroid. (visual <strong>elbow method</strong>). Objective is to minimize SSE.</li>
<li>Record the <strong>silhouette coefficient</strong>, a measure of cluster cohesion and separation. The silhouette ranges from −1 to +1. A high number, close to 1, indicates that a sample is closer to its cluster than to other clusters. (In scikit-learn <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html"><code>silhouette_score</code></a> returns the mean Silhouette Coefficient over all samples in a cluster and is only defined if the number of labels (clusters) is greater than 2.)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">silhouette_score</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">MiniBatchKMeans</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Compute-SSE-and-Silhouette-coefficient">Compute SSE and Silhouette coefficient<a class="anchor-link" href="#Compute-SSE-and-Silhouette-coefficient">&#182;</a></h4><p>Using the <code>MiniBatchKMeans</code> which is much faster compared to <code>KMeans</code> and a <code>sample_size = 10000</code> for <code>silhouette_score</code> we can achieve acceptable results relatively fast for these large datasets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a range of values to try for cluster numbers</span>
<span class="n">n_clusters_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">all_Kscores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">timer</span><span class="p">()</span>
<span class="c1"># Run several k-means, incrementing k with each iteration, record the SSE and</span>
<span class="c1"># silhouette_score</span>
<span class="n">train_vals</span> <span class="o">=</span> <span class="n">train_reduced</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">n_clusters_range</span><span class="p">:</span>
    <span class="c1">#Initialize k-means using the faster MiniBatchKMeans</span>
    <span class="n">clusterer</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Fit standardized data with reduced features</span>
    <span class="n">clusterer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_vals</span><span class="p">)</span>
    <span class="c1"># Get computed scores, and save them for further reference.</span>
    <span class="n">k_scores</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Clusters&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span>
        <span class="s2">&quot;SSE&quot;</span><span class="p">:</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">inertia_</span><span class="p">,</span>
        <span class="s2">&quot;Sil_coef&quot;</span><span class="p">:</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">train_vals</span><span class="p">,</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span>
                                     <span class="n">sample_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
                                     <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">all_Kscores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_scores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time elapsed: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">))))</span>

<span class="c1">#Create a dataframe of clustering scores that we can use for plotting.</span>
<span class="n">all_Kscores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_Kscores</span><span class="p">)</span>
<span class="n">all_Kscores</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Clusters&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">all_Kscores</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Time elapsed:  0:01:33.096290
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SSE</th>
      <th>Sil_coef</th>
    </tr>
    <tr>
      <th>Clusters</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>8.814419e+06</td>
      <td>0.070148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.510458e+06</td>
      <td>0.055318</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.330091e+06</td>
      <td>0.056230</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8.006994e+06</td>
      <td>0.054746</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.869831e+06</td>
      <td>0.053762</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Elbow-method">Elbow method<a class="anchor-link" href="#Elbow-method">&#182;</a></h4><p>Determine the elbow point in the SSE curve using the <a href="https://github.com/arvkevi/kneed">kneed</a> package:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Elbow method knee locator</span>
<span class="kn">from</span> <span class="nn">kneed</span> <span class="k">import</span> <span class="n">KneeLocator</span>

<span class="n">kl</span> <span class="o">=</span> <span class="n">KneeLocator</span><span class="p">(</span><span class="n">n_clusters_range</span><span class="p">,</span> <span class="n">all_Kscores</span><span class="o">.</span><span class="n">SSE</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>
                 <span class="n">curve</span><span class="o">=</span><span class="s2">&quot;convex&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;decreasing&quot;</span><span class="p">)</span>

<span class="n">kl</span><span class="o">.</span><span class="n">elbow</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>8</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Optimal number of clusters is found using the <strong>elbow method</strong>, at the iteration where the SSE curve starts to bend, known as the elbow point at <code>kl.elbow</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Save image location</span>
<span class="n">elbow_sil_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}Elbow_silcoef_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="c1"># plot elbow</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Clusters&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;SSE&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">all_Kscores</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xticks</span><span class="o">=</span><span class="n">n_clusters_range</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Elbow method for optimal n_clusters&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">kl</span><span class="o">.</span><span class="n">elbow</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.65</span><span class="p">)</span>
    <span class="c1"># Plot average silhouette</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Clusters&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Sil_coef&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">all_Kscores</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xticks</span><span class="o">=</span><span class="n">n_clusters_range</span><span class="p">,</span>
        <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Average silhouette scores&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Silhouette scores for n_clusters&quot;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">elbow_sil_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Number of clusters will be chosen from the plot of SSE scores using the elbow method as the decision method. Average silhouette scores at the moment cannot be used as a cluster validation criterion since they are close to 0.0 indicating that the samples are on or very close to the decision boundary. We would have to perform further analysis with the silhouette coefficient to validate our <code>elbow</code> method choice with this criterion, but we will leave this for future work. For now, we will use silhouette scores as complementary information, providing a view on our clusters' performance with this criterion.</p>
<p>We will fit <code>MiniBatchKMeans</code> with the decided clusters number:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clusterer</span> <span class="o">=</span> <span class="n">MiniBatchKMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">kl</span><span class="o">.</span><span class="n">elbow</span><span class="p">)</span>
<span class="c1"># train_clusters = pd.Series(clusterer.fit_predict(norm_train.to_numpy()))</span>
<span class="n">train_cluster_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">clusterer</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">train_vals</span><span class="p">))</span>

<span class="n">train_cluster_labels</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_cluster_labels</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1    64149
4    63555
0    62222
2    61050
6    59945
3    53187
5    50904
7    34988
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_clusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Clusters&quot;</span><span class="p">:</span> <span class="n">train_cluster_labels</span><span class="p">,</span>
    <span class="s2">&quot;TARGET&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">df_clusters</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Clusters</th>
      <th>TARGET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compute population count per cluster for general population (-1) and customers (1)</span>
<span class="n">target_group</span> <span class="o">=</span> <span class="n">df_clusters</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)[</span><span class="s2">&quot;Clusters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># Calculate percentages per cluster per population</span>
<span class="n">target_group</span><span class="p">[</span><span class="s1">&#39;Perc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)[</span><span class="s1">&#39;Counts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">target_group</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TARGET</th>
      <th>Clusters</th>
      <th>Counts</th>
      <th>Perc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1</td>
      <td>6</td>
      <td>55418</td>
      <td>18.47</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1</td>
      <td>3</td>
      <td>51266</td>
      <td>17.09</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1</td>
      <td>4</td>
      <td>47796</td>
      <td>15.93</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1</td>
      <td>0</td>
      <td>38008</td>
      <td>12.67</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1</td>
      <td>2</td>
      <td>31227</td>
      <td>10.41</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1</td>
      <td>7</td>
      <td>30985</td>
      <td>10.33</td>
    </tr>
    <tr>
      <th>6</th>
      <td>-1</td>
      <td>1</td>
      <td>27521</td>
      <td>9.17</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-1</td>
      <td>5</td>
      <td>17779</td>
      <td>5.93</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>1</td>
      <td>36628</td>
      <td>24.42</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>5</td>
      <td>33125</td>
      <td>22.08</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>2</td>
      <td>29823</td>
      <td>19.88</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1</td>
      <td>0</td>
      <td>24214</td>
      <td>16.14</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1</td>
      <td>4</td>
      <td>15759</td>
      <td>10.51</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>6</td>
      <td>4527</td>
      <td>3.02</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>7</td>
      <td>4003</td>
      <td>2.67</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>3</td>
      <td>1921</td>
      <td>1.28</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot population per cluster for `AZDIAS` and `CUSTOMERS`</span>
<span class="n">popul_clust_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}pop_cluster_bars_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">totals</span> <span class="o">=</span> <span class="n">target_group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;TARGET&quot;</span><span class="p">)[</span><span class="s1">&#39;Counts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Clusters&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Perc&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;TARGET&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">target_group</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Blues_d&#39;</span><span class="p">)</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;General&#39;</span><span class="p">,</span> <span class="s1">&#39;Customers&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Population&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Population portion per cluster&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Population percentage (%)&#39;</span><span class="p">)</span>
    <span class="c1"># add percentage annotations on top of bars</span>
    <span class="k">for</span> <span class="n">tot</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">totals</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">):</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span> <span class="k">for</span> <span class="n">rect</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rect</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">rect</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.01</span><span class="p">,</span>
                    <span class="n">label</span><span class="p">,</span>
                    <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
                    <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;semibold&quot;</span>
            <span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">popul_clust_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create plotting data combining PCA results with K-Means clustering</span>
<span class="n">pcadf</span> <span class="o">=</span> <span class="n">train_reduced</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Predicted_cluster</span><span class="o">=</span><span class="n">clusterer</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">Population</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
<span class="n">pcadf</span><span class="p">[</span><span class="s2">&quot;Population&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pcadf</span><span class="p">[</span><span class="s2">&quot;Population&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;General&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Customers&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">popul_clust_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}cluster_results_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">scatr</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;PC2&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">pcadf</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Predicted_cluster&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Population&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,)</span>
    <span class="n">scatr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Clustering results from demographics data&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">borderaxespad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">popul_clust_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Clusters centroid locations on PCA space</span>
<span class="n">cluster_centroids</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clusterer</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">pca_list</span><span class="p">)</span>
<span class="n">cluster_centroids</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CJT_TYP_2/FINANZ_SPARER</th>
      <th>FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER</th>
      <th>OST_WEST_KZ_W/STRUKTURTYP</th>
      <th>HH_EINKOMMEN_SCORE/OST_WEST_KZ_O</th>
      <th>ANREDE_KZ/SEMIO_KAEM</th>
      <th>KBA13_BAUMAX/LP_FAMILIE_FEIN</th>
      <th>OST_WEST_KZ_O/KBA13_KW_61_120</th>
      <th>PLZ8_ANTG4/KBA13_ANTG4</th>
      <th>KBA13_CCM_3001/KBA13_CCM_2501</th>
      <th>KBA05_MAXSEG/KBA05_MOTOR</th>
      <th>KBA13_ANTG4/PLZ8_ANTG4</th>
      <th>KBA05_MAXBJ/SHOPPER_TYP</th>
      <th>VERS_TYP/HEALTH_TYP</th>
      <th>KBA05_MOD8/KBA05_SEG9</th>
      <th>LP_FAMILIE_FEIN/LP_LEBENSPHASE_FEIN</th>
      <th>KBA05_KW3/KBA05_CCM4</th>
      <th>KBA13_ALTERHALTER_45/KBA13_HALTER_35</th>
      <th>KBA13_VORB_1_2/KBA13_ALTERHALTER_61</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>KBA13_KRSZUL_NEU/KBA05_MOD8</th>
      <th>KBA05_ANHANG/KBA05_ANTG3</th>
      <th>KBA05_ANHANG/KBA05_BAUMAX</th>
      <th>SHOPPER_TYP/KBA05_ANTG1</th>
      <th>SHOPPER_TYP/KBA13_KRSSEG_VAN</th>
      <th>KBA05_ANHANG/KBA05_MOTRAD</th>
      <th>KBA05_MOTRAD/BALLRAUM</th>
      <th>VHN/D19_SOZIALES</th>
      <th>PLZ8_ANTG4/KBA05_ANHANG</th>
      <th>PLZ8_ANTG4/KBA05_ANTG3</th>
      <th>SHOPPER_TYP/KBA13_ANTG4</th>
      <th>PLZ8_ANTG4/KBA13_KRSSEG_VAN</th>
      <th>D19_LETZTER_KAUF_BRANCHE_D19_UNBEKANNT/D19_KONSUMTYP</th>
      <th>KBA05_ANHANG/KBA05_SEG7</th>
      <th>KBA05_MOTRAD/KBA05_ANTG3</th>
      <th>KBA05_MOTRAD/AGER_TYP</th>
      <th>VHN/KBA05_MOTRAD</th>
      <th>AGER_TYP/KBA05_ZUL2</th>
      <th>KBA05_SEG8/KBA05_SEG7</th>
      <th>KBA05_SEG7/AGER_TYP</th>
      <th>...</th>
      <th>D19_BANKEN_DIREKT/D19_REISEN</th>
      <th>D19_REISEN/KBA13_CCM_1500</th>
      <th>D19_HAUS_DEKO/D19_BEKLEIDUNG_REST</th>
      <th>D19_BEKLEIDUNG_REST/D19_BANKEN_DIREKT</th>
      <th>KBA13_KW_70/KBA05_ANTG2</th>
      <th>D19_BEKLEIDUNG_REST/D19_HAUS_DEKO</th>
      <th>D19_VERSAND_REST/D19_BEKLEIDUNG_REST</th>
      <th>KBA05_MOD1/KBA05_SEG10</th>
      <th>KK_KUNDENTYP/D19_VERSAND_ANZ_24</th>
      <th>KBA05_ANTG2/D19_VOLLSORTIMENT</th>
      <th>KBA05_SEG9/D19_TECHNIK</th>
      <th>KBA05_ALTER2/D19_VERSAND_ANZ_12</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_12</th>
      <th>KBA05_SEG9/KBA05_ALTER3</th>
      <th>D19_VOLLSORTIMENT/KBA05_HERST5</th>
      <th>KBA05_MOD8/D19_REISEN</th>
      <th>D19_BUCH_CD/KBA05_KW3</th>
      <th>D19_BUCH_CD/KBA05_MOD8</th>
      <th>D19_BUCH_CD/KBA05_KRSVAN</th>
      <th>D19_VOLLSORTIMENT/D19_GESAMT_ONLINE_QUOTE_12</th>
      <th>RELAT_AB/KBA05_KW3</th>
      <th>D19_SONSTIGE/EXTSEL992</th>
      <th>KBA05_CCM4/D19_SONSTIGE</th>
      <th>KBA05_DIESEL/UMFELD_JUNG</th>
      <th>KBA05_DIESEL/RT_UEBERGROESSE</th>
      <th>KBA13_VORB_2/KBA13_VORB_1_2</th>
      <th>GFK_URLAUBERTYP/KBA05_KRSVAN</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_24</th>
      <th>KBA05_SEG5/KBA13_SEG_OBERKLASSE</th>
      <th>KBA05_BAUMAX/UMFELD_ALT</th>
      <th>KBA13_KW_90/KBA13_CCM_3001</th>
      <th>KBA05_DIESEL/KBA05_HERST4</th>
      <th>KBA13_SEG_OBERKLASSE/KBA13_KRSZUL_NEU</th>
      <th>KBA05_MOD4/KBA05_SEG5</th>
      <th>KBA13_BJ_2008/RETOURTYP_BK_S</th>
      <th>KBA05_VORB2/EXTSEL992</th>
      <th>KBA05_HERST4/KBA05_FRAU</th>
      <th>D19_VERSAND_ONLINE_QUOTE_12/KBA05_KRSVAN</th>
      <th>GFK_URLAUBERTYP/D19_VERSAND_ONLINE_QUOTE_12</th>
      <th>KK_KUNDENTYP/D19_GESAMT_ANZ_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.203329</td>
      <td>-0.223992</td>
      <td>-0.743978</td>
      <td>-0.358931</td>
      <td>-0.215974</td>
      <td>-0.670338</td>
      <td>0.027057</td>
      <td>0.045513</td>
      <td>-0.050277</td>
      <td>-0.068199</td>
      <td>0.149190</td>
      <td>0.059806</td>
      <td>0.010193</td>
      <td>0.049111</td>
      <td>-0.018365</td>
      <td>-0.017170</td>
      <td>0.039205</td>
      <td>-0.010736</td>
      <td>-0.015513</td>
      <td>-0.012801</td>
      <td>-0.000073</td>
      <td>-0.004348</td>
      <td>-0.038466</td>
      <td>0.002093</td>
      <td>-0.035603</td>
      <td>0.029497</td>
      <td>0.003356</td>
      <td>-0.010572</td>
      <td>-0.002776</td>
      <td>0.007718</td>
      <td>0.030059</td>
      <td>0.000504</td>
      <td>0.040567</td>
      <td>-0.015568</td>
      <td>-0.025967</td>
      <td>0.014422</td>
      <td>-0.024002</td>
      <td>0.004746</td>
      <td>-0.000651</td>
      <td>0.002267</td>
      <td>...</td>
      <td>0.012147</td>
      <td>-0.006764</td>
      <td>-0.007272</td>
      <td>-0.015309</td>
      <td>-0.001701</td>
      <td>0.000734</td>
      <td>-0.015052</td>
      <td>-0.017821</td>
      <td>-0.004639</td>
      <td>-0.000819</td>
      <td>-0.010061</td>
      <td>-0.008805</td>
      <td>0.019471</td>
      <td>-0.014947</td>
      <td>-0.010884</td>
      <td>0.010046</td>
      <td>0.002587</td>
      <td>-0.004962</td>
      <td>0.011280</td>
      <td>0.001355</td>
      <td>-0.003376</td>
      <td>-0.002830</td>
      <td>-0.000733</td>
      <td>0.022321</td>
      <td>-0.007416</td>
      <td>-0.015653</td>
      <td>0.010489</td>
      <td>-0.017771</td>
      <td>-0.001920</td>
      <td>-0.019528</td>
      <td>-0.006500</td>
      <td>-0.010605</td>
      <td>0.006411</td>
      <td>-0.009840</td>
      <td>-0.013895</td>
      <td>0.006126</td>
      <td>-0.005134</td>
      <td>0.009664</td>
      <td>0.004420</td>
      <td>0.002309</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.189757</td>
      <td>0.597621</td>
      <td>-0.734094</td>
      <td>-1.377590</td>
      <td>0.097498</td>
      <td>0.876267</td>
      <td>-0.297897</td>
      <td>-0.068185</td>
      <td>-0.199166</td>
      <td>-0.053083</td>
      <td>-0.298689</td>
      <td>-0.049058</td>
      <td>0.019444</td>
      <td>-0.050699</td>
      <td>-0.014909</td>
      <td>-0.057886</td>
      <td>0.039705</td>
      <td>-0.005297</td>
      <td>0.032628</td>
      <td>0.018790</td>
      <td>0.027643</td>
      <td>-0.017474</td>
      <td>-0.004252</td>
      <td>-0.011265</td>
      <td>0.016628</td>
      <td>-0.047244</td>
      <td>0.017252</td>
      <td>0.018758</td>
      <td>-0.035465</td>
      <td>0.008850</td>
      <td>-0.010114</td>
      <td>0.009972</td>
      <td>-0.002060</td>
      <td>0.031978</td>
      <td>-0.014015</td>
      <td>0.023253</td>
      <td>-0.029281</td>
      <td>0.003445</td>
      <td>0.002080</td>
      <td>0.012119</td>
      <td>...</td>
      <td>-0.006814</td>
      <td>0.006297</td>
      <td>0.004343</td>
      <td>0.001312</td>
      <td>-0.016860</td>
      <td>0.003112</td>
      <td>0.003790</td>
      <td>0.000480</td>
      <td>0.013166</td>
      <td>0.011383</td>
      <td>0.007280</td>
      <td>-0.010061</td>
      <td>-0.009563</td>
      <td>-0.001066</td>
      <td>0.000470</td>
      <td>-0.000179</td>
      <td>0.005277</td>
      <td>0.000953</td>
      <td>0.002640</td>
      <td>-0.000785</td>
      <td>0.006743</td>
      <td>0.008656</td>
      <td>-0.000214</td>
      <td>-0.008452</td>
      <td>0.016615</td>
      <td>0.004329</td>
      <td>0.005615</td>
      <td>-0.004625</td>
      <td>0.007773</td>
      <td>-0.008486</td>
      <td>0.001407</td>
      <td>0.011943</td>
      <td>-0.003393</td>
      <td>0.023931</td>
      <td>0.017953</td>
      <td>-0.010767</td>
      <td>0.018076</td>
      <td>0.001721</td>
      <td>0.004933</td>
      <td>-0.026375</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.543665</td>
      <td>0.865122</td>
      <td>0.069302</td>
      <td>0.639530</td>
      <td>0.278657</td>
      <td>0.131343</td>
      <td>-0.315198</td>
      <td>0.126088</td>
      <td>-0.006557</td>
      <td>-0.094476</td>
      <td>-0.007997</td>
      <td>-0.027546</td>
      <td>0.058509</td>
      <td>0.107610</td>
      <td>0.066454</td>
      <td>0.002132</td>
      <td>-0.009539</td>
      <td>-0.022984</td>
      <td>0.093150</td>
      <td>0.070689</td>
      <td>0.012023</td>
      <td>0.005554</td>
      <td>0.018877</td>
      <td>-0.038802</td>
      <td>-0.000952</td>
      <td>-0.034635</td>
      <td>0.042623</td>
      <td>0.012724</td>
      <td>-0.022934</td>
      <td>0.005105</td>
      <td>-0.016162</td>
      <td>-0.005665</td>
      <td>-0.022061</td>
      <td>0.020415</td>
      <td>-0.016118</td>
      <td>0.001692</td>
      <td>0.007787</td>
      <td>-0.007930</td>
      <td>0.001820</td>
      <td>-0.002093</td>
      <td>...</td>
      <td>-0.001516</td>
      <td>-0.002141</td>
      <td>-0.000380</td>
      <td>0.017295</td>
      <td>-0.014654</td>
      <td>-0.006622</td>
      <td>0.002162</td>
      <td>-0.001878</td>
      <td>0.018022</td>
      <td>0.016565</td>
      <td>0.009550</td>
      <td>-0.008625</td>
      <td>-0.009203</td>
      <td>-0.007255</td>
      <td>0.006330</td>
      <td>0.009126</td>
      <td>-0.005499</td>
      <td>-0.010491</td>
      <td>0.003310</td>
      <td>-0.016809</td>
      <td>0.008243</td>
      <td>0.002445</td>
      <td>0.020301</td>
      <td>0.001632</td>
      <td>0.006899</td>
      <td>-0.004566</td>
      <td>0.001397</td>
      <td>0.005374</td>
      <td>-0.003155</td>
      <td>0.017807</td>
      <td>0.008674</td>
      <td>0.001151</td>
      <td>-0.004938</td>
      <td>0.000438</td>
      <td>-0.014015</td>
      <td>-0.005141</td>
      <td>-0.007483</td>
      <td>0.005775</td>
      <td>0.010885</td>
      <td>0.001282</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.071815</td>
      <td>-0.155733</td>
      <td>0.834181</td>
      <td>0.476433</td>
      <td>-0.177871</td>
      <td>-0.317296</td>
      <td>0.019073</td>
      <td>0.046619</td>
      <td>-0.026845</td>
      <td>0.022611</td>
      <td>0.060064</td>
      <td>0.114290</td>
      <td>-0.105528</td>
      <td>-0.003786</td>
      <td>0.016345</td>
      <td>-0.059173</td>
      <td>0.009870</td>
      <td>-0.009190</td>
      <td>-0.050169</td>
      <td>-0.055538</td>
      <td>-0.019654</td>
      <td>-0.032503</td>
      <td>-0.075851</td>
      <td>0.067993</td>
      <td>0.004569</td>
      <td>0.081958</td>
      <td>-0.049710</td>
      <td>-0.016253</td>
      <td>0.041038</td>
      <td>-0.000519</td>
      <td>0.020002</td>
      <td>-0.040254</td>
      <td>0.000431</td>
      <td>-0.039105</td>
      <td>0.009800</td>
      <td>-0.018743</td>
      <td>-0.022681</td>
      <td>-0.004096</td>
      <td>-0.002684</td>
      <td>-0.008828</td>
      <td>...</td>
      <td>0.011081</td>
      <td>0.001855</td>
      <td>-0.010888</td>
      <td>-0.001604</td>
      <td>0.008896</td>
      <td>-0.005247</td>
      <td>-0.016757</td>
      <td>0.001909</td>
      <td>0.001327</td>
      <td>-0.005987</td>
      <td>-0.006772</td>
      <td>-0.016502</td>
      <td>0.012524</td>
      <td>0.002153</td>
      <td>-0.009752</td>
      <td>0.013938</td>
      <td>-0.005096</td>
      <td>-0.010907</td>
      <td>0.003215</td>
      <td>-0.001776</td>
      <td>-0.006953</td>
      <td>0.008059</td>
      <td>-0.005785</td>
      <td>0.026969</td>
      <td>-0.016062</td>
      <td>-0.008047</td>
      <td>-0.002058</td>
      <td>-0.010984</td>
      <td>-0.009587</td>
      <td>0.016956</td>
      <td>-0.007382</td>
      <td>-0.011393</td>
      <td>0.020234</td>
      <td>-0.009559</td>
      <td>-0.018920</td>
      <td>0.014452</td>
      <td>-0.026139</td>
      <td>0.036937</td>
      <td>0.004260</td>
      <td>-0.001923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.383392</td>
      <td>-1.583445</td>
      <td>0.045390</td>
      <td>0.237026</td>
      <td>0.166570</td>
      <td>-0.333962</td>
      <td>-0.279711</td>
      <td>0.041165</td>
      <td>0.023101</td>
      <td>-0.079983</td>
      <td>-0.071007</td>
      <td>-0.002118</td>
      <td>0.100736</td>
      <td>0.046703</td>
      <td>0.030631</td>
      <td>-0.017294</td>
      <td>-0.011982</td>
      <td>0.006506</td>
      <td>0.075630</td>
      <td>0.060280</td>
      <td>-0.009435</td>
      <td>0.041408</td>
      <td>0.088005</td>
      <td>-0.064816</td>
      <td>0.007708</td>
      <td>-0.039396</td>
      <td>0.026463</td>
      <td>0.003002</td>
      <td>-0.013578</td>
      <td>-0.007715</td>
      <td>-0.038570</td>
      <td>0.008869</td>
      <td>-0.026156</td>
      <td>0.036357</td>
      <td>-0.014320</td>
      <td>0.002437</td>
      <td>0.025971</td>
      <td>-0.015670</td>
      <td>0.000746</td>
      <td>-0.007495</td>
      <td>...</td>
      <td>-0.012677</td>
      <td>0.003486</td>
      <td>0.009415</td>
      <td>-0.001844</td>
      <td>0.000302</td>
      <td>0.004370</td>
      <td>0.017891</td>
      <td>-0.007643</td>
      <td>0.001666</td>
      <td>0.003844</td>
      <td>0.005788</td>
      <td>-0.000856</td>
      <td>0.009435</td>
      <td>0.011510</td>
      <td>0.025418</td>
      <td>-0.019478</td>
      <td>0.003128</td>
      <td>0.025867</td>
      <td>0.004695</td>
      <td>0.002093</td>
      <td>0.012676</td>
      <td>-0.009338</td>
      <td>0.014635</td>
      <td>-0.027723</td>
      <td>0.004416</td>
      <td>0.004574</td>
      <td>0.000167</td>
      <td>0.020463</td>
      <td>0.001843</td>
      <td>-0.004559</td>
      <td>0.003456</td>
      <td>0.004103</td>
      <td>-0.013973</td>
      <td>0.000054</td>
      <td>0.009592</td>
      <td>-0.003104</td>
      <td>0.026791</td>
      <td>-0.019342</td>
      <td>-0.006984</td>
      <td>0.011899</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1.607038</td>
      <td>-0.772047</td>
      <td>1.001595</td>
      <td>-0.454125</td>
      <td>-0.083941</td>
      <td>0.376086</td>
      <td>0.209281</td>
      <td>-0.092562</td>
      <td>-0.025321</td>
      <td>0.136563</td>
      <td>-0.020303</td>
      <td>-0.079387</td>
      <td>-0.088281</td>
      <td>-0.100529</td>
      <td>-0.029477</td>
      <td>0.096597</td>
      <td>-0.015817</td>
      <td>-0.012033</td>
      <td>-0.079284</td>
      <td>-0.062103</td>
      <td>0.019498</td>
      <td>0.021582</td>
      <td>-0.013966</td>
      <td>-0.012060</td>
      <td>0.029826</td>
      <td>-0.000923</td>
      <td>-0.049778</td>
      <td>-0.032860</td>
      <td>0.035909</td>
      <td>-0.007440</td>
      <td>0.021073</td>
      <td>0.000576</td>
      <td>-0.036172</td>
      <td>-0.001540</td>
      <td>0.031169</td>
      <td>-0.004095</td>
      <td>-0.002573</td>
      <td>-0.006358</td>
      <td>-0.004733</td>
      <td>-0.010137</td>
      <td>...</td>
      <td>-0.014414</td>
      <td>0.023307</td>
      <td>0.006260</td>
      <td>-0.001052</td>
      <td>0.016425</td>
      <td>0.005924</td>
      <td>0.003374</td>
      <td>0.027679</td>
      <td>-0.007631</td>
      <td>-0.015257</td>
      <td>0.005794</td>
      <td>0.013913</td>
      <td>-0.020306</td>
      <td>0.008545</td>
      <td>-0.000377</td>
      <td>-0.008332</td>
      <td>0.001839</td>
      <td>0.001901</td>
      <td>-0.016482</td>
      <td>0.001070</td>
      <td>-0.007092</td>
      <td>0.007975</td>
      <td>-0.014949</td>
      <td>0.000185</td>
      <td>0.002291</td>
      <td>0.011256</td>
      <td>0.002081</td>
      <td>0.001304</td>
      <td>0.001137</td>
      <td>0.019076</td>
      <td>-0.001702</td>
      <td>0.003213</td>
      <td>0.004473</td>
      <td>0.005102</td>
      <td>0.006014</td>
      <td>-0.000728</td>
      <td>-0.001237</td>
      <td>0.007103</td>
      <td>0.001534</td>
      <td>-0.013189</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.356377</td>
      <td>1.419541</td>
      <td>0.656143</td>
      <td>0.187513</td>
      <td>-0.183262</td>
      <td>-0.411397</td>
      <td>0.211959</td>
      <td>-0.116999</td>
      <td>0.046620</td>
      <td>0.022663</td>
      <td>0.073723</td>
      <td>0.107387</td>
      <td>-0.017441</td>
      <td>-0.046547</td>
      <td>-0.072299</td>
      <td>-0.027761</td>
      <td>-0.036820</td>
      <td>0.017779</td>
      <td>-0.036726</td>
      <td>-0.036720</td>
      <td>-0.023301</td>
      <td>-0.012562</td>
      <td>0.002959</td>
      <td>0.052055</td>
      <td>-0.005372</td>
      <td>0.026846</td>
      <td>-0.006625</td>
      <td>0.021713</td>
      <td>0.007520</td>
      <td>-0.009137</td>
      <td>-0.001551</td>
      <td>0.007817</td>
      <td>0.045002</td>
      <td>-0.027059</td>
      <td>0.016073</td>
      <td>-0.010376</td>
      <td>0.016260</td>
      <td>0.018186</td>
      <td>-0.009968</td>
      <td>0.009241</td>
      <td>...</td>
      <td>0.004681</td>
      <td>-0.014665</td>
      <td>0.002061</td>
      <td>0.004650</td>
      <td>0.000720</td>
      <td>-0.008986</td>
      <td>-0.001800</td>
      <td>-0.004639</td>
      <td>-0.013885</td>
      <td>-0.007760</td>
      <td>-0.003791</td>
      <td>0.013050</td>
      <td>0.015975</td>
      <td>-0.003688</td>
      <td>0.003260</td>
      <td>-0.008653</td>
      <td>0.003287</td>
      <td>0.015633</td>
      <td>0.001504</td>
      <td>0.001718</td>
      <td>-0.002294</td>
      <td>-0.008893</td>
      <td>-0.001871</td>
      <td>-0.017582</td>
      <td>-0.008499</td>
      <td>-0.002285</td>
      <td>0.007688</td>
      <td>0.005121</td>
      <td>-0.000743</td>
      <td>-0.018593</td>
      <td>-0.004291</td>
      <td>-0.003616</td>
      <td>-0.001385</td>
      <td>-0.017832</td>
      <td>0.007758</td>
      <td>0.007508</td>
      <td>0.010655</td>
      <td>-0.034398</td>
      <td>-0.014357</td>
      <td>0.021575</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.499745</td>
      <td>-0.331242</td>
      <td>-1.415351</td>
      <td>1.212553</td>
      <td>0.126358</td>
      <td>0.574479</td>
      <td>0.860138</td>
      <td>0.023800</td>
      <td>0.430271</td>
      <td>0.258688</td>
      <td>0.237820</td>
      <td>-0.210620</td>
      <td>-0.001895</td>
      <td>-0.022048</td>
      <td>0.012727</td>
      <td>0.158163</td>
      <td>-0.038242</td>
      <td>0.071895</td>
      <td>-0.066783</td>
      <td>-0.000243</td>
      <td>-0.013030</td>
      <td>-0.010907</td>
      <td>0.024794</td>
      <td>0.032245</td>
      <td>-0.011475</td>
      <td>0.005190</td>
      <td>-0.009434</td>
      <td>-0.006140</td>
      <td>-0.012387</td>
      <td>-0.002516</td>
      <td>-0.000688</td>
      <td>0.010824</td>
      <td>-0.015590</td>
      <td>-0.024089</td>
      <td>0.022528</td>
      <td>-0.021848</td>
      <td>0.036835</td>
      <td>0.009844</td>
      <td>0.016655</td>
      <td>-0.001682</td>
      <td>...</td>
      <td>0.006454</td>
      <td>-0.011276</td>
      <td>-0.011746</td>
      <td>0.000214</td>
      <td>0.009906</td>
      <td>0.004468</td>
      <td>0.008192</td>
      <td>0.013086</td>
      <td>-0.018237</td>
      <td>-0.007702</td>
      <td>-0.018482</td>
      <td>0.040959</td>
      <td>-0.035576</td>
      <td>0.009252</td>
      <td>-0.030392</td>
      <td>0.011468</td>
      <td>-0.020099</td>
      <td>-0.031462</td>
      <td>-0.020549</td>
      <td>0.008231</td>
      <td>-0.017160</td>
      <td>-0.015488</td>
      <td>-0.007786</td>
      <td>0.010213</td>
      <td>0.007401</td>
      <td>0.023361</td>
      <td>-0.040144</td>
      <td>0.005142</td>
      <td>0.005635</td>
      <td>0.003293</td>
      <td>0.013838</td>
      <td>0.005747</td>
      <td>-0.001707</td>
      <td>0.011066</td>
      <td>0.012436</td>
      <td>-0.007342</td>
      <td>-0.032992</td>
      <td>-0.007761</td>
      <td>-0.005308</td>
      <td>0.006786</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 104 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">centroid_heatmp_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}centroids_heatmap_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="c1"># Plot a heatmap with centroid coordinates of the top 20 most important PCs</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">20</span><span class="p">,</span> <span class="p">:],</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Cluster&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Attribute Value by Centroid&quot;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">centroid_heatmp_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># map the cluster labels back to each individual person from the population data</span>
<span class="n">population_transformed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">population_transformed</span><span class="p">,</span> <span class="n">df_clusters</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Add the LNR attribute to be able to associate with original data</span>
<span class="n">population_transformed</span> <span class="o">=</span> <span class="n">population_transformed</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">LNR</span><span class="o">=</span><span class="n">clientIDs</span><span class="p">)</span>
<span class="n">population_transformed</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CJT_TYP_2/FINANZ_SPARER</th>
      <th>FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER</th>
      <th>OST_WEST_KZ_W/STRUKTURTYP</th>
      <th>HH_EINKOMMEN_SCORE/OST_WEST_KZ_O</th>
      <th>ANREDE_KZ/SEMIO_KAEM</th>
      <th>KBA13_BAUMAX/LP_FAMILIE_FEIN</th>
      <th>OST_WEST_KZ_O/KBA13_KW_61_120</th>
      <th>PLZ8_ANTG4/KBA13_ANTG4</th>
      <th>KBA13_CCM_3001/KBA13_CCM_2501</th>
      <th>KBA05_MAXSEG/KBA05_MOTOR</th>
      <th>KBA13_ANTG4/PLZ8_ANTG4</th>
      <th>KBA05_MAXBJ/SHOPPER_TYP</th>
      <th>VERS_TYP/HEALTH_TYP</th>
      <th>KBA05_MOD8/KBA05_SEG9</th>
      <th>LP_FAMILIE_FEIN/LP_LEBENSPHASE_FEIN</th>
      <th>KBA05_KW3/KBA05_CCM4</th>
      <th>KBA13_ALTERHALTER_45/KBA13_HALTER_35</th>
      <th>KBA13_VORB_1_2/KBA13_ALTERHALTER_61</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>KBA13_KRSZUL_NEU/KBA05_MOD8</th>
      <th>KBA05_ANHANG/KBA05_ANTG3</th>
      <th>KBA05_ANHANG/KBA05_BAUMAX</th>
      <th>SHOPPER_TYP/KBA05_ANTG1</th>
      <th>SHOPPER_TYP/KBA13_KRSSEG_VAN</th>
      <th>KBA05_ANHANG/KBA05_MOTRAD</th>
      <th>KBA05_MOTRAD/BALLRAUM</th>
      <th>VHN/D19_SOZIALES</th>
      <th>PLZ8_ANTG4/KBA05_ANHANG</th>
      <th>PLZ8_ANTG4/KBA05_ANTG3</th>
      <th>SHOPPER_TYP/KBA13_ANTG4</th>
      <th>PLZ8_ANTG4/KBA13_KRSSEG_VAN</th>
      <th>D19_LETZTER_KAUF_BRANCHE_D19_UNBEKANNT/D19_KONSUMTYP</th>
      <th>KBA05_ANHANG/KBA05_SEG7</th>
      <th>KBA05_MOTRAD/KBA05_ANTG3</th>
      <th>KBA05_MOTRAD/AGER_TYP</th>
      <th>VHN/KBA05_MOTRAD</th>
      <th>AGER_TYP/KBA05_ZUL2</th>
      <th>KBA05_SEG8/KBA05_SEG7</th>
      <th>KBA05_SEG7/AGER_TYP</th>
      <th>...</th>
      <th>D19_BEKLEIDUNG_REST/D19_BANKEN_DIREKT</th>
      <th>KBA13_KW_70/KBA05_ANTG2</th>
      <th>D19_BEKLEIDUNG_REST/D19_HAUS_DEKO</th>
      <th>D19_VERSAND_REST/D19_BEKLEIDUNG_REST</th>
      <th>KBA05_MOD1/KBA05_SEG10</th>
      <th>KK_KUNDENTYP/D19_VERSAND_ANZ_24</th>
      <th>KBA05_ANTG2/D19_VOLLSORTIMENT</th>
      <th>KBA05_SEG9/D19_TECHNIK</th>
      <th>KBA05_ALTER2/D19_VERSAND_ANZ_12</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_12</th>
      <th>KBA05_SEG9/KBA05_ALTER3</th>
      <th>D19_VOLLSORTIMENT/KBA05_HERST5</th>
      <th>KBA05_MOD8/D19_REISEN</th>
      <th>D19_BUCH_CD/KBA05_KW3</th>
      <th>D19_BUCH_CD/KBA05_MOD8</th>
      <th>D19_BUCH_CD/KBA05_KRSVAN</th>
      <th>D19_VOLLSORTIMENT/D19_GESAMT_ONLINE_QUOTE_12</th>
      <th>RELAT_AB/KBA05_KW3</th>
      <th>D19_SONSTIGE/EXTSEL992</th>
      <th>KBA05_CCM4/D19_SONSTIGE</th>
      <th>KBA05_DIESEL/UMFELD_JUNG</th>
      <th>KBA05_DIESEL/RT_UEBERGROESSE</th>
      <th>KBA13_VORB_2/KBA13_VORB_1_2</th>
      <th>GFK_URLAUBERTYP/KBA05_KRSVAN</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_24</th>
      <th>KBA05_SEG5/KBA13_SEG_OBERKLASSE</th>
      <th>KBA05_BAUMAX/UMFELD_ALT</th>
      <th>KBA13_KW_90/KBA13_CCM_3001</th>
      <th>KBA05_DIESEL/KBA05_HERST4</th>
      <th>KBA13_SEG_OBERKLASSE/KBA13_KRSZUL_NEU</th>
      <th>KBA05_MOD4/KBA05_SEG5</th>
      <th>KBA13_BJ_2008/RETOURTYP_BK_S</th>
      <th>KBA05_VORB2/EXTSEL992</th>
      <th>KBA05_HERST4/KBA05_FRAU</th>
      <th>D19_VERSAND_ONLINE_QUOTE_12/KBA05_KRSVAN</th>
      <th>GFK_URLAUBERTYP/D19_VERSAND_ONLINE_QUOTE_12</th>
      <th>KK_KUNDENTYP/D19_GESAMT_ANZ_12</th>
      <th>Clusters</th>
      <th>TARGET</th>
      <th>LNR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.234629</td>
      <td>-0.867582</td>
      <td>-0.578983</td>
      <td>-0.220230</td>
      <td>-0.742176</td>
      <td>0.211376</td>
      <td>-0.222328</td>
      <td>0.117435</td>
      <td>0.625594</td>
      <td>-0.276393</td>
      <td>0.209671</td>
      <td>1.080525</td>
      <td>0.073092</td>
      <td>-0.005344</td>
      <td>-0.725521</td>
      <td>0.534920</td>
      <td>-0.816195</td>
      <td>0.000018</td>
      <td>-0.548220</td>
      <td>-0.422507</td>
      <td>0.358123</td>
      <td>0.910408</td>
      <td>-0.577757</td>
      <td>-0.334013</td>
      <td>-0.317721</td>
      <td>-0.865876</td>
      <td>-0.034087</td>
      <td>0.055927</td>
      <td>0.069684</td>
      <td>0.000181</td>
      <td>0.192486</td>
      <td>0.326819</td>
      <td>-0.207724</td>
      <td>0.509368</td>
      <td>-0.385418</td>
      <td>0.339499</td>
      <td>0.397615</td>
      <td>0.350358</td>
      <td>-0.024274</td>
      <td>0.040678</td>
      <td>...</td>
      <td>0.491691</td>
      <td>0.887629</td>
      <td>0.179989</td>
      <td>0.231284</td>
      <td>0.223842</td>
      <td>0.026079</td>
      <td>-0.465061</td>
      <td>-0.227642</td>
      <td>-0.249795</td>
      <td>-0.011948</td>
      <td>0.248586</td>
      <td>-0.388448</td>
      <td>0.285329</td>
      <td>-0.139759</td>
      <td>-0.337783</td>
      <td>-0.083996</td>
      <td>-0.233873</td>
      <td>-0.179353</td>
      <td>-0.448052</td>
      <td>-0.513697</td>
      <td>-0.347848</td>
      <td>-0.781476</td>
      <td>0.001404</td>
      <td>-0.283709</td>
      <td>-0.331719</td>
      <td>0.221276</td>
      <td>-0.163244</td>
      <td>0.291595</td>
      <td>0.186463</td>
      <td>-0.005497</td>
      <td>-0.228021</td>
      <td>0.307563</td>
      <td>-0.713716</td>
      <td>0.401752</td>
      <td>0.477682</td>
      <td>-0.182475</td>
      <td>-0.062534</td>
      <td>0</td>
      <td>-1</td>
      <td>780657</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.977389</td>
      <td>0.134613</td>
      <td>0.048990</td>
      <td>-0.160303</td>
      <td>-0.804427</td>
      <td>-0.352177</td>
      <td>0.670749</td>
      <td>-1.172047</td>
      <td>-1.055501</td>
      <td>0.573792</td>
      <td>0.661885</td>
      <td>-1.608553</td>
      <td>0.358878</td>
      <td>0.913354</td>
      <td>-1.173424</td>
      <td>0.805668</td>
      <td>-0.148719</td>
      <td>0.882287</td>
      <td>0.335386</td>
      <td>0.451623</td>
      <td>0.064425</td>
      <td>1.197852</td>
      <td>-0.666765</td>
      <td>0.302235</td>
      <td>0.656651</td>
      <td>0.195785</td>
      <td>-0.440172</td>
      <td>0.129148</td>
      <td>-0.404084</td>
      <td>0.013804</td>
      <td>-0.379258</td>
      <td>0.256196</td>
      <td>-0.816625</td>
      <td>0.160029</td>
      <td>0.401891</td>
      <td>-0.057911</td>
      <td>0.288800</td>
      <td>0.054266</td>
      <td>0.203565</td>
      <td>-0.225481</td>
      <td>...</td>
      <td>0.597577</td>
      <td>0.099311</td>
      <td>0.298713</td>
      <td>0.140128</td>
      <td>0.083948</td>
      <td>-0.230444</td>
      <td>0.391376</td>
      <td>0.510545</td>
      <td>0.052131</td>
      <td>0.096806</td>
      <td>-0.743018</td>
      <td>0.162313</td>
      <td>-0.162888</td>
      <td>-0.008984</td>
      <td>0.063964</td>
      <td>-0.152078</td>
      <td>-0.096144</td>
      <td>-0.237473</td>
      <td>0.091904</td>
      <td>0.133245</td>
      <td>0.210970</td>
      <td>-0.439297</td>
      <td>0.643481</td>
      <td>0.427124</td>
      <td>0.061224</td>
      <td>0.371090</td>
      <td>-0.009132</td>
      <td>-0.335295</td>
      <td>-0.327904</td>
      <td>0.320068</td>
      <td>-0.003117</td>
      <td>-0.307557</td>
      <td>-0.310712</td>
      <td>-0.153566</td>
      <td>0.351870</td>
      <td>-0.000796</td>
      <td>0.130907</td>
      <td>6</td>
      <td>-1</td>
      <td>283232</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.640617</td>
      <td>0.397748</td>
      <td>0.081203</td>
      <td>-0.250016</td>
      <td>0.403747</td>
      <td>-1.531851</td>
      <td>-0.125694</td>
      <td>0.206615</td>
      <td>1.062772</td>
      <td>-0.607811</td>
      <td>-0.043918</td>
      <td>-0.782834</td>
      <td>0.357914</td>
      <td>0.292886</td>
      <td>-0.547790</td>
      <td>-0.100105</td>
      <td>-0.214742</td>
      <td>0.114630</td>
      <td>-0.347420</td>
      <td>-0.215213</td>
      <td>0.445487</td>
      <td>-0.195424</td>
      <td>-0.093167</td>
      <td>-0.405749</td>
      <td>0.601990</td>
      <td>-0.136346</td>
      <td>-0.291381</td>
      <td>0.456311</td>
      <td>-0.518213</td>
      <td>-0.715454</td>
      <td>-0.119906</td>
      <td>-0.011904</td>
      <td>-0.492868</td>
      <td>-0.152883</td>
      <td>-0.046090</td>
      <td>0.267519</td>
      <td>-0.506884</td>
      <td>-0.513384</td>
      <td>-0.453967</td>
      <td>0.361384</td>
      <td>...</td>
      <td>-0.159854</td>
      <td>-0.263444</td>
      <td>0.874286</td>
      <td>0.041411</td>
      <td>0.421441</td>
      <td>-0.227531</td>
      <td>-0.088987</td>
      <td>0.038793</td>
      <td>-0.179560</td>
      <td>-0.421240</td>
      <td>-0.329272</td>
      <td>0.088884</td>
      <td>0.130497</td>
      <td>0.239671</td>
      <td>0.161087</td>
      <td>0.131114</td>
      <td>-0.074357</td>
      <td>-0.439820</td>
      <td>-0.504712</td>
      <td>-0.170880</td>
      <td>-0.202946</td>
      <td>-0.042772</td>
      <td>0.007435</td>
      <td>0.203907</td>
      <td>-0.274071</td>
      <td>0.202893</td>
      <td>-0.240996</td>
      <td>-0.050707</td>
      <td>-0.097291</td>
      <td>-0.152809</td>
      <td>0.085488</td>
      <td>0.211906</td>
      <td>-0.143104</td>
      <td>0.328685</td>
      <td>-0.102155</td>
      <td>0.400096</td>
      <td>0.396859</td>
      <td>6</td>
      <td>-1</td>
      <td>728552</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.199834</td>
      <td>-0.007616</td>
      <td>1.126011</td>
      <td>-1.318851</td>
      <td>1.140490</td>
      <td>0.057711</td>
      <td>1.092936</td>
      <td>0.061931</td>
      <td>-0.510787</td>
      <td>0.248087</td>
      <td>1.407731</td>
      <td>-0.546964</td>
      <td>-1.101588</td>
      <td>0.236766</td>
      <td>0.230220</td>
      <td>-0.052759</td>
      <td>-0.764123</td>
      <td>-0.253049</td>
      <td>-0.406299</td>
      <td>-0.314603</td>
      <td>-0.711263</td>
      <td>0.080031</td>
      <td>-0.518777</td>
      <td>-0.530842</td>
      <td>-0.018792</td>
      <td>0.094442</td>
      <td>0.103434</td>
      <td>-0.471235</td>
      <td>-0.115663</td>
      <td>0.119208</td>
      <td>-0.258963</td>
      <td>-0.118394</td>
      <td>0.020771</td>
      <td>0.095762</td>
      <td>-0.096231</td>
      <td>0.039596</td>
      <td>0.050026</td>
      <td>-0.136419</td>
      <td>-0.129697</td>
      <td>0.468808</td>
      <td>...</td>
      <td>0.017804</td>
      <td>0.069867</td>
      <td>-0.359567</td>
      <td>0.394705</td>
      <td>-0.420672</td>
      <td>0.274572</td>
      <td>0.142926</td>
      <td>-0.218485</td>
      <td>0.258072</td>
      <td>0.359043</td>
      <td>0.245578</td>
      <td>-0.307132</td>
      <td>0.119405</td>
      <td>0.432255</td>
      <td>0.264530</td>
      <td>-0.079858</td>
      <td>0.020682</td>
      <td>0.426232</td>
      <td>-0.092529</td>
      <td>-0.215258</td>
      <td>0.162319</td>
      <td>0.053370</td>
      <td>0.113821</td>
      <td>0.497985</td>
      <td>-0.488428</td>
      <td>-0.038022</td>
      <td>0.106081</td>
      <td>0.070431</td>
      <td>-0.067926</td>
      <td>0.348257</td>
      <td>-0.685797</td>
      <td>0.230047</td>
      <td>-0.211343</td>
      <td>-0.124144</td>
      <td>0.192463</td>
      <td>0.117103</td>
      <td>-0.323287</td>
      <td>5</td>
      <td>-1</td>
      <td>390673</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.247861</td>
      <td>0.700665</td>
      <td>-0.974589</td>
      <td>-1.270208</td>
      <td>0.270992</td>
      <td>0.698793</td>
      <td>-0.026303</td>
      <td>-0.420971</td>
      <td>0.619710</td>
      <td>0.289441</td>
      <td>-0.748615</td>
      <td>0.083695</td>
      <td>-0.194543</td>
      <td>-0.113975</td>
      <td>-0.428714</td>
      <td>0.272176</td>
      <td>0.096895</td>
      <td>0.909333</td>
      <td>-0.025264</td>
      <td>-0.212352</td>
      <td>0.108476</td>
      <td>-0.112836</td>
      <td>-0.233279</td>
      <td>-0.201998</td>
      <td>-0.278923</td>
      <td>0.223151</td>
      <td>0.017902</td>
      <td>-0.011831</td>
      <td>-0.354386</td>
      <td>0.508833</td>
      <td>-0.120905</td>
      <td>-0.948406</td>
      <td>0.591599</td>
      <td>-0.442476</td>
      <td>0.251363</td>
      <td>0.397072</td>
      <td>0.023746</td>
      <td>-0.288343</td>
      <td>0.420796</td>
      <td>-0.082198</td>
      <td>...</td>
      <td>-0.095490</td>
      <td>-0.420967</td>
      <td>0.463086</td>
      <td>0.393737</td>
      <td>0.393154</td>
      <td>-0.283677</td>
      <td>-0.621931</td>
      <td>-0.360244</td>
      <td>-0.102992</td>
      <td>0.031882</td>
      <td>-0.106679</td>
      <td>0.716718</td>
      <td>0.197329</td>
      <td>-0.261676</td>
      <td>-0.326734</td>
      <td>-0.202511</td>
      <td>0.366927</td>
      <td>-0.062942</td>
      <td>0.176530</td>
      <td>0.060247</td>
      <td>-0.298104</td>
      <td>-0.551207</td>
      <td>0.373706</td>
      <td>-0.042755</td>
      <td>0.481701</td>
      <td>0.260109</td>
      <td>0.584887</td>
      <td>0.289511</td>
      <td>-0.167374</td>
      <td>0.010033</td>
      <td>0.462439</td>
      <td>-0.076547</td>
      <td>-0.282838</td>
      <td>-0.036585</td>
      <td>-0.392120</td>
      <td>-0.279264</td>
      <td>0.283381</td>
      <td>1</td>
      <td>1</td>
      <td>40377</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 107 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can examine which individuals are grouped together in the same cluster by looking at one of the clusters in more detail. If we take cluster 2 for example and look at the location of the centroid in the heatmap above, it tells us that it has the highest value for the attributes:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_centroids</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;CJT_TYP_2/FINANZ_SPARER&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In addition, we can check the individuals that fit that description:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cluster_2</span> <span class="o">=</span> <span class="n">population_transformed</span><span class="p">[</span><span class="n">population_transformed</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Individuals in cluster: &quot;</span><span class="p">,</span> <span class="n">cluster_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Individuals `Customers`: &quot;</span><span class="p">,</span> <span class="n">cluster_2</span><span class="p">[</span><span class="n">cluster_2</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Individuals `General`: &quot;</span><span class="p">,</span> <span class="n">cluster_2</span><span class="p">[</span><span class="n">cluster_2</span><span class="p">[</span><span class="s1">&#39;TARGET&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">cluster_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Individuals in cluster:  61050

Individuals `Customers`:  29823

Individuals `General`:  31227
------------------------------

</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CJT_TYP_2/FINANZ_SPARER</th>
      <th>FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER</th>
      <th>OST_WEST_KZ_W/STRUKTURTYP</th>
      <th>HH_EINKOMMEN_SCORE/OST_WEST_KZ_O</th>
      <th>ANREDE_KZ/SEMIO_KAEM</th>
      <th>KBA13_BAUMAX/LP_FAMILIE_FEIN</th>
      <th>OST_WEST_KZ_O/KBA13_KW_61_120</th>
      <th>PLZ8_ANTG4/KBA13_ANTG4</th>
      <th>KBA13_CCM_3001/KBA13_CCM_2501</th>
      <th>KBA05_MAXSEG/KBA05_MOTOR</th>
      <th>KBA13_ANTG4/PLZ8_ANTG4</th>
      <th>KBA05_MAXBJ/SHOPPER_TYP</th>
      <th>VERS_TYP/HEALTH_TYP</th>
      <th>KBA05_MOD8/KBA05_SEG9</th>
      <th>LP_FAMILIE_FEIN/LP_LEBENSPHASE_FEIN</th>
      <th>KBA05_KW3/KBA05_CCM4</th>
      <th>KBA13_ALTERHALTER_45/KBA13_HALTER_35</th>
      <th>KBA13_VORB_1_2/KBA13_ALTERHALTER_61</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>D19_GESAMT_ANZ_24/D19_VERSAND_ANZ_24</th>
      <th>KBA13_KRSZUL_NEU/KBA05_MOD8</th>
      <th>KBA05_ANHANG/KBA05_ANTG3</th>
      <th>KBA05_ANHANG/KBA05_BAUMAX</th>
      <th>SHOPPER_TYP/KBA05_ANTG1</th>
      <th>SHOPPER_TYP/KBA13_KRSSEG_VAN</th>
      <th>KBA05_ANHANG/KBA05_MOTRAD</th>
      <th>KBA05_MOTRAD/BALLRAUM</th>
      <th>VHN/D19_SOZIALES</th>
      <th>PLZ8_ANTG4/KBA05_ANHANG</th>
      <th>PLZ8_ANTG4/KBA05_ANTG3</th>
      <th>SHOPPER_TYP/KBA13_ANTG4</th>
      <th>PLZ8_ANTG4/KBA13_KRSSEG_VAN</th>
      <th>D19_LETZTER_KAUF_BRANCHE_D19_UNBEKANNT/D19_KONSUMTYP</th>
      <th>KBA05_ANHANG/KBA05_SEG7</th>
      <th>KBA05_MOTRAD/KBA05_ANTG3</th>
      <th>KBA05_MOTRAD/AGER_TYP</th>
      <th>VHN/KBA05_MOTRAD</th>
      <th>AGER_TYP/KBA05_ZUL2</th>
      <th>KBA05_SEG8/KBA05_SEG7</th>
      <th>KBA05_SEG7/AGER_TYP</th>
      <th>...</th>
      <th>D19_BEKLEIDUNG_REST/D19_BANKEN_DIREKT</th>
      <th>KBA13_KW_70/KBA05_ANTG2</th>
      <th>D19_BEKLEIDUNG_REST/D19_HAUS_DEKO</th>
      <th>D19_VERSAND_REST/D19_BEKLEIDUNG_REST</th>
      <th>KBA05_MOD1/KBA05_SEG10</th>
      <th>KK_KUNDENTYP/D19_VERSAND_ANZ_24</th>
      <th>KBA05_ANTG2/D19_VOLLSORTIMENT</th>
      <th>KBA05_SEG9/D19_TECHNIK</th>
      <th>KBA05_ALTER2/D19_VERSAND_ANZ_12</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_12</th>
      <th>KBA05_SEG9/KBA05_ALTER3</th>
      <th>D19_VOLLSORTIMENT/KBA05_HERST5</th>
      <th>KBA05_MOD8/D19_REISEN</th>
      <th>D19_BUCH_CD/KBA05_KW3</th>
      <th>D19_BUCH_CD/KBA05_MOD8</th>
      <th>D19_BUCH_CD/KBA05_KRSVAN</th>
      <th>D19_VOLLSORTIMENT/D19_GESAMT_ONLINE_QUOTE_12</th>
      <th>RELAT_AB/KBA05_KW3</th>
      <th>D19_SONSTIGE/EXTSEL992</th>
      <th>KBA05_CCM4/D19_SONSTIGE</th>
      <th>KBA05_DIESEL/UMFELD_JUNG</th>
      <th>KBA05_DIESEL/RT_UEBERGROESSE</th>
      <th>KBA13_VORB_2/KBA13_VORB_1_2</th>
      <th>GFK_URLAUBERTYP/KBA05_KRSVAN</th>
      <th>D19_SONSTIGE/D19_VERSAND_ANZ_24</th>
      <th>KBA05_SEG5/KBA13_SEG_OBERKLASSE</th>
      <th>KBA05_BAUMAX/UMFELD_ALT</th>
      <th>KBA13_KW_90/KBA13_CCM_3001</th>
      <th>KBA05_DIESEL/KBA05_HERST4</th>
      <th>KBA13_SEG_OBERKLASSE/KBA13_KRSZUL_NEU</th>
      <th>KBA05_MOD4/KBA05_SEG5</th>
      <th>KBA13_BJ_2008/RETOURTYP_BK_S</th>
      <th>KBA05_VORB2/EXTSEL992</th>
      <th>KBA05_HERST4/KBA05_FRAU</th>
      <th>D19_VERSAND_ONLINE_QUOTE_12/KBA05_KRSVAN</th>
      <th>GFK_URLAUBERTYP/D19_VERSAND_ONLINE_QUOTE_12</th>
      <th>KK_KUNDENTYP/D19_GESAMT_ANZ_12</th>
      <th>Clusters</th>
      <th>TARGET</th>
      <th>LNR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>-2.640672</td>
      <td>0.843719</td>
      <td>0.102702</td>
      <td>-0.075584</td>
      <td>-0.362793</td>
      <td>0.264781</td>
      <td>-0.223328</td>
      <td>-0.506855</td>
      <td>0.951140</td>
      <td>-0.468598</td>
      <td>0.486646</td>
      <td>0.660295</td>
      <td>-0.003846</td>
      <td>0.296077</td>
      <td>-0.272760</td>
      <td>0.113319</td>
      <td>0.108795</td>
      <td>0.099468</td>
      <td>0.122817</td>
      <td>0.083201</td>
      <td>1.247350</td>
      <td>-0.455726</td>
      <td>-0.571825</td>
      <td>-0.067285</td>
      <td>0.560072</td>
      <td>-0.089024</td>
      <td>0.193925</td>
      <td>-0.005272</td>
      <td>0.283273</td>
      <td>0.301201</td>
      <td>-0.373616</td>
      <td>0.631035</td>
      <td>-0.102140</td>
      <td>-0.161052</td>
      <td>0.052280</td>
      <td>0.024935</td>
      <td>-0.390521</td>
      <td>-0.242384</td>
      <td>-0.069935</td>
      <td>-0.120373</td>
      <td>...</td>
      <td>-0.093179</td>
      <td>-0.266858</td>
      <td>0.061900</td>
      <td>-0.121609</td>
      <td>-0.099128</td>
      <td>1.126712</td>
      <td>0.046679</td>
      <td>-0.203011</td>
      <td>-0.181079</td>
      <td>0.299730</td>
      <td>-0.202914</td>
      <td>-0.123354</td>
      <td>-0.024537</td>
      <td>-0.002241</td>
      <td>-0.569587</td>
      <td>0.333229</td>
      <td>0.299639</td>
      <td>0.236294</td>
      <td>0.160245</td>
      <td>0.115646</td>
      <td>0.066705</td>
      <td>-0.318140</td>
      <td>-0.009263</td>
      <td>-0.165102</td>
      <td>-0.293401</td>
      <td>0.003036</td>
      <td>0.051617</td>
      <td>-0.015282</td>
      <td>0.585075</td>
      <td>0.076598</td>
      <td>-0.012210</td>
      <td>-0.207770</td>
      <td>0.055532</td>
      <td>0.163585</td>
      <td>0.575585</td>
      <td>-0.187314</td>
      <td>-0.558813</td>
      <td>2</td>
      <td>1</td>
      <td>24700</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-2.063223</td>
      <td>0.400269</td>
      <td>0.857781</td>
      <td>0.483734</td>
      <td>-0.047520</td>
      <td>0.626514</td>
      <td>-0.435673</td>
      <td>0.023308</td>
      <td>0.416930</td>
      <td>-0.389410</td>
      <td>-0.945167</td>
      <td>-0.911041</td>
      <td>0.583819</td>
      <td>1.262275</td>
      <td>-0.467349</td>
      <td>0.022939</td>
      <td>-0.079326</td>
      <td>0.396674</td>
      <td>0.914962</td>
      <td>0.051674</td>
      <td>0.387914</td>
      <td>0.044065</td>
      <td>-0.259569</td>
      <td>-0.227781</td>
      <td>-0.473022</td>
      <td>0.260998</td>
      <td>-0.377862</td>
      <td>0.094678</td>
      <td>0.330117</td>
      <td>-0.230632</td>
      <td>-0.042768</td>
      <td>-0.003732</td>
      <td>-0.358954</td>
      <td>0.082959</td>
      <td>0.452334</td>
      <td>-0.659340</td>
      <td>-0.557442</td>
      <td>0.425277</td>
      <td>-0.677737</td>
      <td>0.100660</td>
      <td>...</td>
      <td>0.190761</td>
      <td>0.065015</td>
      <td>0.571585</td>
      <td>0.325712</td>
      <td>-0.128486</td>
      <td>-0.151182</td>
      <td>0.555767</td>
      <td>-0.171523</td>
      <td>-0.063445</td>
      <td>-0.067942</td>
      <td>-0.042285</td>
      <td>0.232594</td>
      <td>-0.314477</td>
      <td>-0.153548</td>
      <td>0.298703</td>
      <td>0.239172</td>
      <td>-0.167129</td>
      <td>-0.444540</td>
      <td>0.722695</td>
      <td>0.113475</td>
      <td>0.369564</td>
      <td>-0.260474</td>
      <td>-0.217681</td>
      <td>0.462359</td>
      <td>-0.165925</td>
      <td>-0.070592</td>
      <td>-0.045608</td>
      <td>0.159999</td>
      <td>-0.279164</td>
      <td>-0.239771</td>
      <td>-0.236415</td>
      <td>0.097393</td>
      <td>0.292148</td>
      <td>-0.015301</td>
      <td>-0.459012</td>
      <td>0.149128</td>
      <td>-0.046471</td>
      <td>2</td>
      <td>1</td>
      <td>164256</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-1.372159</td>
      <td>1.166249</td>
      <td>-1.043671</td>
      <td>0.247380</td>
      <td>0.794591</td>
      <td>-0.903142</td>
      <td>-1.727027</td>
      <td>1.351772</td>
      <td>-0.244045</td>
      <td>0.745800</td>
      <td>0.651984</td>
      <td>-0.782614</td>
      <td>0.237077</td>
      <td>-0.593261</td>
      <td>-0.004930</td>
      <td>-0.168611</td>
      <td>0.727278</td>
      <td>-0.001004</td>
      <td>0.176355</td>
      <td>-0.105044</td>
      <td>-0.082041</td>
      <td>1.114180</td>
      <td>0.089635</td>
      <td>-0.294440</td>
      <td>-0.417220</td>
      <td>0.283097</td>
      <td>-0.283342</td>
      <td>0.296308</td>
      <td>0.666146</td>
      <td>0.279036</td>
      <td>-0.544161</td>
      <td>-0.391942</td>
      <td>-0.175988</td>
      <td>-0.031520</td>
      <td>0.484813</td>
      <td>-0.143667</td>
      <td>-0.349746</td>
      <td>-0.503226</td>
      <td>0.380985</td>
      <td>0.011175</td>
      <td>...</td>
      <td>-0.119336</td>
      <td>0.193120</td>
      <td>0.052614</td>
      <td>0.179707</td>
      <td>-0.122782</td>
      <td>0.123304</td>
      <td>-0.334469</td>
      <td>-0.284484</td>
      <td>0.046115</td>
      <td>0.357731</td>
      <td>0.452035</td>
      <td>-0.228360</td>
      <td>-0.174317</td>
      <td>-0.338441</td>
      <td>0.085373</td>
      <td>0.011598</td>
      <td>-0.016361</td>
      <td>0.025277</td>
      <td>0.176017</td>
      <td>0.400706</td>
      <td>0.008046</td>
      <td>-0.097396</td>
      <td>-0.043868</td>
      <td>0.388968</td>
      <td>-0.325925</td>
      <td>0.125511</td>
      <td>0.470923</td>
      <td>-0.150063</td>
      <td>0.295416</td>
      <td>-0.002793</td>
      <td>0.061119</td>
      <td>-0.483951</td>
      <td>0.047001</td>
      <td>-0.281829</td>
      <td>-0.218722</td>
      <td>-0.218273</td>
      <td>0.061485</td>
      <td>2</td>
      <td>1</td>
      <td>36904</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.622610</td>
      <td>-0.065053</td>
      <td>0.821297</td>
      <td>1.121812</td>
      <td>-0.472048</td>
      <td>0.010100</td>
      <td>0.405544</td>
      <td>-0.236830</td>
      <td>0.075706</td>
      <td>0.339974</td>
      <td>-0.467588</td>
      <td>0.036995</td>
      <td>0.885449</td>
      <td>-0.770944</td>
      <td>0.195356</td>
      <td>-0.290143</td>
      <td>0.678201</td>
      <td>-0.167262</td>
      <td>-0.299035</td>
      <td>0.604685</td>
      <td>-0.019437</td>
      <td>-0.188901</td>
      <td>0.202551</td>
      <td>-0.414020</td>
      <td>-0.133697</td>
      <td>-0.114712</td>
      <td>0.191796</td>
      <td>0.730658</td>
      <td>-0.056620</td>
      <td>0.068252</td>
      <td>0.239848</td>
      <td>-0.122530</td>
      <td>0.428666</td>
      <td>0.314938</td>
      <td>-0.221472</td>
      <td>0.098372</td>
      <td>0.113208</td>
      <td>0.329631</td>
      <td>0.539758</td>
      <td>-0.337404</td>
      <td>...</td>
      <td>0.100177</td>
      <td>-0.326417</td>
      <td>0.031772</td>
      <td>-0.357952</td>
      <td>0.420073</td>
      <td>-0.266167</td>
      <td>0.293056</td>
      <td>0.326806</td>
      <td>0.416744</td>
      <td>-0.253868</td>
      <td>0.345884</td>
      <td>-0.303418</td>
      <td>-0.182663</td>
      <td>-0.047127</td>
      <td>0.341984</td>
      <td>-0.139045</td>
      <td>-0.078901</td>
      <td>-0.203956</td>
      <td>-0.128059</td>
      <td>-0.360531</td>
      <td>0.050204</td>
      <td>0.229974</td>
      <td>-0.049812</td>
      <td>0.199613</td>
      <td>-0.257879</td>
      <td>0.103803</td>
      <td>-0.479614</td>
      <td>0.107008</td>
      <td>-0.119015</td>
      <td>-0.006012</td>
      <td>-0.046189</td>
      <td>0.651832</td>
      <td>0.154374</td>
      <td>0.260852</td>
      <td>-0.224118</td>
      <td>0.267607</td>
      <td>0.197021</td>
      <td>2</td>
      <td>-1</td>
      <td>934184</td>
    </tr>
    <tr>
      <th>35</th>
      <td>-0.855624</td>
      <td>3.098685</td>
      <td>0.250012</td>
      <td>0.230511</td>
      <td>1.059720</td>
      <td>-0.627812</td>
      <td>-0.654421</td>
      <td>0.456267</td>
      <td>0.817005</td>
      <td>-0.054278</td>
      <td>0.489636</td>
      <td>0.324316</td>
      <td>-0.091211</td>
      <td>-0.379414</td>
      <td>0.160945</td>
      <td>-0.880575</td>
      <td>-0.171045</td>
      <td>-0.484757</td>
      <td>0.256562</td>
      <td>1.462890</td>
      <td>0.623760</td>
      <td>0.816858</td>
      <td>-0.089464</td>
      <td>0.011598</td>
      <td>0.301120</td>
      <td>-0.383985</td>
      <td>-0.613529</td>
      <td>-0.452742</td>
      <td>0.276201</td>
      <td>-0.797456</td>
      <td>0.020515</td>
      <td>-0.274112</td>
      <td>-0.259049</td>
      <td>0.308186</td>
      <td>-0.167700</td>
      <td>0.536849</td>
      <td>-0.091647</td>
      <td>-0.242193</td>
      <td>0.094677</td>
      <td>0.090738</td>
      <td>...</td>
      <td>-0.127433</td>
      <td>0.157835</td>
      <td>-0.164282</td>
      <td>0.369541</td>
      <td>-0.160702</td>
      <td>0.188433</td>
      <td>0.781503</td>
      <td>-0.340645</td>
      <td>0.103674</td>
      <td>-0.493021</td>
      <td>0.704301</td>
      <td>-0.193590</td>
      <td>0.528758</td>
      <td>0.176995</td>
      <td>0.220275</td>
      <td>-0.037410</td>
      <td>0.473194</td>
      <td>-0.042443</td>
      <td>-0.218568</td>
      <td>-0.033859</td>
      <td>-0.108060</td>
      <td>0.525622</td>
      <td>0.196588</td>
      <td>0.203919</td>
      <td>-0.106998</td>
      <td>-0.021664</td>
      <td>-0.357374</td>
      <td>-0.202134</td>
      <td>-0.174691</td>
      <td>0.514296</td>
      <td>0.169565</td>
      <td>0.182207</td>
      <td>0.051376</td>
      <td>0.251897</td>
      <td>-0.302851</td>
      <td>-0.024586</td>
      <td>0.274944</td>
      <td>2</td>
      <td>-1</td>
      <td>843518</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 107 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have created a list of the two most influencing attributes characterising each principal component. We will create a dictionary mapping of these two attributes for each PC, extracting more available information from the excel files provided for the attributes' explanation. This will give us more information on the dominant context of each PC.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># For each name we created for PCs we check if the attribute exists in the excel file and extract descriptions</span>
<span class="n">pca_list_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">pc</span><span class="p">:</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">dfdias_attrib</span><span class="p">[</span><span class="n">dfdias_attrib</span><span class="p">[</span><span class="s2">&quot;Attribute&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="s1">&#39;_RZ&#39;</span><span class="p">])][</span><span class="s2">&quot;Description&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> \
                               <span class="k">if</span> <span class="n">dfdias_attrib</span><span class="p">[</span><span class="s2">&quot;Attribute&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="s1">&#39;_RZ&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;UNKNOWN&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)])</span> \
                <span class="k">for</span> <span class="n">pc</span> <span class="ow">in</span> <span class="n">pca_list</span><span class="p">}</span>

<span class="nb">list</span><span class="p">(</span><span class="n">pca_list_map</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[(&#39;CJT_TYP_2/FINANZ_SPARER&#39;, &#39;UNKNOWN, financial typology: money saver&#39;),
 (&#39;FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER&#39;,
  &#39;financial typology: investor, financial typology: unremarkable&#39;),
 (&#39;OST_WEST_KZ_W/STRUKTURTYP&#39;, &#39;UNKNOWN, UNKNOWN&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above mapping allows us to further look into the characteristics of a cluster. For example for cluster 2 we can look for the location of the highest (most dominant) centroid coordinates in the heatmap above. This tells us that it has the highest value in some principal components. We can extract these names and look at the dictionary we created for more info.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Cluster 2</span>
<span class="n">cluster2_top5_pc</span> <span class="o">=</span> <span class="n">cluster_centroids</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">pc</span> <span class="ow">in</span> <span class="n">cluster2_top5_pc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Attributes]- </span><span class="si">{}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">[Description]- </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">pca_list_map</span><span class="p">[</span><span class="n">pc</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[Attributes]- CJT_TYP_2/FINANZ_SPARER,	[Descritpion]- UNKNOWN, financial typology: money saver
[Attributes]- KBA13_BAUMAX/LP_FAMILIE_FEIN,	[Descritpion]- UNKNOWN, familytyp fine
[Attributes]- FINANZ_ANLEGER/FINANZ_UNAUFFAELLIGER,	[Descritpion]- financial typology: investor, financial typology: unremarkable
[Attributes]- ANREDE_KZ/SEMIO_KAEM,	[Descritpion]- gender, affinity indicating in what way the person is of a fightfull attitude
[Attributes]- KBA05_BAUMAX/KBA05_ANTG3,	[Descritpion]- most common building-type within the cell, number of 6-10 family houses in the cell
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the above, on first look we can extract characteristics of <strong>Cluster 2</strong>  group such as:</p>
<blockquote><p><em>Individuals that are money savers and investors, are in a good financial status, living in the suburbs, or sparse areas</em>.</p>
</blockquote>
<p>If we further investigate the unknown attributes we find:</p>
<ul>
<li><code>CJT_TYP_2</code>: relating to the preferred information and buying channels of consumers</li>
<li><code>KBA13_BAUMAX</code>: is the estimated share of &gt;10 family houses in the PLZ8.</li>
</ul>
<p>With this we can add to the above cluster description:</p>
<blockquote><p><em>Individuals that are money savers and investors, are in a good financial status, living in the suburbs, or sparse areas …in common houses with buying preference channel 2 (Advertising- and Consumptiontraditionalist)</em>.</p>
</blockquote>
<p>Similarly for <strong>Cluster 1</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Cluster 1</span>
<span class="n">cluster1_top5_pc</span> <span class="o">=</span> <span class="n">cluster_centroids</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">pc</span> <span class="ow">in</span> <span class="n">cluster1_top5_pc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Attributes]- </span><span class="si">{}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">[Description]- </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">pca_list_map</span><span class="p">[</span><span class="n">pc</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[Attributes]- KBA13_ANTG4/PLZ8_ANTG4,	[Descritpion]- UNKNOWN, number of &gt;10 family houses in the PLZ8
[Attributes]- KBA05_MAXBJ/SHOPPER_TYP,	[Descritpion]- most common age of the cars in the microcell, shopping typology
[Attributes]- KBA05_MOD8/KBA05_SEG9,	[Descritpion]- share of vans (in an AZ specific definition), share of vans in the microcell
[Attributes]- PLZ8_ANTG4/KBA13_ANTG4,	[Descritpion]- number of &gt;10 family houses in the PLZ8, UNKNOWN
[Attributes]- GEBAEUDETYP/VHN,	[Descritpion]- type of building (residential or commercial), UNKNOWN
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><em>Individuals that live in not very dense areas, in residential or commercial buildings, with most common cars and vans</em>.</p>
</blockquote>
<p>We may also drill down to specifics of each attribute:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">LNR</span><span class="o">=</span><span class="n">clientIDs</span><span class="p">,</span> <span class="n">TARGET</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># E.g. FINANZ_ANLEGER</span>
<span class="c1"># Check the population in Cluster 1 for PC: CJT_TYP_2/FINANZ_ANLEGER</span>
<span class="n">cluster_1</span> <span class="o">=</span> <span class="n">population_transformed</span><span class="p">[</span><span class="n">population_transformed</span><span class="p">[</span><span class="s1">&#39;Clusters&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span>
<span class="c1"># Then filter the original data by these ids and get percentages:</span>
<span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cluster_1</span><span class="p">)][</span><span class="s1">&#39;FINANZ_ANLEGER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1     0.0
2     0.2
3     0.4
4     0.9
5    98.5
Name: FINANZ_ANLEGER, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, in this cluster we have these kinds of <code>investor</code> in general. We could also examine subsets based on general population and customers</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">group_cl1</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cluster_1</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;TARGET&#39;</span><span class="p">)</span>
<span class="c1"># General population dataset</span>
<span class="n">group_cl1</span><span class="o">.</span><span class="n">get_group</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="n">group_cl1</span><span class="o">.</span><span class="n">groups</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))[</span><span class="s1">&#39;FINANZ_ANLEGER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1     0.1
2     0.3
3     0.9
4     2.0
5    96.7
Name: FINANZ_ANLEGER, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the <strong>general population</strong> the percentages of <code>investor</code> in cluster 1 are as above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Customers dataset</span>
<span class="n">group_cl1</span><span class="o">.</span><span class="n">get_group</span><span class="p">((</span><span class="nb">list</span><span class="p">(</span><span class="n">group_cl1</span><span class="o">.</span><span class="n">groups</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))[</span><span class="s1">&#39;FINANZ_ANLEGER&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1     0.0
2     0.0
3     0.1
4     0.1
5    99.8
Name: FINANZ_ANLEGER, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the <strong>customers population</strong> the percentages of <code>investor</code> in cluster 1 are as above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Segmentation-conclusion">Segmentation conclusion<a class="anchor-link" href="#Segmentation-conclusion">&#182;</a></h3><p>The parts of the general population that may be considered more likely to be part of the mail-order company's main customer base are the ones in clusters:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">top_customer_clusters</span> <span class="o">=</span> <span class="n">target_group</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">target_group</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="s2">&quot;Clusters&quot;</span><span class="p">,</span> <span class="s2">&quot;Perc&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Perc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">top_customer_clusters</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Clusters</th>
      <th>Perc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>24.42</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>22.08</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These are the clusters with the highest customers population concentration. We may consider that these clusters in the corresponding general population will provide the highest chances for acquiring new customers. If we like to have a greater level of detail, we could transform the data to fit in more clusters. We could then target more specific segments of the general population.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Elapsed time: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_run</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Elapsed time:  0:06:39.358728
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">train</span><span class="p">,</span> <span class="n">population_transformed</span><span class="p">,</span> <span class="n">cluster_2</span><span class="p">,</span> <span class="n">cluster_1</span><span class="p">,</span> <span class="n">cluster_centroids</span><span class="p">,</span> <span class="n">pcadf</span><span class="p">,</span> <span class="n">pca_df</span><span class="p">,</span> <span class="n">train_vals</span><span class="p">,</span> \
<span class="n">clusterer</span><span class="p">,</span> <span class="n">all_Kscores</span><span class="p">,</span><span class="n">plt_attrs_wgts</span><span class="p">,</span> <span class="n">train_reduced</span><span class="p">,</span> <span class="n">pca_wghts_df</span><span class="p">,</span> <span class="n">norm_train</span><span class="p">,</span> <span class="n">pca</span><span class="p">,</span> <span class="n">azdias</span><span class="p">,</span> <span class="n">custrs</span>
<span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>28066</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-2:-Supervised-Learning-Model">Part 2: Supervised Learning Model<a class="anchor-link" href="#Part-2:-Supervised-Learning-Model">&#182;</a></h2><p>Now that you've found which parts of the population are more likely to be customers of the mail-order company, it's time to build a prediction model. Each of the rows in the "MAILOUT" data files represents an individual that was targeted for a mailout campaign. Ideally, we should be able to use the demographic information from each individual to decide whether or not it will be worth it to include that person in the campaign.</p>
<p>The "MAILOUT" data has been split into two approximately equal parts, each with almost 43 000 data rows. In this part, you can verify your model with the "TRAIN" partition, which includes a column, "RESPONSE", that states whether or not a person became a customer of the company following the campaign. In the next part, you'll need to create predictions on the "TEST" partition, where the "RESPONSE" column has been withheld.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-selection-using-LightGBM,-a-gradient-boosting-framework-that-uses-tree-based-learning-algorithms.">Feature selection using <a href="https://lightgbm.readthedocs.io/en/latest/index.html"><strong>LightGBM</strong></a>, a gradient boosting framework that uses tree-based learning algorithms.<a class="anchor-link" href="#Feature-selection-using-LightGBM,-a-gradient-boosting-framework-that-uses-tree-based-learning-algorithms.">&#182;</a></h3><p>We will use <strong>feature importances</strong> of a LightGBM model with a threshold value to remove attributes not considered important by the model. We will achieve this by removing all zero importance features (as computed by LightGBM) from the model.</p>
<p>The evaluation metric we will use is ROC_AUC_SCORE:</p>
<p>An ROC curve (receiver operating characteristic curve) is a graph showing the performance of a classification model at all classification thresholds. This curve plots two parameters:</p>
<ul>
<li>True Positive Rate</li>
<li>False Positive Rate</li>
</ul>
<p>AUC measures the entire two-dimensional area underneath the entire ROC curve  from (0,0) to (1,1). AUC provides an aggregate measure of performance across all possible classification thresholds.</p>
<ul>
<li>AUC is scale-invariant. It measures how well predictions are ranked, rather than their absolute values.</li>
<li>AUC is classification-threshold-invariant. It measures the quality of the model's predictions irrespective of what classification threshold is chosen.</li>
</ul>
<p>We will use <a href="https://lightgbm.readthedocs.io/en/latest/pythonapi/lightgbm.LGBMClassifier.html">LGBMClassifier</a>, a Gradient Boosted Model from the LightGBM library to assess feature importances.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>LGB plotting and interpretation:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/61862597/how-to-get-variance-explained-of-features-for-lightgbm-best_iter">https://stackoverflow.com/questions/61862597/how-to-get-variance-explained-of-features-for-lightgbm-best_iter</a></li>
<li><a href="https://stackoverflow.com/questions/53413701/feature-importance-using-lightgbm">https://stackoverflow.com/questions/53413701/feature-importance-using-lightgbm</a></li>
</ul>
<p>KFOLDS</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/cross_validation.html#k-fold">https://scikit-learn.org/stable/modules/cross_validation.html#k-fold</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Add the `LNR` column.</span>
<span class="n">df_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">LNR</span><span class="o">=</span><span class="n">clientIDs</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}df_train_</span><span class="si">{ts}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df_train = pd.read_csv(f&#39;{colab_dir if IN_COLAB else remote_dir}&#39; + &#39;df_train_&lt;add ts&gt;.csv&#39;)</span>
<span class="c1"># df_train.shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create train and target sets.</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">])</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s2">&quot;TARGET&quot;</span><span class="p">]</span>
<span class="n">target</span><span class="p">[</span><span class="n">target</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Add the `LNR` column.</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">LNR</span><span class="o">=</span><span class="n">clientIDs</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(450000, 377)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, from feature selection using gradient boosting model we may keep:</p>
<ul>
<li>the list that contains all attributes identified with zero importance.</li>
<li>a list that contains a smaller subset of non zero importance attributes reaching 0.95 cumulative importance.</li>
</ul>
<p>We may test the above to other sample subsets. If it turns out that the feature selection works well we can also use the model above for making predictions in later steps.</p>
<p>For this we will create a couple more functions to help us through the steps.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">auc</span><span class="p">,</span> <span class="n">RocCurveDisplay</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rf_model</span><span class="p">(</span><span class="n">features_labels_split</span><span class="p">,</span> <span class="n">rf_params</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Train and test a light gradient boosting model using</span>
<span class="sd">    cross validation with KFold splits. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        features_labels_split (list): List containing train-test split of inputs.</span>
<span class="sd">            Either [X_train, X_test, y_train, y_test] or [features, test_features]</span>
<span class="sd">            features will be pd.DataFrame of training features to use for training</span>
<span class="sd">            a model. Must include the `RESPONSE` column.</span>
<span class="sd">            test_features will be pd.DataFrame of testing features to use for</span>
<span class="sd">            making predictions with the model.</span>
<span class="sd">        lgbm_params (dict): LightGBM classifier init parameters.</span>
<span class="sd">        n_folds (int, default = 5): number of folds to use for cross validation.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        submission (pd.DataFrame): dataframe with `LNR` and `RESPONSE`</span>
<span class="sd">            probabilities predicted by the model.</span>
<span class="sd">        attrib_imp (pd.DataFrame): dataframe with the feature</span>
<span class="sd">            importances from the model.</span>
<span class="sd">        valid_metrics (pd.DataFrame): dataframe with training and validation</span>
<span class="sd">            metrics (ROC AUC) for each fold and overall.</span>
<span class="sd">    </span>
<span class="sd">    Ref: https://www.kaggle.com/willkoehrsen/introduction-to-feature-selection#Remove-Collinear-Variables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rf_ts</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
    <span class="c1"># Differentiate assignments according to input (length=4 -&gt; train_test_split)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">features_labels_split</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_labels</span> <span class="o">=</span> <span class="n">features_labels_split</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span> <span class="o">=</span> <span class="n">features_labels_split</span>
        <span class="c1"># Extract the labels for training</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;RESPONSE&#39;</span><span class="p">]</span>
        <span class="n">test_labels</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Extract the client IDs</span>
    <span class="n">train_ids</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span>
    <span class="n">test_ids</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span>
    <span class="c1"># Drop the client IDs and datetimes</span>
    <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">,</span> <span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">,</span> <span class="s1">&#39;RESPONSE&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">,</span> <span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Training Data Shape: &#39;</span><span class="p">,</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing Data Shape: &#39;</span><span class="p">,</span> <span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    
    <span class="c1"># Extract feature names</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="c1"># Impute missing values with Random Selection</span>
    <span class="n">traintestX</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">imput_nan_rand</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">test_features</span><span class="p">)]</span>
    <span class="c1"># Normalization</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span> <span class="o">=</span> <span class="p">[</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traintestX</span><span class="p">]</span>

    <span class="c1"># Empty array for feature importances</span>
    <span class="n">feature_importance_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">))</span>
    <span class="c1"># Empty array for test predictions</span>
    <span class="n">test_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Empty array for out of fold validation predictions</span>
    <span class="n">out_of_fold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Create the kfold object</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating KFold object&quot;</span><span class="p">)</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_folds</span><span class="p">)</span>
    
    <span class="c1"># Lists for recording validation and training scores</span>
    <span class="n">train_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tprs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">aucs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mean_fpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># save figure location</span>
    <span class="n">roc_plot_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}rf_roc_</span><span class="si">{ts}</span><span class="s1">_</span><span class="si">{rf_ts}</span><span class="s1">.png&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Starting fold iterations&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="c1"># Iterate through folds</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">features</span><span class="p">)):</span>
        <span class="c1"># Training data for the fold</span>
        <span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_train_y</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
        <span class="c1"># Validation data for the fold</span>
        <span class="n">fold_test_X</span><span class="p">,</span> <span class="n">fold_test_y</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">val_idx</span><span class="p">],</span> <span class="n">labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span>
        <span class="c1"># Create the model</span>
        <span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">rf_params</span><span class="p">)</span>
        <span class="c1"># Train the model</span>
        <span class="n">rf_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_train_y</span><span class="p">)</span>
        <span class="c1"># Extract and keep feature importances</span>
        <span class="n">feature_importance_values</span> <span class="o">+=</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="o">/</span> <span class="n">folds</span><span class="o">.</span><span class="n">n_splits</span>
        <span class="c1"># Make predictions using these importances</span>
        <span class="n">test_predictions</span> <span class="o">+=</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_features</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">folds</span><span class="o">.</span><span class="n">n_splits</span>
        <span class="c1"># Record the out of fold predictions</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">fold_test_X</span><span class="p">)</span>
        <span class="n">y_proba</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">fold_test_X</span><span class="p">)</span>
        <span class="n">out_of_fold</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Record train and ROC AUC scores</span>
        <span class="n">train_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">fold_train_y</span><span class="p">,</span> <span class="n">rf_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">fold_train_X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="n">test_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">fold_test_y</span><span class="p">,</span> <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="n">viz</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
            <span class="n">fold_test_y</span><span class="p">,</span>
            <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ROC fold </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">interp_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mean_fpr</span><span class="p">,</span> <span class="n">viz</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">viz</span><span class="o">.</span><span class="n">tpr</span><span class="p">)</span>
        <span class="n">interp_tpr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">tprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interp_tpr</span><span class="p">)</span>
        <span class="n">aucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">viz</span><span class="o">.</span><span class="n">roc_auc</span><span class="p">)</span>
        <span class="c1"># Clean up memory</span>
        <span class="k">del</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_test_X</span><span class="p">,</span> <span class="n">fold_train_y</span><span class="p">,</span> <span class="n">fold_test_y</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Chance&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">mean_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tprs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean_tpr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">mean_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">mean_fpr</span><span class="p">,</span> <span class="n">mean_tpr</span><span class="p">)</span>
    <span class="n">std_auc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">aucs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">mean_fpr</span><span class="p">,</span>
        <span class="n">mean_tpr</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">r&quot;Mean ROC (AUC = </span><span class="si">%0.2f</span><span class="s2"> $\pm$ </span><span class="si">%0.2f</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean_auc</span><span class="p">,</span> <span class="n">std_auc</span><span class="p">),</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">std_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tprs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tprs_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">mean_tpr</span> <span class="o">+</span> <span class="n">std_tpr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">tprs_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">mean_tpr</span> <span class="o">-</span> <span class="n">std_tpr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">mean_fpr</span><span class="p">,</span>
        <span class="n">tprs_lower</span><span class="p">,</span>
        <span class="n">tprs_upper</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">r&quot;$\pm$ 1 std. dev.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;RandomForest - Receiver operating characteristic (ROC)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">roc_plot_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating output&quot;</span><span class="p">)</span>
    <span class="c1"># Make the submission dataframe</span>
    <span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;LNR&#39;</span><span class="p">:</span> <span class="n">test_ids</span><span class="p">,</span> <span class="s1">&#39;RESPONSE&#39;</span><span class="p">:</span> <span class="n">test_predictions</span><span class="p">})</span>

    <span class="c1"># Make the feature importance dataframe</span>
    <span class="n">attrib_imp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
                               <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importance_values</span><span class="p">})</span>
    
    <span class="c1"># Overall validation score</span>
    <span class="n">test_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">out_of_fold</span><span class="p">)</span>
    
    <span class="c1"># Add the overall scores to the metrics</span>
    <span class="n">test_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_auc</span><span class="p">)</span>
    <span class="n">train_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_scores</span><span class="p">))</span>
    
    <span class="c1"># Needed for creating dataframe of validation scores</span>
    <span class="n">fold_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_folds</span><span class="p">))</span>
    <span class="n">fold_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;overall&#39;</span><span class="p">)</span>
    
    <span class="c1"># Dataframe of validation scores</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold_names</span><span class="p">,</span>
                            <span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">train_scores</span><span class="p">,</span>
                            <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="n">test_scores</span><span class="p">})</span>
    
    <span class="k">return</span> <span class="n">submission</span><span class="p">,</span> <span class="n">attrib_imp</span><span class="p">,</span> <span class="n">metrics</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rf_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;class_weight&#39;</span><span class="p">:</span> <span class="s1">&#39;balanced&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># submit_i, attrib_imp_i, metrics_i = rf_model(train_test_split(train, target, stratify=target, test_size=.25), rf_params)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training Data Shape:  (262500, 376)
Testing Data Shape:  (87500, 376)
Creating KFold object

Starting fold iterations
-------------------------
-------------------------
Creating output
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># LightGBM</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>

<span class="k">def</span> <span class="nf">lgb_model</span><span class="p">(</span><span class="n">features_labels_split</span><span class="p">,</span> <span class="n">lgbm_params</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Train and test a light gradient boosting model using</span>
<span class="sd">    cross validation with KFold splits. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        features_labels_split (list): List containing train-test split of inputs.</span>
<span class="sd">            Either [X_train, X_test, y_train, y_test] or [features, test_features]</span>
<span class="sd">            features will be pd.DataFrame of training features to use for training</span>
<span class="sd">            a model. Must include the `RESPONSE` column.</span>
<span class="sd">            test_features will be pd.DataFrame of testing features to use for</span>
<span class="sd">            making predictions with the model.</span>
<span class="sd">        lgbm_params (dict): LightGBM classifier init parameters.</span>
<span class="sd">        n_folds (int, default = 5): number of folds to use for cross validation.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        submission (pd.DataFrame): dataframe with `LNR` and `RESPONSE`</span>
<span class="sd">            probabilities predicted by the model.</span>
<span class="sd">        attrib_imp (pd.DataFrame): dataframe with the feature</span>
<span class="sd">            importances from the model.</span>
<span class="sd">        valid_metrics (pd.DataFrame): dataframe with training and validation</span>
<span class="sd">            metrics (ROC AUC) for each fold and overall.</span>
<span class="sd">    </span>
<span class="sd">    Ref: https://www.kaggle.com/willkoehrsen/introduction-to-feature-selection#Remove-Collinear-Variables</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lgbm_ts</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
    <span class="c1"># Differentiate assignments according to input (length=4 -&gt; train_test_split)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">features_labels_split</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">test_labels</span> <span class="o">=</span> <span class="n">features_labels_split</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span> <span class="o">=</span> <span class="n">features_labels_split</span>
        <span class="c1"># Extract the labels for training</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;RESPONSE&#39;</span><span class="p">]</span>

    <span class="c1"># Extract the client IDs</span>
    <span class="n">train_ids</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span>
    <span class="n">test_ids</span> <span class="o">=</span> <span class="n">test_features</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">]</span>
    <span class="c1"># Drop the client IDs and datetimes</span>
    <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">,</span> <span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">,</span> <span class="s1">&#39;RESPONSE&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">test_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;LNR&#39;</span><span class="p">,</span> <span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Training Data Shape: &#39;</span><span class="p">,</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing Data Shape: &#39;</span><span class="p">,</span> <span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    
    <span class="c1"># Extract feature names</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="c1"># Impute missing values with Random Selection</span>
    <span class="n">traintestX</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">imput_nan_rand</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">test_features</span><span class="p">)]</span>
    <span class="c1"># Normalization</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">test_features</span> <span class="o">=</span> <span class="p">[</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">traintestX</span><span class="p">]</span>

    <span class="c1"># Empty array for feature importances</span>
    <span class="n">feature_importance_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">))</span>
    <span class="c1"># Empty array for test predictions</span>
    <span class="n">test_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">test_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># Empty array for out of fold validation predictions</span>
    <span class="n">out_of_fold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Create the kfold object</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating KFold object&quot;</span><span class="p">)</span>
    <span class="n">folds</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">n_folds</span><span class="p">)</span>
    
    <span class="c1"># Lists for recording validation and training scores</span>
    <span class="n">train_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tprs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">aucs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mean_fpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># save figure location</span>
    <span class="n">lgb_roc_plt_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}lgb_roc_</span><span class="si">{ts}</span><span class="s1">_</span><span class="si">{lgbm_ts}</span><span class="s1">.png&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Starting fold iterations&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="c1"># Iterate through folds</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_idx</span><span class="p">,</span> <span class="n">val_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">folds</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">features</span><span class="p">)):</span>
        <span class="c1"># Training data for the fold</span>
        <span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_train_y</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span>
        <span class="c1"># Validation data for the fold</span>
        <span class="n">fold_test_X</span><span class="p">,</span> <span class="n">fold_test_y</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">val_idx</span><span class="p">],</span> <span class="n">labels</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span>
        <span class="c1"># Create the model</span>
        <span class="n">lgbm_clf</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">lgbm_params</span><span class="p">)</span>
        <span class="c1"># Train the model</span>
        <span class="n">lgbm_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_train_y</span><span class="p">,</span>
            <span class="n">eval_metric</span><span class="o">=</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span>
            <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">fold_test_X</span><span class="p">,</span> <span class="n">fold_test_y</span><span class="p">),</span> <span class="p">(</span><span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_train_y</span><span class="p">)],</span>
            <span class="n">eval_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">],</span>
            <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">verbose</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="p">)</span>
        <span class="c1"># Keep the best iteration</span>
        <span class="n">best_iter</span> <span class="o">=</span> <span class="n">lgbm_clf</span><span class="o">.</span><span class="n">best_iteration_</span>
        <span class="c1"># Extract and keep feature importances</span>
        <span class="n">feature_importance_values</span> <span class="o">+=</span> <span class="n">lgbm_clf</span><span class="o">.</span><span class="n">feature_importances_</span> <span class="o">/</span> <span class="n">folds</span><span class="o">.</span><span class="n">n_splits</span>
        <span class="c1"># Make predictions using these importances</span>
        <span class="n">test_predictions</span> <span class="o">+=</span> <span class="n">lgbm_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">test_features</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">best_iter</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">folds</span><span class="o">.</span><span class="n">n_splits</span>
        <span class="c1"># Record the out of fold predictions</span>
        <span class="n">y_proba</span> <span class="o">=</span> <span class="n">lgbm_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">fold_test_X</span><span class="p">,</span> <span class="n">num_iteration</span><span class="o">=</span><span class="n">best_iter</span><span class="p">)</span>
        <span class="n">out_of_fold</span><span class="p">[</span><span class="n">val_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Record the best score</span>
        <span class="n">train_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="s1">&#39;auc&#39;</span><span class="p">])</span>
        <span class="n">test_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lgbm_clf</span><span class="o">.</span><span class="n">best_score_</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">][</span><span class="s1">&#39;auc&#39;</span><span class="p">])</span>
        <span class="n">viz</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
            <span class="n">fold_test_y</span><span class="p">,</span>
            <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ROC fold </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">interp_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mean_fpr</span><span class="p">,</span> <span class="n">viz</span><span class="o">.</span><span class="n">fpr</span><span class="p">,</span> <span class="n">viz</span><span class="o">.</span><span class="n">tpr</span><span class="p">)</span>
        <span class="n">interp_tpr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">tprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interp_tpr</span><span class="p">)</span>
        <span class="n">aucs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">viz</span><span class="o">.</span><span class="n">roc_auc</span><span class="p">)</span>
        <span class="c1"># Clean up memory</span>
        <span class="k">del</span> <span class="n">lgbm_clf</span><span class="p">,</span> <span class="n">fold_train_X</span><span class="p">,</span> <span class="n">fold_test_X</span><span class="p">,</span> <span class="n">fold_train_y</span><span class="p">,</span> <span class="n">fold_test_y</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Chance&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">mean_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tprs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mean_tpr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">mean_auc</span> <span class="o">=</span> <span class="n">auc</span><span class="p">(</span><span class="n">mean_fpr</span><span class="p">,</span> <span class="n">mean_tpr</span><span class="p">)</span>
    <span class="n">std_auc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">aucs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">mean_fpr</span><span class="p">,</span>
        <span class="n">mean_tpr</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">r&quot;Mean ROC (AUC = </span><span class="si">%0.2f</span><span class="s2"> $\pm$ </span><span class="si">%0.2f</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean_auc</span><span class="p">,</span> <span class="n">std_auc</span><span class="p">),</span>
        <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="p">)</span>
    
    <span class="n">std_tpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">tprs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tprs_upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">mean_tpr</span> <span class="o">+</span> <span class="n">std_tpr</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">tprs_lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">mean_tpr</span> <span class="o">-</span> <span class="n">std_tpr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">mean_fpr</span><span class="p">,</span>
        <span class="n">tprs_lower</span><span class="p">,</span>
        <span class="n">tprs_upper</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">r&quot;$\pm$ 1 std. dev.&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;LightGBM - Receiver operating characteristic (ROC)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">lgb_roc_plt_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="mi">25</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating output&quot;</span><span class="p">)</span>    
    <span class="c1"># Make the submission dataframe</span>
    <span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;LNR&#39;</span><span class="p">:</span> <span class="n">test_ids</span><span class="p">,</span> <span class="s1">&#39;RESPONSE&#39;</span><span class="p">:</span> <span class="n">test_predictions</span><span class="p">})</span>
    
    <span class="c1"># Make the feature importance dataframe</span>
    <span class="n">attrib_imp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
                               <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importance_values</span><span class="p">})</span>
    
    <span class="c1"># Overall validation score</span>
    <span class="n">test_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">out_of_fold</span><span class="p">)</span>
    
    <span class="c1"># Add the overall scores to the metrics</span>
    <span class="n">test_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_auc</span><span class="p">)</span>
    <span class="n">train_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_scores</span><span class="p">))</span>
    
    <span class="c1"># Needed for creating dataframe of validation scores</span>
    <span class="n">fold_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_folds</span><span class="p">))</span>
    <span class="n">fold_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;overall&#39;</span><span class="p">)</span>
    
    <span class="c1"># Dataframe of validation scores</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fold&#39;</span><span class="p">:</span> <span class="n">fold_names</span><span class="p">,</span>
                            <span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">train_scores</span><span class="p">,</span>
                            <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="n">test_scores</span><span class="p">})</span> 
    
    <span class="k">return</span> <span class="n">submission</span><span class="p">,</span> <span class="n">attrib_imp</span><span class="p">,</span> <span class="n">metrics</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"Ensembles like LGBM build trees in iterations, and each new tree is used to correct the “errors” of the previous trees. This approach is fast and powerful, and prone to overfitting.
That’s why gradient boosted ensembles have a learning_rate parameter that controls the learning speed. Typical values lie within 0.01 and 0.3, but it is possible to go beyond these, especially towards 0.
So, the perfect setup for these 2 parameters (n_estimators and learning_rate) is to use many trees with early stopping and set a low value for learning_rate."</p>
<p><a href="https://towardsdatascience.com/kagglers-guide-to-lightgbm-hyperparameter-tuning-with-optuna-in-2021-ed048d9838b5">https://towardsdatascience.com/kagglers-guide-to-lightgbm-hyperparameter-tuning-with-optuna-in-2021-ed048d9838b5</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lgbm_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;boosting_type&#39;</span><span class="p">:</span> <span class="s1">&#39;goss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;class_weight&#39;</span><span class="p">:</span> <span class="s1">&#39;balanced&#39;</span><span class="p">,</span>
    <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span>
    <span class="s1">&#39;n_jobs&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">srch_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;boosting_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gbdt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span>
    <span class="s1">&#39;is_unbalance&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">,</span>
    <span class="s1">&#39;subsample_freq&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">67</span><span class="p">,</span>
    <span class="s1">&#39;n_jobs&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">submit_i</span><span class="p">,</span> <span class="n">attrib_imp_i</span><span class="p">,</span> <span class="n">metrics_i</span> <span class="o">=</span> <span class="n">lgb_model</span><span class="p">(</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">25</span><span class="p">),</span> <span class="n">lgbm_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training Data Shape:  (337500, 376)
Testing Data Shape:  (112500, 376)
Creating KFold object

Starting fold iterations
-------------------------
Training until validation scores don&#39;t improve for 100 rounds.
[200]	train&#39;s auc: 0.929145	train&#39;s binary_logloss: 0.339655	test&#39;s auc: 0.922348	test&#39;s binary_logloss: 0.354317
[400]	train&#39;s auc: 0.936108	train&#39;s binary_logloss: 0.324076	test&#39;s auc: 0.923682	test&#39;s binary_logloss: 0.350557
Early stopping, best iteration is:
[480]	train&#39;s auc: 0.938517	train&#39;s binary_logloss: 0.318646	test&#39;s auc: 0.923901	test&#39;s binary_logloss: 0.349637
Training until validation scores don&#39;t improve for 100 rounds.
[200]	train&#39;s auc: 0.928541	train&#39;s binary_logloss: 0.341116	test&#39;s auc: 0.925391	test&#39;s binary_logloss: 0.348965
[400]	train&#39;s auc: 0.935509	train&#39;s binary_logloss: 0.325617	test&#39;s auc: 0.926226	test&#39;s binary_logloss: 0.34578
Early stopping, best iteration is:
[487]	train&#39;s auc: 0.937958	train&#39;s binary_logloss: 0.320037	test&#39;s auc: 0.926275	test&#39;s binary_logloss: 0.345141
Training until validation scores don&#39;t improve for 100 rounds.
[200]	train&#39;s auc: 0.928999	train&#39;s binary_logloss: 0.340123	test&#39;s auc: 0.923092	test&#39;s binary_logloss: 0.353408
[400]	train&#39;s auc: 0.935964	train&#39;s binary_logloss: 0.324475	test&#39;s auc: 0.924266	test&#39;s binary_logloss: 0.349549
[600]	train&#39;s auc: 0.941494	train&#39;s binary_logloss: 0.311896	test&#39;s auc: 0.9243	test&#39;s binary_logloss: 0.348578
Early stopping, best iteration is:
[501]	train&#39;s auc: 0.938797	train&#39;s binary_logloss: 0.317972	test&#39;s auc: 0.924384	test&#39;s binary_logloss: 0.348897
Training until validation scores don&#39;t improve for 100 rounds.
[200]	train&#39;s auc: 0.928488	train&#39;s binary_logloss: 0.341264	test&#39;s auc: 0.924988	test&#39;s binary_logloss: 0.350768
[400]	train&#39;s auc: 0.935481	train&#39;s binary_logloss: 0.325642	test&#39;s auc: 0.926473	test&#39;s binary_logloss: 0.346014
[600]	train&#39;s auc: 0.94105	train&#39;s binary_logloss: 0.313093	test&#39;s auc: 0.926545	test&#39;s binary_logloss: 0.344911
Early stopping, best iteration is:
[510]	train&#39;s auc: 0.938604	train&#39;s binary_logloss: 0.31862	test&#39;s auc: 0.926604	test&#39;s binary_logloss: 0.345286
Training until validation scores don&#39;t improve for 100 rounds.
[200]	train&#39;s auc: 0.929051	train&#39;s binary_logloss: 0.339852	test&#39;s auc: 0.923238	test&#39;s binary_logloss: 0.353566
[400]	train&#39;s auc: 0.936033	train&#39;s binary_logloss: 0.324233	test&#39;s auc: 0.92427	test&#39;s binary_logloss: 0.350171
[600]	train&#39;s auc: 0.941581	train&#39;s binary_logloss: 0.311634	test&#39;s auc: 0.924471	test&#39;s binary_logloss: 0.348543
Early stopping, best iteration is:
[641]	train&#39;s auc: 0.942619	train&#39;s binary_logloss: 0.309186	test&#39;s auc: 0.924531	test&#39;s binary_logloss: 0.348428
-------------------------
Creating output
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># metrics_i.to_csv(f&#39;{colab_dir if IN_COLAB else remote_dir}train_metricsLGBM_{ts}.csv&#39;, index=False)</span>
<span class="n">metrics_i</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold</th>
      <th>train</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.938517</td>
      <td>0.923901</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.937958</td>
      <td>0.926275</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.938797</td>
      <td>0.924384</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.938604</td>
      <td>0.926604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.942619</td>
      <td>0.924531</td>
    </tr>
    <tr>
      <th>5</th>
      <td>overall</td>
      <td>0.939299</td>
      <td>0.925134</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model has identified <strong>zero importance</strong> attributes that we may use to further reduce the number of attributes in our datasets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_attr_imp</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">n_attrs</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">thres</span><span class="o">=.</span><span class="mi">95</span><span class="p">,</span> <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">save_file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plots n_attrs most important features and the cumulative importance of</span>
<span class="sd">    attributes.Prints the number of features needed to reach the threshold of</span>
<span class="sd">    cumulative importance.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A dataframe of attribute importances.</span>
<span class="sd">            Columns must be `attribute` and `importance`.</span>
<span class="sd">        n_attrs (int): Number of attributes to plot.</span>
<span class="sd">        thres (float): Plot information about cumulative importances above `thres`.</span>
<span class="sd">        fig_size (tuple of int): Figure size for the combined plot.</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        df (pd.DataFrame): A dataframe ordered by attribute importances with a</span>
<span class="sd">            normalized column (sums to 1) and a cumulative importance column.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Sort features according to importance</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># Normalize the feature importances to add up to one</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;imp_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;importance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cumul_imp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;imp_norm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="n">imp_attrs</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;cumul_imp&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">thres</span><span class="p">][</span><span class="s1">&#39;cumul_imp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{imp_attrs}</span><span class="s1"> attributes provide cumulative importance almost </span><span class="si">{thres:.2f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># with sns.axes_style(&quot;whitegrid&quot;), sns.plotting_context(&quot;notebook&quot;, font_scale=1.5):</span>
    <span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">),</span> <span class="n">sns</span><span class="o">.</span><span class="n">plotting_context</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">fig_size</span><span class="p">)</span>
        <span class="c1"># Horizontal bar plot of attribute importances</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_attrs</span><span class="p">),</span>
                    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;imp_norm&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;attribute&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;Attribute importances [first {str(n_attrs)}]&#39;</span><span class="p">,</span>
                  <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Importance (normalized)&#39;</span><span class="p">)</span>
        <span class="c1"># Cumulative importance plot</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;cumul_imp&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s1">&#39;Scree plot, mark: {str(thres)}, {str(imp_attrs)} attributes&#39;</span><span class="p">,</span>
              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Number of attributes&#39;</span><span class="p">,</span>
              <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Cumulative importance (normalized)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">thres</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">imp_attrs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                      <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="c1"># copyright text</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_file</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save figure location</span>
<span class="n">attr_imp_plt_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}tree_attr_imp_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="n">norm_attrs_imp</span> <span class="o">=</span> <span class="n">plot_attr_imp</span><span class="p">(</span><span class="n">attrib_imp_i</span><span class="p">,</span> <span class="n">save_file</span><span class="o">=</span><span class="n">attr_imp_plt_file</span><span class="p">)</span>
<span class="n">norm_attrs_imp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zero_imp_drop</span> <span class="o">=</span> <span class="n">norm_attrs_imp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">norm_attrs_imp</span><span class="p">[</span><span class="s1">&#39;cumul_imp&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">95</span><span class="p">,</span> <span class="s1">&#39;attribute&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">zero_imp_drop</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Clean up memory</span>
<span class="k">del</span> <span class="n">train</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">df_train</span>
<span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>5489</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can observe that using 0.95 cumulative feature importance can provide almost the same results as when testing with most attributes or 1.0 cumulative features importance. Usually 0.95 removes about 100 attributes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># mailout_train = pd.read_csv(mailout_train_file, sep=&#39;;&#39;)</span>
<span class="n">mailout_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">mailout_train_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="n">na_tupl</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">])</span>
<span class="n">mailout_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(42962, 367)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Hold RESPONSE values separately</span>
<span class="n">target_mailout</span> <span class="o">=</span> <span class="n">mailout_train</span><span class="p">[</span><span class="s1">&#39;RESPONSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mailout_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;RESPONSE&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">mailout_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(42962, 366)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target_mailout</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0    42430
1.0      532
Name: RESPONSE, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that there is a large class <strong>imbalance</strong> in the dataset. There are a lot of individuals that did not respond to the mail campaign.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save figure location</span>
<span class="n">mailout_resp_distr_file</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;{colab_dir if IN_COLAB else remote_dir}mailout_resp_distr_</span><span class="si">{ts}</span><span class="s1">.png&#39;</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">target_mailout</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Missing&#39;</span><span class="p">,</span> <span class="s1">&#39;Customers&#39;</span><span class="p">],</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Responses counts&#39;</span><span class="p">)</span>
    <span class="c1"># copyright text</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">cprt</span><span class="p">,</span> <span class="n">y</span><span class="o">=-.</span><span class="mi">03</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">bb_cprt_args</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">mailout_resp_distr_file</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Clean---fix-dataset.">Clean - fix dataset.<a class="anchor-link" href="#Clean---fix-dataset.">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># `wrangle_df` parameters tuple</span>
<span class="c1"># including *** Drop zero importance attributes *** `zero_imp_drop`</span>
<span class="n">wrangle_args</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">attrs_val_pools</span><span class="p">,</span>
    <span class="n">attrs_common</span><span class="p">,</span>
    <span class="n">replace9_nan_dict</span><span class="p">,</span>
    <span class="n">zero_imp_drop</span>
<span class="p">]</span>

<span class="n">mailout_train</span> <span class="o">=</span> <span class="n">wrangle_df</span><span class="p">(</span><span class="n">mailout_train</span><span class="p">,</span> <span class="o">*</span><span class="n">wrangle_args</span><span class="p">)</span>
<span class="n">mailout_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total df NaNs portion:  0.3064
Column NaNs:
Average NaNs per column:  0.3064
Max NaNs per column:  0.9991
Min NaNs per column:  0.0
Row NaNs:
Average NaNs per row:  0.3064
Max NaNs per row:  0.8462
Min NaNs per row:  0.0714
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(42962, 361)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run the LightGBM model</span>
<span class="n">submitlgb_ml</span><span class="p">,</span> <span class="n">attrib_imp_ml</span><span class="p">,</span> <span class="n">metrics_ml</span> <span class="o">=</span> <span class="n">lgb_model</span><span class="p">(</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">mailout_train</span><span class="p">,</span> <span class="n">target_mailout</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">target_mailout</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">),</span> <span class="n">lgbm_params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training Data Shape:  (34369, 360)
Testing Data Shape:  (8593, 360)
Creating KFold object

Starting fold iterations
-------------------------
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[33]	train&#39;s auc: 0.974685	train&#39;s binary_logloss: 0.367624	test&#39;s auc: 0.73954	test&#39;s binary_logloss: 0.40398
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[64]	train&#39;s auc: 0.999321	train&#39;s binary_logloss: 0.246163	test&#39;s auc: 0.724219	test&#39;s binary_logloss: 0.28541
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[39]	train&#39;s auc: 0.984599	train&#39;s binary_logloss: 0.343664	test&#39;s auc: 0.746461	test&#39;s binary_logloss: 0.391839
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[49]	train&#39;s auc: 0.993578	train&#39;s binary_logloss: 0.305967	test&#39;s auc: 0.763851	test&#39;s binary_logloss: 0.346889
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[40]	train&#39;s auc: 0.984937	train&#39;s binary_logloss: 0.338968	test&#39;s auc: 0.748874	test&#39;s binary_logloss: 0.376165
-------------------------
Creating output
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run the RandomForest model</span>
<span class="c1"># submitlgb_ml, attrib_imp_ml, metrics_ml = rf_model(train_test_split(mailout_train, target_mailout, stratify=target_mailout, test_size=.2), rf_params)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training Data Shape:  (34369, 360)
Testing Data Shape:  (8593, 360)
Creating KFold object

Starting fold iterations
-------------------------
-------------------------
Creating output
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># metrics_ml.to_csv(f&#39;{colab_dir if IN_COLAB else remote_dir}mailout_train_metrics_{ts}.csv&#39;, index=False)</span>
<span class="n">metrics_ml</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold</th>
      <th>train</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.974685</td>
      <td>0.739540</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.999321</td>
      <td>0.724219</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.984599</td>
      <td>0.746461</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.993578</td>
      <td>0.763851</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.984937</td>
      <td>0.748874</td>
    </tr>
    <tr>
      <th>5</th>
      <td>overall</td>
      <td>0.987424</td>
      <td>0.740067</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Part-3:-Kaggle-Competition">Part 3: Kaggle Competition<a class="anchor-link" href="#Part-3:-Kaggle-Competition">&#182;</a></h2><p>Now that you've created a model to predict which individuals are most likely to respond to a mailout campaign, it's time to test that model in competition through Kaggle. If you click on the link <a href="http://www.kaggle.com/t/21e6d45d4c574c7fa2d868f0e8c83140">here</a>, you'll be taken to the competition page where, if you have a Kaggle account, you can enter.</p>
<p>Your entry to the competition should be a CSV file with two columns. The first column should be a copy of "LNR", which acts as an ID number for each individual in the "TEST" partition. The second column, "RESPONSE", should be some measure of how likely each individual became a customer – this might not be a straightforward probability. As you should have found in Part 2, there is a large output class imbalance, where most individuals did not respond to the mailout. Thus, predicting individual classes and using accuracy does not seem to be an appropriate performance evaluation method. Instead, the competition will be using AUC to evaluate performance. The exact values of the "RESPONSE" column do not matter as much: only that the higher values try to capture as many of the actual customers as possible, early in the ROC curve sweep.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#mailout_test = pd.read_csv(mailout_test_file, sep=&#39;;&#39;) </span>
<span class="n">mailout_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">mailout_test_file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="n">na_tupl</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EINGEFUEGT_AM&#39;</span><span class="p">])</span>
<span class="n">mailout_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(42833, 366)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Clean - fix</span>
<span class="c1"># including *** Drop zero importance attributes *** `zero_imp_drop`</span>
<span class="n">mailout_test</span> <span class="o">=</span> <span class="n">wrangle_df</span><span class="p">(</span><span class="n">mailout_test</span><span class="p">,</span> <span class="o">*</span><span class="n">wrangle_args</span><span class="p">)</span>
<span class="n">mailout_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total df NaNs portion:  0.3048
Column NaNs:
Average NaNs per column:  0.3048
Max NaNs per column:  0.9991
Min NaNs per column:  0.0
Row NaNs:
Average NaNs per row:  0.3048
Max NaNs per row:  0.8599
Min NaNs per row:  0.0742
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(42833, 361)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Put the RESPONSE column back in the train set.</span>
<span class="n">mailout_train</span> <span class="o">=</span> <span class="n">mailout_train</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">RESPONSE</span><span class="o">=</span><span class="n">target_mailout</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">mailout_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">mailout_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((42962, 362), (42833, 361))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Check there are no NaNs and no infinites</span>
<span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mailout_test</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">mailout_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(False, True)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a function to submit directly to Kaggle competition from within the notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># When using Google Colab we want to copy the Kaggle API key and check kaggle version</span>
<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>cp -Rv /content/drive/MyDrive/workspace/arvato_data/.kaggle ~/ <span class="o">&amp;&amp;</span> chmod <span class="m">600</span> ~/.kaggle/kaggle.json
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kg_version</span> <span class="o">=</span> <span class="o">!</span>pip show kaggle <span class="p">|</span> grep Version
<span class="n">kg_version</span> <span class="o">=</span> <span class="n">kg_version</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">kg_version</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># if kaggle API version is greater than 1.5.0 load kaggle API:</span>
<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kg_version</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">kg_version</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kaggle module must be upgraded!&quot;</span><span class="p">)</span>
    <span class="o">!</span>pip install kaggle --upgrade
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">kaggle.api.kaggle_api_extended</span> <span class="k">import</span> <span class="n">KaggleApi</span>

<span class="k">def</span> <span class="nf">kaggle_submit</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">competition</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prepare data, export to csv file and submit to kaggle competition.</span>
<span class="sd">    Args:</span>
<span class="sd">        filename (srt): name of the csv file to submit and write to</span>
<span class="sd">        message (srt): message related to submission</span>
<span class="sd">        competition (srt): the name of kaggle competition to submit </span>
<span class="sd">        data (pd.DataFrame): submission dataframe of the form e.g.</span>
<span class="sd">        {&quot;LNR&quot;: pd.Series, &quot;RESPONSE&quot;: pd.Series}</span>
<span class="sd">    Returns:</span>
<span class="sd">        (str): Submission request response</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># kaggle competition: udacity-arvato-identify-customers</span>
    <span class="c1"># Kaggle competition invitation: http://www.kaggle.com/t/21e6d45d4c574c7fa2d868f0e8c83140</span>
    <span class="n">kg_api</span> <span class="o">=</span> <span class="n">KaggleApi</span><span class="p">()</span>
    <span class="n">kg_api</span><span class="o">.</span><span class="n">authenticate</span><span class="p">()</span>

    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">kg_api</span><span class="o">.</span><span class="n">competition_submit</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">competition</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run the model</span>
<span class="n">submit_kg</span><span class="p">,</span> <span class="n">attrib_imp_kg</span><span class="p">,</span> <span class="n">metrics_kg</span> <span class="o">=</span> <span class="n">lgb_model</span><span class="p">([</span><span class="n">mailout_train</span><span class="p">,</span> <span class="n">mailout_test</span><span class="p">],</span> <span class="n">lgbm_params</span><span class="p">)</span>
<span class="c1"># submit_kg, attrib_imp_kg, metrics_kg = rf_model([mailout_train, mailout_test], rf_params)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training Data Shape:  (42962, 360)
Testing Data Shape:  (42833, 360)
Creating KFold object

Starting fold iterations
-------------------------
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[14]	train&#39;s auc: 0.90073	train&#39;s binary_logloss: 0.511441	test&#39;s auc: 0.739591	test&#39;s binary_logloss: 0.528152
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[56]	train&#39;s auc: 0.991289	train&#39;s binary_logloss: 0.303036	test&#39;s auc: 0.76046	test&#39;s binary_logloss: 0.349822
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[30]	train&#39;s auc: 0.935044	train&#39;s binary_logloss: 0.421667	test&#39;s auc: 0.789337	test&#39;s binary_logloss: 0.450539
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[55]	train&#39;s auc: 0.989218	train&#39;s binary_logloss: 0.309941	test&#39;s auc: 0.744332	test&#39;s binary_logloss: 0.352998
Training until validation scores don&#39;t improve for 100 rounds.
Early stopping, best iteration is:
[14]	train&#39;s auc: 0.875167	train&#39;s binary_logloss: 0.514108	test&#39;s auc: 0.74285	test&#39;s binary_logloss: 0.532049
-------------------------
Creating output
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># metrics_kg.to_csv(f&#39;{colab_dir if IN_COLAB else remote_dir}mailout_TEST_metrics_{ts}.csv&#39;, index=False)</span>
<span class="n">metrics_kg</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[&nbsp;]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold</th>
      <th>train</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.900730</td>
      <td>0.739591</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.991289</td>
      <td>0.760460</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.935044</td>
      <td>0.789337</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.989218</td>
      <td>0.744332</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.875167</td>
      <td>0.742850</td>
    </tr>
    <tr>
      <th>5</th>
      <td>overall</td>
      <td>0.938290</td>
      <td>0.743078</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Submit to Kaggle competition</span>
<span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;LightGBM [31 leaves, -1 depth] all mailout data&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">submit_result</span> <span class="o">=</span> <span class="n">kaggle_submit</span><span class="p">(</span><span class="n">kg_submission</span> <span class="o">+</span> <span class="s2">&quot;lgbm_test_</span><span class="si">{}</span><span class="s2">.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="n">kg_competition</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">submit_kg</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">submit_result</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exception: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total run time: &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="p">(</span><span class="n">timer</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_run</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total run time:  0:20:24.338065
</pre>
</div>
</div>

</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
